<!DOCTYPE html>
<html lang="en">
<head>
	<title>Join Jelly</title>

	<style>
		body {
			background: red;
		}

	</style>
	<script src="scripts/createjs-2014.12.12.min.js"></script>
	<script src="scripts/movieclip-0.8.0.min.js"></script>

	<!-- Assets -->
	<script src="assets/Manifest.js"></script>
	<script src="assets/Debussy.js"></script>
	<script src="assets/DebussyBig.js"></script>
	<script src="assets/Intro3.js"></script>

	<!-- tools -->
	<script src="scripts/BitmapScalePath.js"></script>
	<script src="scripts/fontConverter.js"></script>

	<!-- Script -->
	<script src="scripts/script.js"></script>
    <script src="scripts/cti.js"></script>
    <script src="https://cdn.rawgit.com/eligrey/Blob.js/master/Blob.js"></script>
    <script src="https://cdn.rawgit.com/eligrey/canvas-toBlob.js/master/canvas-toBlob.js"></script>
    <script src="https://cdn.rawgit.com/eligrey/FileSaver.js/master/FileSaver.js"></script>

    <script>
        createjs.Tween.prototype.wait = function (duration, passive) {
            duration *= 3;
            if (duration == null || duration <= 0) { return this; }
            var o = this._cloneProps(this._curQueueProps);
            return this._addStep({ d: duration, p0: o, e: this._linearEase, p1: o, v: passive });


        }
        createjs.Tween.prototype.to = function (props, duration, ease) {
            duration *= 3;
            if (isNaN(duration) || duration < 0) { duration = 0; }
            return this._addStep({ d: duration || 0, p0: this._cloneProps(this._curQueueProps), e: ease, p1: this._cloneProps(this._appendQueueProps(props)) });
            ;

        }
    </script>
	<script>
		window.onload = function () {
			var c = new createjs.Stage("gameCanvas");
			
			createjs.Ticker.setFPS(10);
			
			var l = new joinjelly.menus.Loading();
			l.loaded = function () {
				var j = new joinjelly.gameplay.view.Jelly(8);
				j.set({x:250, y:500})
				c.addChild(j);

				//var j = new joinjelly.gameplay.view.Jelly(2);
				//j.set({ x: 700, y: 500 })
				//c.addChild(j);
                //
				//var j = new joinjelly.gameplay.view.Jelly(4);
				//j.set({ x: 1200, y: 500 })
				//c.addChild(j);
                //
				//var j = new joinjelly.gameplay.view.Jelly(8);
				//j.set({ x: 1700, y: 500 })
				//c.addChild(j);

				var timeout = 300
				var index = 0;
				var canvas = document.getElementById("gameCanvas");
				createjs.Ticker.addEventListener("tick", function () {
				    if (timeout > 0) {
				        c.update();
				        timeout--;
				        saveImage(canvas, "Jellies_8_" + index++);
				        document.title = timeout + " " + createjs.Ticker.getMeasuredFPS();
                    }
				});

			};
		}

		function saveImage(canvas, fn) {
		    canvas.toBlob(function (blob) { saveAs(blob, fn + ".png"); }, "image/png");
		}
	</script>

</head>
<body>
	<canvas id="gameCanvas" screencanvas="true" width="500" height="600"></canvas>
</body>
</html>
