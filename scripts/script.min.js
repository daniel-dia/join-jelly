var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},gameui,UserData,histories,testMode,joinjelly;(function(n){var t=function(n){function t(){n.apply(this,arguments);this.centered=!1;this.animating=!1}return __extends(t,n),t.prototype.centralize=function(){this.regX=this.width/2;this.regY=this.height/2;this.centered=!0},t.prototype.fadeOut=function(n,t){var i=this;n===void 0&&(n=.5);t===void 0&&(t=.5);this.resetFade();createjs.Tween.get(this).to({scaleX:n,scaleY:t,alpha:0,x:this.antX,y:this.antY},200,createjs.Ease.quadIn).call(function(){i.visible=!1;i.x=i.antX;i.y=i.antY;i.scaleX=i.scaleY=1;i.alpha=1;i.animating=!1;i.mouseEnabled=!0})},t.prototype.resetFade=function(){this.animating=!0;this.antX=this.x;this.antY=this.y;this.mouseEnabled=!1;createjs.Tween.removeTweens(this)},t.prototype.fadeIn=function(n,t){var i=this;n===void 0&&(n=.5);t===void 0&&(t=.5);(this.visible=!0)&&(this.antX=null);this.visible=!0;this.animating=!0;this.antX==null&&(this.antX=this.x,this.antY=this.y);this.scaleX=n;this.scaleY=t;this.alpha=0;this.x=this.x;this.y=this.y;this.mouseEnabled=!1;createjs.Tween.removeTweens(this);createjs.Tween.get(this).to({scaleX:1,scaleY:1,alpha:1,x:this.antX,y:this.antY},400,createjs.Ease.quadOut).call(function(){i.mouseEnabled=!0;i.animating=!1})},t.prototype.createHitArea=function(){var t=new createjs.Shape,n=this.getBounds();n&&t.graphics.beginFill("#000").drawRect(n.x,n.y,n.width,n.height);this.hitArea=t},t}(createjs.Container);n.UIItem=t})(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.setMusicVolume=function(n){this.currentMusic&&(this.currentMusic.volume=n);this.musicVolue=n},n.setSoundVeolume=function(n){this.soundVolume=n},n.getMusicVolume=function(){return this.musicVolue==undefined?1:this.musicVolue},n.getSoundVolume=function(){return this.soundVolume==undefined?1:this.soundVolume},n.playMusic=function(n,t){if(t===void 0&&(t=1),this.currentMusic){if(this.currentMusic.setVolume(t),this.currentMusicName==n)return;this.currentMusic.stop();delete this.currentMusic}this.currentMusicName=n;this.currentMusic=createjs.Sound.play(n,null,null,null,1e3);this.currentMusic.setVolume(t*this.getMusicVolume())},n.playSound=function(n,t,i,r,u,f){return i===void 0&&(i=0),f===void 0&&(f=1),createjs.Sound.play(n,t,i,r,u,f*this.getSoundVolume())},n}();n.AudiosManager=t}(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.loadAssets=function(n,t,i,r){var u=this;t===void 0&&(t="");this.spriteSheets=i?i:[];this.imagesArray=r?r:[];this.bitmapFontSpriteSheetDataArray=this.bitmapFontSpriteSheetDataArray?this.bitmapFontSpriteSheetDataArray:[];this.assetsManifest=n;createjs.Sound.alternateExtensions=["mp3"];this.loader||(this.loader=new createjs.LoadQueue(!1),this.loader.installPlugin(createjs.Sound),this.loader.addEventListener("filestart",function(n){console.log("loading "+n.item.src)}),this.loader.addEventListener("fileload",function(n){console.log("loaded "+n.item.src)}),this.loader.addEventListener("complete",function(){u.onComplete&&u.onComplete()}),this.loader.addEventListener("progress",function(n){if(u.onProgress)u.onProgress(n.progress)}),this.loader.addEventListener("fileload",function(n){return n.item.type=="image"&&(u.imagesArray[n.item.id]=n.result),!0}));this.loader.loadManifest(n,!0,t)},n.loadFontSpriteSheet=function(n,t){this.bitmapFontSpriteSheetDataArray[n]=new createjs.SpriteSheet(t)},n.cleanAssets=function(){var n,t;this.imagesArray;for(n in this.imagesArray)t=this.imagesArray[n],t.dispose&&t.dispose(),delete this.imagesArray[n]},n.getImagesArray=function(){return this.imagesArray},n.getBitmap=function(t){var r,i;return this.spriteSheets&&this.spriteSheets[t]?this.getSprite(t,!1):(r=this.getLoadedImage(t),r)?(i=new createjs.Bitmap(r),i.mouseEnabled=n.defaultMouseEnabled,i):(i=new createjs.Bitmap(t),i.mouseEnabled=n.defaultMouseEnabled,i)},n.getBitmapText=function(t,i){var r=new createjs.BitmapText(t,this.bitmapFontSpriteSheetDataArray[i]);return r.lineHeight=100,r.mouseEnabled=n.defaultMouseEnabled,r},n.getLoadedImage=function(n){return this.loader?this.loader.getResult(n):null},n.getSprite=function(n,t){var i,r,f,u;t===void 0&&(t=!0);i=this.spriteSheets[n];for(r in i.images)typeof i.images[r]=="string"&&(i.images[r]=this.getLoadedImage(i.images[r]));return f=new createjs.SpriteSheet(i),u=new createjs.Sprite(f),t&&u.play(),u},n.defaultMouseEnabled=!1,n}();n.AssetsManager=t}(gameui||(gameui={})),function(n){var t=function(){function t(n,t,i,r,u){var e=this,o,f;r===void 0&&(r=60);this.defaultWidth=t;this.defaultHeight=i;this.stage=new createjs.Stage(n);createjs.Touch.enable(this.stage);o=0;createjs.Ticker.addEventListener("tick",function(){e.stage.update()});createjs.Ticker.setFPS(r);this.screenContainer=new createjs.Container;this.stage.addChild(this.screenContainer);u&&(f=new createjs.Text("FPS"," 18px Arial ","#000"),f.mouseEnabled=!1,f.x=0,f.y=0,this.stage.addChild(f),createjs.Ticker.addEventListener("tick",function(){f.text=Math.floor(createjs.Ticker.getMeasuredFPS())+" FPS"}));this.resizeGameScreen(window.innerWidth,window.innerHeight);window.onresize=function(){e.resizeGameScreen(window.innerWidth,window.innerHeight)}}return t.prototype.switchScreen=function(t,i,r){var s=this,u=this.currentScreen;r||(r=new n.Transition);var e=0,o=0,f=1;if(r&&u){switch(r.type){case"fade":f=0;break;case"top":o=this.currentHeight;break;case"bottom":o=-this.currentHeight;break;case"left":e=-this.currentWidth;break;case"right":e=this.currentWidth;break;case"none":r.time=0}r.type&&r.type!="none"?(t.view.mouseEnabled=!1,u.view.mouseEnabled=!1,t.view.set({alpha:f,x:-e,y:-o}),u.view.set({1:f,x:0,y:0}),createjs.Tween.get(u.view).to({alpha:f,x:e,y:o},r.time,createjs.Ease.quadInOut),createjs.Tween.get(t.view).to({alpha:1,x:0,y:0},r.time,createjs.Ease.quadInOut).call(function(){u.view.set({1:f,x:0,y:0});t.view.set({1:f,x:0,y:0});t.view.mouseEnabled=!0;u.view.mouseEnabled=!0;s.removeOldScreen(u);u=null})):(this.removeOldScreen(u),u=null)}else this.removeOldScreen(u),u=null;t.activate(i);this.screenContainer.addChild(t.view);this.currentScreen=t;this.currentScreen.redim(this.headerPosition,this.footerPosition,this.currentWidth,this.currentHeight)},t.prototype.resizeGameScreen=function(n,t,i){var r,u,f;i===void 0&&(i=!0);this.defaultHeight&&(r=this.defaultWidth/this.defaultHeight,u=n/t,u>r&&(f=t/this.defaultHeight,n=this.defaultWidth*f));this.stage.canvas.width=n;this.stage.canvas.height=t;this.updateViewerScale(n,t,this.defaultWidth,this.defaultHeight)},t.prototype.updateViewerScale=function(n,t,i,r){var u=n/i;this.currentHeight=t/u;this.currentWidth=n/u;this.defaultWidth=i;this.headerPosition=-(this.currentHeight-r)/2;this.footerPosition=r+(this.currentHeight-r)/2;this.screenContainer.scaleX=this.screenContainer.scaleY=u;this.screenContainer.y=this.viewerOffset=(this.currentHeight-r)/2*u;this.currentScreen&&this.currentScreen.redim(this.headerPosition,this.footerPosition,this.currentWidth,this.currentHeight)},t.prototype.removeOldScreen=function(n){n!=null&&(n.desactivate(),this.screenContainer.removeChild(n.view),n=null)},t}();n.GameScreen=t}(gameui||(gameui={})),function(n){var t=function(n){function t(t,i,r,u,f,e){f===void 0&&(f=0);n.call(this);this.flowHorizontal=!1;this.currentCol=0;this.currentRow=0;this.flowHorizontal=e;this.cols=t;this.rows=i;this.padding=f;this.width=r;this.height=u;this.wSpacing=(r-f*2)/t;this.hSpacing=(u-f*2)/i}return __extends(t,n),t.prototype.addObject=function(n){this.addChild(n);n.x=this.getXPos();n.y=this.getYPos();this.updatePosition()},t.prototype.getXPos=function(){return this.padding+this.currentCol*this.wSpacing+this.wSpacing/2},t.prototype.getYPos=function(){return this.padding+this.currentRow*this.hSpacing+this.hSpacing/2},t.prototype.updatePosition=function(){this.flowHorizontal?(this.currentRow++,this.currentRow>=this.rows&&(this.currentRow=0,this.currentCol++)):(this.currentCol++,this.currentCol>=this.cols&&(this.currentCol=0,this.currentRow++))},t}(n.UIItem);n.Grid=t}(gameui||(gameui={})),function(n){var t=function(n){function t(t,i,r){t===void 0&&(t="");i===void 0&&(i="600 90px Myriad Pro");r===void 0&&(r="#82e790");n.call(this);t=t.toUpperCase();this.textField=new createjs.Text(t,i,r);this.textField.textBaseline="middle";this.textField.textAlign="center";this.addChild(this.textField)}return __extends(t,n),t}(n.UIItem);n.Label=t}(gameui||(gameui={})),function(n){var t=function(t){function i(n,i,r){n===void 0&&(n=null);i===void 0&&(i=null);r===void 0&&(r=!1);r?t.call(this,0,1,n,i,0,r):t.call(this,1,0,n,i,0,r)}return __extends(i,t),i.prototype.addLabel=function(t){var i;return i=new n.Label(t),this.addObject(i),i.textField},i.prototype.addButton=function(t,i){i===void 0&&(i=null);var r=new n.TextButton(t,null,null,null,i);return this.addObject(r),r},i.prototype.addOutButton=function(t,i){i===void 0&&(i=null);var r=new n.TextButton(t,null,null,null,i);return this.addObject(r),r},i}(n.Grid);n.MenuContainer=t}(gameui||(gameui={})),function(n){var t=function(){function n(){this.view=new createjs.Container;this.content=new createjs.Container;this.overlay=new createjs.Container;this.header=new createjs.Container;this.footer=new createjs.Container;this.background=new createjs.Container;this.view.addChild(this.background);this.view.addChild(this.content);this.view.addChild(this.footer);this.view.addChild(this.header);this.view.addChild(this.overlay)}return n.prototype.activate=function(){this.content.visible=!0},n.prototype.desactivate=function(){this.content.visible=!1},n.prototype.redim=function(n,t,i,r){var u;this.screenHeight=r;this.screenWidth=i;this.footer.y=t;this.header.y=n;var e=t+n,o=t-n,f=o/e;f<1?(f=1,this.background.y=0,this.background.x=0):(this.background.y=n,this.background.x=-(i*f-i)/2);this.background.scaleX=this.background.scaleY=f;u=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,-(r-defaultHeight)/2,i,r));this.background.mask=u;this.footer.mask=u;this.header.mask=u;this.content.mask=u},n.prototype.back=function(){exitApp()},n}();n.ScreenState=t}(gameui||(gameui={})),function(n){var t=function(){function n(){this.time=300;this.type="fade"}return n}();n.Transition=t}(gameui||(gameui={})),function(n){var r=function(t){function i(n){var i=this;t.call(this);this.enableAnimation=!0;this.mouse=!1;this.addEventListener("mousedown",function(n){i.onPress(n)});this.addEventListener("pressup",function(n){i.onPressUp(n)});this.addEventListener("mouseover",function(){i.mouse=!0});this.addEventListener("mouseout",function(){i.mouse=!1});this.soundId=n}return __extends(i,t),i.setDefaultSoundId=function(n){this.DefaultSoundId=n},i.prototype.returnStatus=function(){this.mouse||(this.scaleX=this.originalScaleX,this.scaleY=this.originalScaleY)},i.prototype.onPressUp=function(){this.mouse=!1;this.set({scaleX:this.originalScaleX*1.1,scaleY:this.originalScaleY*1.1});createjs.Tween.get(this).to({scaleX:this.originalScaleX,scaleY:this.originalScaleY},200,createjs.Ease.backOut)},i.prototype.onPress=function(){var t=this;this.enableAnimation&&(this.mouse=!0,this.originalScaleX==null&&(this.originalScaleX=this.scaleX,this.originalScaleY=this.scaleY),createjs.Tween.get(this).to({scaleX:this.originalScaleX*1.1,scaleY:this.originalScaleY*1.1},500,createjs.Ease.elasticOut).call(function(){t.mouse||createjs.Tween.get(t).to({scaleX:t.originalScaleX,scaleY:t.originalScaleY},300,createjs.Ease.backOut)}),this.soundId||(this.soundId=i.DefaultSoundId),this.soundId&&n.AudiosManager.playSound(this.soundId))},i.prototype.setSound=function(n){this.soundId=n},i}(n.UIItem),t,i,u,f;n.Button=r;t=function(t){function i(i,r,u){var f=this;t.call(this,u);r!=null&&this.addEventListener("click",r);i!=null&&(this.background=n.AssetsManager.getBitmap(i),this.addChildAt(this.background,0),this.background.getBounds()?this.centralizeImage():this.background.image&&(this.background.image.onload=function(){f.centralizeImage()}));this.createHitArea()}return __extends(i,t),i.prototype.centralizeImage=function(){this.width=this.background.getBounds().width;this.height=this.background.getBounds().height;this.background.regX=this.width/2;this.background.regY=this.height/2;this.centered=!0},i}(r);n.ImageButton=t;i=function(n){function t(t,i,r,u,f,e){t===void 0&&(t="");n.call(this,u,f,e);t=t.toUpperCase();this.text=new createjs.Text(t,i,r);this.text.textBaseline="middle";this.text.textAlign="center";u==null&&(this.width=this.text.getMeasuredWidth()*1.5,this.height=this.text.getMeasuredHeight()*1.5);this.addChild(this.text);this.createHitArea();this.createHitArea()}return __extends(t,n),t}(t);n.TextButton=i;u=function(t){function i(i,r,u,f,e){t.call(this,u,f,e);i=i.toUpperCase();this.bitmapText=n.AssetsManager.getBitmapText(i,r);this.addChild(this.bitmapText);this.bitmapText.regX=this.bitmapText.getBounds().width/2;this.bitmapText.regY=this.bitmapText.lineHeight/2;this.createHitArea()}return __extends(i,t),i}(t);n.BitmapTextButton=u;f=function(t){function i(i,r,u,f,e,o,s){var h=this;i===void 0&&(i="");r===void 0&&(r="");u===void 0&&(u=null);r!=""&&(r=" "+r);t.call(this,r,u,f,e,o,s);this.icon=n.AssetsManager.getBitmap(i);this.addChild(this.icon);this.text.textAlign="left";this.icon.getBounds()?this.icon.regY=this.icon.getBounds().height/2:this.icon.image&&(this.icon.image.onload=function(){h.icon.regY=h.icon.getBounds().height/2});this.updateLabel(r);this.createHitArea()}return __extends(i,t),i.prototype.updateLabel=function(n){this.text.text=n;this.icon.getBounds()&&(this.icon.x=-(this.icon.getBounds().width+10+this.text.getMeasuredWidth())/2,this.text.x=this.icon.x+this.icon.getBounds().width+10)},i.prototype.centralizeIcon=function(){},i}(i);n.IconButton=f}(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.TIME="time",n.CLEAN="clean",n.FAST="fast",n.REVIVE="revive",n.LUCKY="lucky",n.EVOLVE="evolve",n}(),i;n.Items=t;i=function(){function i(){this.items={};this.items=n.JoinJelly.userData.loadItems()}return i.prototype.getItemAmmount=function(n){return this.items[n]||0},i.prototype.increaseItemAmmount=function(n,t){t===void 0&&(t=1);this.setItemAmmount(n,this.getItemAmmount(n)+t)},i.prototype.decreaseItemAmmount=function(n,t){t===void 0&&(t=1);this.setItemAmmount(n,this.getItemAmmount(n)-t)},i.prototype.setItemAmmount=function(t,i){i>99&&(i=99);i<0&&(i=0);this.items[t]=i;n.JoinJelly.userData.saveItems(this.items)},i.items=[t.TIME,t.CLEAN,t.FAST,t.REVIVE,t.EVOLVE,t.LUCKY],i}();n.ItemsData=i}(joinjelly||(joinjelly={}));var StringResources={menus:{highScore:"High Score",loading:"loading",score:"score",level:"level",options:"options",highJelly:"High Jelly",gameOver:"GAME OVER",jellypedia:"Jellypedia",pause:"paused",sound:"Sound",menu:"menu",leaderboards:"Leaderboards",reset:"Reset All Data",restore:"Restore",restoreWarning:"It will restore your purchases from store, Continue?",resetWarning:"Are you sure. All you progress will be lost",about:"About",tutorial:"Tutorial",shop:"shop",playerName:"Player Name",playerNameDesc:"Type your name for the leaderboards.",error:"Sorry, Something went wrong"},tutorial:{msgheplme:"Help me to evolve\nJoin  2 identical jellies.",msgOnceMore:"Great! now I'm bigger, \nevolve me once more",msgDirt:"Ow, a dirt appears \n Join two jelly near to destroy it.",msgPlay:"Perfect!\nNow let's play this game.",msgItemClean:"You can always use items.\n this cleans the board",msgItemFast:"this one join some jellies",msgItemTime:"this one make time slower",msgItemRevive:"if you loose, use this to revive",msgBoardFill:"but be careful, \ndo not let the board fill, \nthis is the end for us."},jellys:{1:{name:"Little Jelly",description:"Small but essential"},2:{name:"Droplet",description:"Dripping everywhere"},4:{name:"Little Cake",description:"Incredible Lemon \nflavor"},8:{name:"Yolk",description:"She misses the\nMr. White..."},16:{name:"SunBronze",description:"With tanned little \nbody"},32:{name:"Strawberry",description:"Bored from jellying"},64:{name:"Upsety",description:"'Don't touch me...'"},128:{name:"Sluggjelly",description:"The sluggish Jelly"},256:{name:"Moti",description:"Iresistible desire to \neat with soy sauce"},512:{name:"Big cheeks",description:"Reminds me of my\nbrother cheeks"},1024:{name:"Geleialien",description:"Came from another\nplanet to jam"},2048:{name:"Oil",description:"An oil droplet"},4096:{name:"Healthy",description:"Your personal \nhealth jelly"},8192:{name:"Cuboid",description:"This one born boxy."},16384:{name:"Lumpy Jelly",description:"Bad tempered and \nlumpy"},32768:{name:"Sonic Jelly",description:"A very fast one"},65536:{name:"Super Sayajelly",description:"The strongest jelly \nof the universe"}},items:{clean:"Clean",fast:"Fast",time:"Time",revive:"Revive",evolve:"Evolve"},store:{title:"Store",clean:{name:"Clean 3x",desc:"Remove all dirt and small jellies"},fast:{name:"Fast 3x",desc:"Join 5 avaliable jellies"},time:{name:"Freeze Time 3x",desc:"Freeze times for 5 seconds"},revive:{name:"Revive 3x",desc:"Return to play after losing"},lucky:{name:"Lucky clover",desc:"Doubles the chance of finding an item"},pack:{name:"Item Pack",desc:"A package with 3 units of each item"}},credit:{},social:{shareDescription:"",shareTitle:"JoinJelly",shareCaption:""}},StringResources_pt={menus:{highScore:"Recorde",loading:"Carregando",score:"Pontos",level:"level",options:"opções",highJelly:"maior",gameOver:"GAME OVER",jellypedia:"Jellypedia",pause:"pausa",sound:"Sons",menu:"Menu",leaderboards:"Placar",reset:"Apagar tudo",restore:"Recuperar",restoreWarning:"Isso vai recuperar suas compras da loja, quer continuar?",resetWarning:"Você tem certeza? tudo que voce consquistou será perdido.",about:"Sobre",tutorial:"Tutorial",shop:"Compras",playerName:"Nome do Jogador",playerNameDesc:"Digite seu nome para aparecer no placar dos melhores",error:"Desculpe, algo deu errado."},tutorial:{msgheplme:"Me ajude a desenvolver\nJunte 2 geleias IGUAIS.",msgOnceMore:"Legal! Estou maior, \nMe desenvolva novamente",msgDirt:"Olha, sujeiras! Junte \numa geleia lá para limpar.",msgPlay:"Perfeito!\nVamos jogar!.",msgItemClean:"Sempre que precisar use items.\nEste limpa a bagunça",msgItemFast:"Esse junta \nalgumas geleias",msgItemTime:"Esse congela o tempo",msgItemRevive:"Se voce perder, use este para reviver",msgBoardFill:"Mas Tenha cuidado, se acabar \nos espaços no chão é o fim."},jellys:{1:{name:"Geleinha",description:"Pequena mas \nimportante"},2:{name:"Gotinha",description:"gotejando por\ntodo lado"},4:{name:"Bolinho",description:"Incrível sabor de\nLimão"},8:{name:"Gema",description:"Sente falta da\nClara..."},16:{name:"SunBronze",description:"Com corpinho \nbronzeado"},32:{name:"Morango",description:"Entediada de tanto\ngelatinar"},64:{name:"Chatinha",description:"Não gosta de ser \ntocada"},128:{name:"Gelerda",description:"A geleia lerdinha"},256:{name:"Moti",description:"Irresistivel vontade\nde comer com shoyu"},512:{name:"Xexão",description:"Lembra as bochechas \ndo meu irmão"},1024:{name:"Geleialien",description:"Veio de outro \nplaneta para geleiar"},2048:{name:"Petróleo",description:"Uma gotinha de \nóleo"},4096:{name:"Saudável",description:"Sua geleia pessoal \nde saúde"},8192:{name:"Cuboide",description:"Esse nasceu\nquadradão."},16384:{name:"Geleia Caroço",description:"Mau humorada e \nencaroçada"},32768:{name:"Geleia Sonica",description:"Uma geleia\nmuito rápida"},65536:{name:"Super Sayajelly",description:"A geleia mais forte \ndo universo"},131072:{name:"Phanton6 Jelly",description:"description"},262144:{name:"Phanton6 Jelly",description:""}},items:{clean:"Limpa",fast:"Rápido",time:"Tempo",revive:"Reviver",evolve:"Desenvolve"},store:{title:"Loja",clean:{name:"Limpar 3x",desc:"Limpa sujeira e geleinhas"},fast:{name:"Rápido 3x",desc:"Junta algumas geleias"},time:{name:"Tempo 3x",desc:"para o tempo por 5 segundos"},revive:{name:"Reviver 3x",desc:"Retorne a jogar depis que perder."},lucky:{name:"Trevo da Sorte",desc:"Dobra a chance de encontrar items"},pack:{name:"Pacotinho",desc:"Contem 5 items de cada"},gibpack:{name:"Pacotão",desc:"Contem 10 items de cada."}},credit:{},social:{shareDescription:"",shareTitle:"JoinJelly",shareCaption:""}},Analytics=function(){function n(){}return n.prototype.getUser=function(){return this.userId||(this.userId=localStorage.getItem("dia_userID")),this.userId||(this.userId=(Math.random()*9999999999).toString(),localStorage.setItem("dia_userID",this.userId)),this.userId},n.prototype.getSession=function(){return this.sessionId||(this.sessionId=(Math.random()*9999999999).toString()),this.sessionId},n.prototype.getBuild=function(){return"alpha 75"},n.prototype.sendEvent=function(n,t,i,r,u,f){var e={user_id:this.getUser(),session_id:this.getSession(),build:this.getBuild(),event_id:n+":"+t,value:i,area:this.normalizeNumber(r),x:u,y:f},o=JSON.stringify(e),s=CryptoJS.MD5(o+"41a3b9e858f42efe02cc0066eb544edc6838f0e7"),h=CryptoJS.enc.Hex.stringify(s);this.postAjax("http://api-eu.gameanalytics.com/1/f8ddc946b8ec021d5339343e63f2e773/design",e,h)},n.prototype.postAjax=function(n,t,i){var r=new XMLHttpRequest;if(r.open("POST",n,!0),r.setRequestHeader("Content-Type","text/plain"),r.setRequestHeader("Content-Length",JSON.stringify(t).length.toString()),r.setRequestHeader("Authorization",i),r.readyState==1)try{r.send(JSON.stringify(t))}catch(u){}},n.prototype.normalizeNumber=function(n){n===void 0&&(n=0);var t="000000000"+(n%1).toString();return t.substr(t.length-3)},n.prototype.log2=function(n){return Math.log(n)/Math.log(2)},n.prototype.logGameStart=function(){this.sendEvent("GameStart","start",1)},n.prototype.logUsedItem=function(n,t){this.sendEvent("UseItem",n,1,t)},n.prototype.logEndGame=function(n,t,i,r){this.sendEvent("GameEnd","Time",1,parseInt((r/6e4).toFixed()));this.sendEvent("GameEnd","Level",1,n);this.sendEvent("LastJelly",this.log2(t),1)},n.prototype.logWinGame=function(n,t,i,r){this.sendEvent("GameWin","Time",1,parseInt((r/6e4).toFixed()));this.sendEvent("GameWin","Moves",i,n)},n.prototype.logNewJelly=function(n,t,i){this.sendEvent("NewJelly","Time:"+this.normalizeNumber(n),1,parseInt((i/1e3).toFixed()));this.sendEvent("NewJelly","Level:"+this.normalizeNumber(n),1,t)},n}(),productsData={pack1x:{icon:"Item Pack",consumable:!1,share:!0},time5x:{icon:"5x Snow",consumable:!0},fast5x:{icon:"5x Magnet",consumable:!0},revive5x:{icon:"5x Revive",consumable:!0},clean5x:{icon:"5x Clean",consumable:!0},pack5x:{icon:"5x Item Pack",consumable:!0},pack10x:{icon:"10x Item Pack",consumable:!0},lucky:{icon:"Lucky Clover",consumable:!1}},joinjelly;(function(n){var t=function(t){function i(n){t.call(this);this.maxScroll=1700;this.addBackground(n);this.addScrollableArea();this.addButton()}return __extends(i,t),i.prototype.addBackground=function(n){var t,i;this.background.addChild(gameui.AssetsManager.getBitmap("backhome"));t=gameui.AssetsManager.getBitmap("BigBG");t.mouseEnabled=!0;this.content.addChild(t);t.x=(defaultWidth-1463)/2;t.y=(defaultHeight-1788)/2;i=gameui.AssetsManager.getBitmapText(n.toUpperCase(),"debussyBig");this.content.addChild(i);i.y=t.y+50;i.x=defaultWidth/2;i.regX=i.getBounds().width/2},i.prototype.addScrollableArea=function(){var r=this,u=new createjs.Container,t=new createjs.Container,f,n,i;this.content.addChild(t);t.addChild(u);this.scrollableContent=u;f=new createjs.Shape((new createjs.Graphics).f("rgb(254,254,254)").p("EALkCFSYAAomAAocAAomYAAgUAKgUAAgUYAAjwgKjwAKj6YAKi+AKi+AAi+YAKjwAKjmAKjwYAKiMAKiWAKiMYAylUB4lADIkiYEYmaFykEH0hQYDcgeDcgeDcgeYAKAAAAAAAKAAYAAAogKAoAAAoYAABuAKBkgKBuYgKC0AACqAAC0YgKCMA8BuBuBaYBkBQB4AUB4AAcArmAAAArmAAAArmAAAYAUAAAKAAAUAAYEOgKC+i+gKkOYAAiCAAh4AAh4YgKi+gKi+AAi+YAeAAAeAAAeAAYAKAAAKAKAUAAYDSAUDIAeDSAoYFUA8EiCgDwDwYCgCqCCDIBkDcYBuDmBGDwAUEEYAKCCAKB4AACCYAKDwAKDwAUDwYAABQgKBQAUBQYAAA8AAAyAAA8YgKAyAAA8AAAyYgKIIAKH+gKIIYAACqAACqAAC0YgKD6gKD6AAD6YgKC0AAC0AAC0YgUGQgKGGgKGQYgKC+gKDIAAC+YgUEigKEsgKEiYgKCqgKCqgKCqYgKD6gKDwgKD6YgKDcgUDcgKDmYgKDSgKDSgKDSYgKDcgUDcgKDcYgKC+gKDIgKC+YgKCWAACWgyCMYgoB4geB4gyB4YiWFKjIEYkYDcYjSCgjmBukYAKYi0AKi+AKi+AKYjSAKjSAAjSAKYiMAKiMgKiMAKYi0AKi0AAi0AAYnCAAnCAUnMgKYhaAAhQAAhaAAYgUAAgUAAgUAKYywAAy6AAywAAYgUAAgKgKgUAAYlyAAlyAAlygKYiCAAiCAAiCgKYkEAAkOgKkEgKYiqgKigAAiqgKYg8AAhGgKhGgUYjwg8i+iCi0igYiWiMhuiWhuigYiMjmhaj6g8kEYgeh4AKh4gKh4YgKjSgKjSgKjSYgUjmgKjwgKjmYgKkEgKj6gKkEYgKk2gUk2gKk2YgKjmAAjcgKjmYgKmkgUmkgKmkYgKlKAAlKgKlUYAAj6gKkEAAj6YAAjSAAjcAAjSYAAgUgKgKAAgU").cp().ef());t.mask=f;n=0;this.content.addEventListener("pressmove",function(t){i||(i=t.localY);n+=(t.localY-i)*1.3;n>400&&(n=400);n<-r.maxScroll&&(n=-r.maxScroll);i=t.localY});this.content.addEventListener("pressup",function(){i=null});this.content.addEventListener("tick",function(){t.y=(t.y*2+n)/3})},i.prototype.addButton=function(){var i=this,t=new gameui.ImageButton("BtOk",function(){i.okButtonAction?i.okButtonAction():n.JoinJelly.showMainMenu()});t.x=defaultWidth*3/4;t.y=defaultHeight-200;this.content.addChild(t)},i}(gameui.ScreenState);n.ScrollablePage=t})(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(t){function i(){var f=this,u,i,r;t.call(this);u="assets/sounds/";i="assets/images/";assetscale=1;window.innerWidth<=1024&&(assetscale=.5);window.innerWidth<=384&&(assetscale=.25);assetscale!=1&&(i="assets/images_"+assetscale+"x/");testMode||(Cocoon.Device.getDeviceInfo()&&Cocoon.Device.getDeviceInfo().os!="windows"?createjs.Sound.registerManifest(audioManifest,u):gameui.AssetsManager.loadAssets(audioManifest,u));gameui.AssetsManager.loadAssets(imageManifest,i);gameui.AssetsManager.loadFontSpriteSheet("debussy",createSpriteSheetFromFont(debussyFont,i));gameui.AssetsManager.loadFontSpriteSheet("debussyBig",createSpriteSheetFromFont(debussyFontBig,i));gameui.AssetsManager.onProgress=function(n){r.update(n)};gameui.AssetsManager.onComplete=function(){f.loaded&&f.loaded()};gameui.Button.DefaultSoundId="Interface Sound-06";r=new n.view.LoadingBar(i);this.content.addChild(r);r.x=defaultWidth/2;r.y=defaultHeight/2}return __extends(i,t),i}(gameui.ScreenState);n.Loading=t})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t=function(t){function i(n){t.call(this);this.timeStep=2;this.boardSize=5;this.userData=n;this.createContent();this.createBackground();this.createHeader();this.createFooter();this.createTitle();gameui.AudiosManager.playMusic("musicIntro")}return __extends(i,t),i.prototype.createContent=function(){var i=new n.menus.view.JellyLobby(this.userData.getLastJelly()),t;i.x=defaultWidth/2;i.y=1e3;this.content.addChild(i);t=new gameui.ImageButton("BtPlay",function(){n.JoinJelly.userData.getHistory(histories.TUTORIAL)?n.JoinJelly.startLevel():n.JoinJelly.startTutorial()});t.y=1168;t.x=768;this.content.addChild(t)},i.prototype.createTitle=function(){var t=new n.menus.view.GameTitle;this.content.addChild(t)},i.prototype.createBackground=function(){this.background.addChild(gameui.AssetsManager.getBitmap("backhome"))},i.prototype.createHeader=function(){},i.prototype.createFooter=function(){var o=this,t,u,f,e;this.userData&&(this.scoreText=gameui.AssetsManager.getBitmapText(StringResources.menus.highScore+" "+this.userData.getHighScore(),"debussy"),this.scoreText.x=50,this.scoreText.y=-100,this.scoreText.scaleX=this.scoreText.scaleY=.8,this.footer.addChild(this.scoreText));var i=defaultWidth+100,r=250,t=new gameui.ImageButton("BtInfo",function(){n.JoinJelly.showAbout()});t.y=150;t.x=i-r;this.header.addChild(t);t=new gameui.ImageButton("BtMenu",function(){n.JoinJelly.showSettings()});t.y=-150;t.x=i-=r;this.footer.addChild(t);u=new gameui.ImageButton("BtJelly",function(){n.JoinJelly.showPedia()});u.y=-150;u.x=i-=r;this.footer.addChild(u);f=new gameui.ImageButton("BtStore",function(){n.JoinJelly.showStore(o)});f.y=-150;f.x=i-=r;this.footer.addChild(f);e=new gameui.ImageButton("BtLeaderBoards",function(){n.JoinJelly.showLeaderboards()});e.y=-150;e.x=i-=r;this.footer.addChild(e)},i}(gameui.ScreenState);n.MainScreen=t}(joinjelly||(joinjelly={})),function(n){var t=function(t){function i(i,r){var f,o,u,e;for(t.call(this,StringResources.menus.jellypedia),f=new createjs.Container,this.scrollableContent.addChild(f),f.y=400,o=0,u=1;u<=n.JoinJelly.maxJelly;u*=2)e=u<=Math.max(1,i.getLastJelly())?new n.menus.view.JellyPediaItem(u,r[u].name,r[u].description):new n.menus.view.JellyPediaItem(0,"?",""),f.addChild(e),e.y=500*o,e.x=150,o++;this.maxScroll=7300}return __extends(i,t),i}(n.ScrollablePage);n.Jellypedia=t}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.createJoin();this.createJelly()}return __extends(i,t),i.prototype.createJoin=function(){for(var n,i=[0,213,442,631,839],r=[0,1,0,0,1],u=[0,1,1,-1,-1],f=[],t=1;t<=4;t++)n=gameui.AssetsManager.getBitmap("title_join_"+t),n.regX=n.getBounds().width/2,n.regY=n.getBounds().height/2,n.y=514+n.getBounds().height/2-n.getBounds().height,n.x=i[t],n.alpha=0,this.addChild(n),f[t]=n,createjs.Tween.get(n).wait(r[t]*400).to({alpha:0,x:i[t]-300*u[t],scaleX:3,scaleY:.333}).to({alpha:2,x:i[t],scaleX:1,scaleY:1},2e3,createjs.Ease.elasticInOut)},i.prototype.createJelly=function(){for(var i,t,u=[213,492,761,1039,1278],r=1;r<=5;r++)i=gameui.AssetsManager.getBitmap("title_jelly_"+r),i.regX=i.getBounds().width/2,i.regY=i.getBounds().height,t=new n.view.JellyContainer,t.visible=!1,t.executeAnimationIn(r*100+1600),t.imageContainer.addChild(i),this.addChild(t),t.x=u[r-1],t.y=800},i}(createjs.Container);t.GameTitle=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(n){t.call(this);this.dropAllJellys(n)}return __extends(i,t),i.prototype.dropAllJellys=function(t){var e=this,r,u,f,i;for(t||(t=1),t>n.JoinJelly.maxJelly&&(t=n.JoinJelly.maxJelly),r=[],i=1;i<=t;i*=2)r.push(i);for(u=0,f=1,i=0;i<r.length;i++)setTimeout(function(){e.dropJelly(f,u);u++;f*=2},i*200)},i.prototype.dropJelly=function(t,i){var u=[[3/6,0],[2/6,.2],[4/6,.2],[1/6,.4],[5/6,.4],[2/5,1],[3/5,1],[1/5,1.7],[4/5,1.7],[1/6,3],[2/6,2.4],[4/6,2.4],[5/6,3],[2/7,3.3],[3/7,2.9],[4/7,3.1],[5/7,3.3],],r=new n.gameplay.view.Jelly,f;this.addChildAt(r,0);r.setNumber(t);f=i%2?-1:1;r.x=(u[i][0]*defaultWidth-defaultWidth/2)*1.2;r.y=u[i][1]*-200+750;r.scaleX=r.scaleY=Math.min(1-u[i][1]/7,1);gameui.AudiosManager.playSound("sound_s"+(Math.floor(Math.random()*3)+1),null,400)},i}(createjs.Container);t.JellyLobby=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){i===void 0&&(i=1022);n.call(this);this.top=defaultHeight/2+1022-i;this.regX=this.x=defaultWidth/2;this.regY=this.y=defaultHeight/2;this.AddBG(i);this.addTitle(t);this.visible=!1}return __extends(t,n),t.prototype.setTitle=function(n){this.title.text=n.toUpperCase();this.title.regX=this.title.getBounds().width/2},t.prototype.AddBG=function(n){var i=gameui.AssetsManager.getBitmap("popupdark"),t;this.addChild(i);i.scaleX=i.scaleY=16;i.x=-defaultWidth/2;i.y=-defaultHeight/2;i.mouseEnabled=!1;t=gameui.AssetsManager.getBitmap("FlyBG");t.set({x:defaultWidth/2,y:557,regX:1305/2});t.scaleY=n/1022;this.addChild(t);t.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(-t.x+t.regX,-t.y+t.regY,defaultWidth,defaultHeight))},t.prototype.addTitle=function(n){this.title=gameui.AssetsManager.getBitmapText("","debussyBig");this.title.set({x:defaultWidth/2,y:580});this.addChild(this.title);this.setTitle(n)},t.prototype.animateIn=function(){createjs.Tween.removeTweens(this);this.visible=!0;this.y=this.top-500;this.alpha=0;this.scaleX=.5;this.scaleY=2;createjs.Tween.get(this).to({x:defaultWidth/2,y:this.top,alpha:1,scaleX:1,scaleY:1},1400,createjs.Ease.elasticOut)},t.prototype.animateOut=function(){var n=this;createjs.Tween.removeTweens(this);this.alpha=1;this.scaleX=1;this.scaleY=1;createjs.Tween.get(this).to({alpha:0,scaleX:.5,scaleY:.75},200,createjs.Ease.quadIn).call(function(){n.visible=!1})},t.prototype.show=function(){this.animateIn();gameui.AudiosManager.playSound("Interface Sound-14")},t.prototype.hide=function(){this.visible&&(this.animateOut(),gameui.AudiosManager.playSound("Interface Sound-15"))},t}(createjs.Container);n.FlyOutMenu=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(i,r,u){var h,o;t.call(this);h=gameui.AssetsManager.getBitmap("pediaItem");this.addChild(h);var s=new createjs.Container,f=gameui.AssetsManager.getBitmapText(r,"debussyBig"),e=gameui.AssetsManager.getBitmapText(u,"debussy");f.y=30;e.y=130;f.scaleX=f.scaleY=.9;e.scaleX=e.scaleY=.9;f.x=e.x=450;s.addChild(f);s.addChild(e);this.addChild(s);o=new n.gameplay.view.Jelly;o.setNumber(i);o.x=166;o.y=332;this.addChild(o)}return __extends(i,t),i}(createjs.Container);t.JellyPediaItem=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(i){function r(t){var r,u,f;i.call(this,StringResources.store.title);this.previousScreen=t;r=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy");r.y=500;r.x=defaultWidth/2;r.regX=r.getBounds().width/2;this.StatusText=r;this.scrollableContent.addChild(r);u=new n.view.LoadingBall;u.y=800;u.x=defaultWidth/2;this.loadingBall=u;this.scrollableContent.addChild(u);this.gameFooter=new n.gameplay.view.ItemsFooter([n.Items.TIME,n.Items.CLEAN,n.Items.FAST,n.Items.REVIVE]);this.footer.addChild(this.gameFooter);this.gameFooter.mouseEnabled=!1;this.updateFooter();this.content.y-=200;this.okButtonAction=function(){n.JoinJelly.gameScreen.switchScreen(t)};this.initializeStore();f=new gameui.BitmapTextButton(StringResources.menus.restore,"debussy","BtTextBg",function(){Cocoon.Dialog.confirm({title:StringResources.menus.restore,message:StringResources.menus.restoreWarning},function(n){n&&Cocoon.Store.restore()})});f.x=defaultWidth/3;f.y=defaultHeight-200;this.content.addChild(f)}return __extends(r,i),r.prototype.fillProducts=function(n){this.productsListItems={};this.showLoaded();for(var t in n)this.addProduct(n[t],t)},r.prototype.addProduct=function(n,i){var u=this,r=new t.view.ProductListItem(n.productId,n.title.replace("(Join Jelly)",""),n.description,n.localizedPrice);this.productsListItems[n.productId]=r;this.scrollableContent.addChild(r);r.y=i*380+380;r.x=70;console.log(JSON.stringify(n));r.addEventListener("buy",function(n){Cocoon.Store.purchase(n.productId)});r.addEventListener("share",function(n){var t=n.currentTarget;t.setPurchasing();u.lockUI();u.purchaseShareProduct(n.productId,function(n){n?(t.setPurchased(),gameui.AudiosManager.playSound("Interface Sound-11")):t.setNormal();u.updateFooter();u.unlockUI()})})},r.prototype.showLoading=function(){this.StatusText.text=StringResources.menus.loading;this.loadingBall.visible=!0},r.prototype.showLoaded=function(){this.StatusText.visible=!1;this.loadingBall.visible=!1},r.prototype.showError=function(){this.StatusText.text=StringResources.menus.error;this.loadingBall.visible=!1},r.prototype.lockUI=function(n){var t=this;n===void 0&&(n=5e3);this.content.mouseEnabled=!1;setTimeout(function(){t.unlockUI()},n)},r.prototype.unlockUI=function(){this.content.mouseEnabled=!0},r.prototype.updateFooter=function(){var t=n.ItemsData.items;for(var i in t)this.gameFooter.setItemAmmount(t[i],n.JoinJelly.itemData.getItemAmmount(t[i]))},r.prototype.getProductListItem=function(n){return this.productsListItems[n]},r.prototype.initializeStore=function(){var n=this,t,i;Cocoon.Store.on("load",{started:function(){n.showLoading()},success:function(t){n.fillProducts(t)},error:function(){n.showError()}});Cocoon.Store.on("purchase",{started:function(t){n.getProductListItem(t).setPurchasing();n.lockUI()},success:function(t){n.fullFillPurchase(t.productId);n.updateFooter();n.unlockUI();productsData[t.productId].consumable&&(n.getProductListItem(t.productId).setPurchased(!0),Cocoon.Store.consume(t.transactionId,t.productId));n.getProductListItem(t.productId).setPurchased();Cocoon.Store.finish(t.transactionId)},error:function(t){n.getProductListItem(t).setNormal();n.unlockUI()}});Cocoon.Store.initialize({sandbox:!0,managed:!0});t=[];for(i in productsData)t.push(i);Cocoon.Store.loadProducts(t)},r.prototype.purchaseShareProduct=function(n,t){var i=Cocoon.Social.Facebook;i.init({appId:fbAppId});var r=i.getSocialInterface(),u=new Cocoon.Social.Message(StringResources.social.shareDescription,gameWebsiteIcon,gameWebsite,StringResources.social.shareTitle,StringResources.social.shareCaption),f=this;r.publishMessageWithDialog(u,function(i){console.log("shared "+JSON.stringify(i));var r=!0;i&&(r=!1);r&&f.fullFillPurchase(n);t(r)})},r.prototype.updateProductsAvaliability=function(){},r.prototype.fullFillPurchase=function(t){switch(t){case"time5x":n.JoinJelly.itemData.increaseItemAmmount("time",5);break;case"fast5x":n.JoinJelly.itemData.increaseItemAmmount("fast",5);break;case"clean5x":n.JoinJelly.itemData.increaseItemAmmount("clean",5);break;case"revive5x":n.JoinJelly.itemData.increaseItemAmmount("revive",5);break;case"pack5x":n.JoinJelly.itemData.increaseItemAmmount("time",5);n.JoinJelly.itemData.increaseItemAmmount("clean",5);n.JoinJelly.itemData.increaseItemAmmount("fast",5);n.JoinJelly.itemData.increaseItemAmmount("revive",5);break;case"pack10x":n.JoinJelly.itemData.increaseItemAmmount("clean",10);n.JoinJelly.itemData.increaseItemAmmount("fast",10);n.JoinJelly.itemData.increaseItemAmmount("time",10);n.JoinJelly.itemData.increaseItemAmmount("revive",10);break;case"lucky":n.JoinJelly.itemData.increaseItemAmmount("lucky",1)}return!0},r}(n.ScrollablePage);t.StoreMenu=i})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(i){function r(){var f,e,o;i.call(this,StringResources.menus.menu);this.maxScroll=1700;var r=270,u=400,s=new t.view.SoundOptions;this.scrollableContent.addChild(s);this.scrollableContent.x=defaultWidth/2;s.y=u+=r;f=new t.view.PlayerNameOptions;this.scrollableContent.addChild(f);f.y=u+=r+80;e=new gameui.BitmapTextButton(StringResources.menus.tutorial,"debussy","BtTextBg",function(){n.JoinJelly.startTutorial()});e.y=u+=r;this.scrollableContent.addChild(e);o=new gameui.BitmapTextButton(StringResources.menus.reset,"debussy","BtTextBg",function(){Cocoon.Dialog.confirm({title:StringResources.menus.reset,message:StringResources.menus.resetWarning},function(t){t&&(n.JoinJelly.userData.resetAll(),n.JoinJelly.showMainMenu())})});o.y=u+=r;this.scrollableContent.addChild(o)}return __extends(r,i),r}(n.ScrollablePage);t.MainMenu=i})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t=function(n){function t(){n.call(this,StringResources.menus.about);this.maxScroll=1700}return __extends(t,n),t}(n.ScrollablePage);n.About=t}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.addSoundOptions()}return __extends(i,t),i.prototype.addSoundOptions=function(){var i=this,r=gameui.AssetsManager.getBitmap("FlyGroup"),t,u,f;r.y=-130;r.regX=r.getBounds().width/2;this.addChild(r);t=gameui.AssetsManager.getBitmapText(StringResources.menus.sound,"debussy");t.y=-190;t.scaleX=t.scaleY=1.1;t.regX=t.getBounds().width/2;this.addChild(t);this.musicBtOn=new gameui.ImageButton("BtMusic",function(){i.setMusic(0)});this.musicBtOn.x=-145;this.addChild(this.musicBtOn);this.soundBtOn=new gameui.ImageButton("BtSound",function(){i.setSound(0)});this.soundBtOn.x=155;this.addChild(this.soundBtOn);this.musicBtOff=new gameui.ImageButton("BtMusicOff",function(){i.setMusic(1)});this.musicBtOff.x=-145;this.addChild(this.musicBtOff);this.soundBtOff=new gameui.ImageButton("BtSoundOff",function(){i.setSound(1)});this.soundBtOff.x=155;this.addChild(this.soundBtOff);u=n.JoinJelly.userData.getMusicVol();f=n.JoinJelly.userData.getSoundVol();this.musicBtOff.visible=!u;this.soundBtOff.visible=!f;this.musicBtOn.visible=!!u;this.soundBtOn.visible=!!f},i.prototype.setMusic=function(t){t?(this.musicBtOff.fadeOut(),this.musicBtOn.fadeIn()):(this.musicBtOn.fadeOut(),this.musicBtOff.fadeIn());n.JoinJelly.userData.setMusicVol(t);gameui.AudiosManager.setMusicVolume(t?1:0)},i.prototype.setSound=function(t){t?(this.soundBtOff.fadeOut(),this.soundBtOn.fadeIn()):(this.soundBtOn.fadeOut(),this.soundBtOff.fadeIn());n.JoinJelly.userData.setSoundVol(t);gameui.AudiosManager.setSoundVeolume(t?1:0)},i}(createjs.Container);t.SoundOptions=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.shadowContainer=new createjs.Container;this.imageContainer=new createjs.Container;this.addChild(this.shadowContainer);this.addChild(this.imageContainer)}return __extends(t,n),t.prototype.executeAnimationIn=function(n){var t=this;(n===void 0&&(n=0),this.state!="in")&&(this.state="in",this.restore(),this.imageContainer.set({alpha:0,scaleX:0,scaleY:0,y:-40}),this.shadowContainer.set({alpha:0,scaleX:0}),createjs.Tween.get(this.imageContainer).wait(n).to({alpha:1,scaleX:.8,scaleY:1.2},200,createjs.Ease.sineOut).to({scaleX:1,scaleY:1,y:0},2e3,createjs.Ease.elasticOut).call(function(){t.executeIdle()}),createjs.Tween.get(this.shadowContainer).wait(n).to({alpha:1,scaleX:1,scaleY:1},400,createjs.Ease.sineOut).call(function(){}))},t.prototype.executeAnimationHold=function(){this.state!="hold"&&(this.state="hold",this.restore(),createjs.Tween.get(this.imageContainer).to({scaleX:.8,scaleY:1.2},1e3,createjs.Ease.elasticOut),createjs.Tween.get(this.shadowContainer).to({alpha:0},200))},t.prototype.executeAimationRelease=function(){var n=this;this.state!="release"&&(this.state="release",this.restore(),createjs.Tween.get(this.imageContainer).to({scaleX:.8,scaleY:1.2},5,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},2e3,createjs.Ease.elasticOut).call(function(){n.executeIdle()}),createjs.Tween.get(this.shadowContainer).to({alpha:1},200))},t.prototype.restore=function(){this.state="";createjs.Tween.removeTweens(this.imageContainer);createjs.Tween.removeTweens(this.shadowContainer);this.visible=!0;this.alpha=1;this.imageContainer.scaleX=this.imageContainer.scaleY=1;this.imageContainer.skewX=this.imageContainer.skewY=0;this.imageContainer.rotation=0;this.imageContainer.alpha=1;this.imageContainer.visible=!0;this.imageContainer.y=0;this.shadowContainer.visible=!0;this.shadowContainer.alpha=1;this.shadowContainer.skewX=this.shadowContainer.skewY=0},t.prototype.executeIdle=function(){if(this.state!="idle"){this.state="idle";switch(Math.floor(Math.random()*3)){case 0:this.executeIdle1();break;case 1:this.executeIdle2();break;case 2:this.executeIdle3()}}},t.prototype.executeIdle1=function(){var r=this,t=Math.random()*500+600,i=Math.random(),n,u;i<.6&&(i=i/2);n=Math.random();u=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({skewX:0,scaleX:1+n,scaleY:1-n},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(r.imageContainer,{loop:!0}).to({skewX:i*10},t,createjs.Ease.quadOut).to({skewX:i*0},t,createjs.Ease.quadIn).to({skewX:i*-10},t,createjs.Ease.quadOut).to({skewX:i*0},t,createjs.Ease.quadIn);createjs.Tween.get(r.imageContainer,{loop:!0}).to({scaleX:1-n,scaleY:1+n},t,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t,createjs.Ease.quadInOut).to({scaleX:1-n,scaleY:1+n},t,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t,createjs.Ease.quadInOut)});createjs.Tween.get(this.shadowContainer).to({alpha:1,scaleY:1,scaleX:1,skewX:0},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(r.shadowContainer,{loop:!0}).to({skewX:-5*i},t,createjs.Ease.quadOut).to({skewX:0*i},t,createjs.Ease.quadIn).to({skewX:5*i},t,createjs.Ease.quadOut).to({skewX:0*i},t,createjs.Ease.quadIn)})},t.prototype.executeIdle2=function(){var r=this,t=Math.random()*500+600,i=Math.random(),n,u;i<.6&&(i=i/2);n=Math.random()*.5+.5;u=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({scaleX:1,scaleY:1},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(r.imageContainer,{loop:!0}).to({scaleX:1-n,scaleY:1+n},t/4,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t/4,createjs.Ease.quadInOut).to({scaleX:1-n,scaleY:1+n},t/4,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t/4,createjs.Ease.quadInOut).to({scaleX:1,scaleY:1},t*2,createjs.Ease.elasticOut)})},t.prototype.executeIdle3=function(){var r=this,t=Math.random()*500+600,i=Math.random(),n,u;i<.6&&(i=i/2);n=Math.random()*.5+.5;u=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({scaleX:1,scaleY:1,y:0},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(r.imageContainer,{loop:!0}).to({scaleX:1+n*2,scaleY:1-n*2,y:0},t/2,createjs.Ease.quadInOut).to({scaleX:1-n*2,scaleY:1+n*2,y:0},t/4,createjs.Ease.quadIn).to({scaleX:1+n*1,scaleY:1-n*1,y:-70},t/4,createjs.Ease.quadOut).to({scaleX:1-n*2,scaleY:1+n*2,y:0},t/5,createjs.Ease.quadIn).to({scaleX:1,scaleY:1},t*2,createjs.Ease.elasticOut)})},t}(createjs.Container);n.JellyContainer=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){var i;n.call(this);i=gameui.AssetsManager.getBitmap("loadingBall");this.addChild(i);i.regX=47;i.regY=94;i.y=47;var r=600,u=1,t=.1;createjs.Tween.get(i).to({skewX:0,scaleX:1+t,scaleY:1-t},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(i,{loop:!0}).to({skewX:u*10},r,createjs.Ease.quadOut).to({skewX:u*0},r,createjs.Ease.quadIn).to({skewX:u*-10},r,createjs.Ease.quadOut).to({skewX:u*0},r,createjs.Ease.quadIn);createjs.Tween.get(i,{loop:!0}).to({scaleX:1-t,scaleY:1+t},r,createjs.Ease.quadInOut).to({scaleX:1+t,scaleY:1-t},r,createjs.Ease.quadInOut).to({scaleX:1-t,scaleY:1+t},r,createjs.Ease.quadInOut).to({scaleX:1+t,scaleY:1-t},r,createjs.Ease.quadInOut)})}return __extends(t,n),t}(createjs.Container);n.LoadingBall=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.addObjects()}return __extends(i,t),i.prototype.addObjects=function(){var s=this,o=new gameui.ImageButton("BtPause",function(){s.dispatchEvent("pause")}),e,i,r,t,u,f;o.x=157;o.y=215;this.addChild(o);e=gameui.AssetsManager.getBitmap("bonus_border");this.addChild(e);e.x=309;e.y=122;i=gameui.AssetsManager.getBitmap("bonus_bar");i.x=372;i.y=207;i.mask=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,0,939,57));i.mask.x=372;i.mask.y=207;this.levelBar=i;this.addChild(i);r=gameui.AssetsManager.getBitmap("powerTip");r.x=372;r.y=207;r.regX=67/2;r.regY=77/2;this.levelTip=r;this.addChild(r);t=gameui.AssetsManager.getBitmap("bonus_icon");t.x=1288+213/2;t.y=90+243/2;t.regX=213/2;t.regY=243/2;t.mouseEnabled=!0;this.levelIcon=t;this.addChild(t);t.addEventListener("click",function(){s.levelUpEffect()});this.effect=new n.view.Effect;this.addChild(this.effect);this.effect.x=1288+213/2;this.effect.y=90+243/2;u=gameui.AssetsManager.getBitmapText(StringResources.menus.score,"debussy");u.x=373;u.y=124;u.scaleX=u.scaleY=.85;this.scoreText=u;this.addChild(u);f=gameui.AssetsManager.getBitmapText(StringResources.menus.level,"debussyBig");f.x=1e3;f.y=77;this.levelText=f;this.addChild(f)},i.prototype.updateStatus=function(n,t,i){this.scoreText.text=StringResources.menus.score.toUpperCase()+" "+n.toString();this.levelText.text="Lv. "+t.toString();var r=1;i!=undefined&&n!=this.lastScore&&(r=i/100,createjs.Tween.removeTweens(this.levelBar.mask),createjs.Tween.get(this.levelBar.mask).to({scaleX:r},1e3,createjs.Ease.elasticOut),createjs.Tween.removeTweens(this.levelTip),createjs.Tween.get(this.levelTip).to({x:r*940+this.levelBar.x,y:this.levelBar.y+24},1e3,createjs.Ease.elasticOut),createjs.Tween.get(this.levelTip).to({scaleX:2,scaleY:2}).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut));this.lastLevel!=t&&this.levelUpEffect();this.lastLevel=t;this.lastScore=n},i.prototype.levelUpEffect=function(){var n=this;this.effect.castBoth();createjs.Tween.removeTweens(this.levelBar.mask);createjs.Tween.get(this.levelBar.mask).to({scaleX:1},100,createjs.Ease.quadIn).call(function(){n.levelBar.mask.scaleX=0});createjs.Tween.removeTweens(this.levelText);this.levelText.set({scaleY:0,scaleX:4});createjs.Tween.get(this.levelText).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut);createjs.Tween.removeTweens(this.levelIcon);this.levelIcon.set({scaleY:2,scaleX:.1});createjs.Tween.get(this.levelIcon).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut)},i}(createjs.Container);t.GameHeader=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.effect=new n.view.Effect;this.addChild(this.effect);this.effect.scaleX=this.effect.scaleY=1.2;this.effect.x=0;this.effect.y=-100}return __extends(i,t),i.prototype.getAssetIdByValue=function(n){return n<0?n.toString():i.jellies[Math.log(n)/Math.log(2)]},i.prototype.createJelly=function(n){var t=gameui.AssetsManager.getBitmap("j"+this.getAssetIdByValue(n)),i;t.regX=t.getBounds().width/2;t.regY=t.getBounds().height;i=gameui.AssetsManager.getBitmap("shadow");i.regY=45;i.regX=108;i.scaleX=i.scaleY=t.getBounds().width/216;this.shadowContainer.addChild(i);this.imageContainer.addChild(t)},i.prototype.createEyes=function(n){var t=new createjs.Container,i=gameui.AssetsManager.getBitmap("e"+this.getAssetIdByValue(n));i.regY=20;createjs.Tween.get(i,{loop:!0}).wait(3e3+Math.random()*1e3).to({scaleY:.2},100).to({scaleY:1},100);t.addChild(i);t.regX=133/2;i.getBounds()&&(t.regX=i.getBounds().width/2);t.y=Math.min(-50,-t.getBounds().height);this.imageContainer.addChild(t);this.eyeImg=i},i.prototype.setNumber=function(t){(t>n.JoinJelly.maxJelly&&(t=n.JoinJelly.maxJelly),this.currentValue!=t)&&(this.currentValue=t,this.eyeImg&&createjs.Tween.removeTweens(this.eyeImg),this.imageContainer.removeAllChildren(),this.shadowContainer.removeAllChildren(),t!=0&&t?(this.visible=!0,this.alpha=1,this.createJelly(t),this.createEyes(t),this.executeAnimationIn(),t>1&&this.playJoinFX()):this.visible=!1)},i.prototype.playJoinFX=function(){this.effect.alpha=.5;this.effect.castSimple()},i.prototype.playLevelUp=function(){this.effect.alpha=.25;this.effect.castSimple()},i.prototype.playEvolve=function(){this.effect.alpha=1;this.effect.castBoth()},i.prototype.playThunder=function(){var n=this;setTimeout(function(){n.playEvolve()},10);setTimeout(function(){n.playLevelUp()},330);setTimeout(function(){n.playEvolve()},660);setTimeout(function(){n.playLevelUp()},1e3);setTimeout(function(){n.playLevelUp()},1100)},i.jellies=["1","2","4","8","16","32","64","128","256","512","1024","oil","2048","square","4096","8192b","8192",],i}(n.view.JellyContainer);t.Jelly=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.showLevel=function(n){var i=this,t=gameui.AssetsManager.getBitmapText("level","debussy");this.addChild(t);t.text="LEVEL "+n;t.x=defaultWidth/2;t.y=defaultHeight/2+140;t.alpha=0;t.regX=t.getBounds().width/2;createjs.Tween.get(t).to({y:defaultHeight/2,alpha:1},200,createjs.Ease.quadOut).wait(500).to({y:defaultHeight/2-200,alpha:0},200,createjs.Ease.quadIn).call(function(){i.removeChild(t);delete t})},t}(createjs.Container);n.LevelIndicator=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){var s=this;n.call(this);this.ammount=0;this.locked=!1;this.item=t;this.addEventListener("click",function(){s.dispatchEvent({type:"useitem",item:t})});var f=gameui.AssetsManager.getBitmap("itemBG"),e=gameui.AssetsManager.getBitmap("itemBGDisabled"),i=gameui.AssetsManager.getBitmap("item"+t),u=gameui.AssetsManager.getBitmapText("0","debussy"),r=gameui.AssetsManager.getBitmapText(StringResources.items[t],"debussy"),o=gameui.AssetsManager.getBitmap("BtPlusMini");this.disabled=e;this.addChild(f);this.addChild(e);this.addChild(i);this.addChild(u);this.addChild(r);this.addChild(o);e.visible=!1;e.regX=f.regX=f.getBounds().width/2;e.regY=f.regY=f.getBounds().height/2;i.regX=i.getBounds().width/2;i.regY=i.getBounds().height/2;i.scaleX=i.scaleY=.4;i.y=-25;u.scaleX=u.scaleY=.7;u.y=-110;u.x=-80;u.name="value";r.scaleX=r.scaleY=.6;r.y=30;r.x=0;r.regX=r.getBounds().width/2;r.name="value";o.y=0;o.x=55;this.text=u;this.createHitArea();this.addBt=o;this.addEventListener("click",function(){s.unHighlight()})}return __extends(t,n),t.prototype.setAmmount=function(n){this.ammount=n;this.ammount<=0?(this.disabled.visible=!0,this.addBt.visible=!0):(this.disabled.visible=!1,this.addBt.visible=!1);this.text.text=n.toString();this.updateColor()},t.prototype.lock=function(){this.mouseEnabled=!1;this.locked=!0;this.updateColor()},t.prototype.unlock=function(){this.mouseEnabled=!0;this.locked=!1;this.updateColor()},t.prototype.highLight=function(){createjs.Tween.get(this,{loop:!0}).to({rotation:-10,scaleX:1,scaleY:1},100,createjs.Ease.quadInOut).to({rotation:10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:-10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:0,scaleX:1,scaleY:1},100,createjs.Ease.quadInOut).wait(400)},t.prototype.unHighlight=function(){createjs.Tween.removeTweens(this);this.set({rotation:0,scaleX:1,scaleY:1})},t.prototype.updateColor=function(){this.disabled.visible=this.locked||this.ammount<=0?!0:!1},t}(gameui.Button);n.ItemButton=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this,StringResources.menus.pause);this.addButtons();var i=new n.menus.view.SoundOptions;this.addChild(i);i.set({x:defaultWidth/2,y:1e3})}return __extends(i,t),i.prototype.addButtons=function(){var n=this,r=new gameui.ImageButton("BtPlay",function(){n.dispatchEvent("play")}),t,i;r.set({x:771,y:1599});this.addChild(r);t=new gameui.ImageButton("BtHome",function(){n.dispatchEvent("home")});t.set({x:353,y:1570});this.addChild(t);i=new gameui.ImageButton("BtRestart",function(){n.dispatchEvent("restart")});i.set({x:1190,y:1570});this.addChild(i)},i}(n.menus.view.FlyOutMenu);t.PauseMenu=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.value=1;this.initializeObjects()}return __extends(t,n),t.prototype.initializeObjects=function(){var n=new createjs.Container,u=gameui.AssetsManager.getBitmap("time_bar"),t=gameui.AssetsManager.getBitmap("time_bar_bright"),r=gameui.AssetsManager.getBitmap("time_bar_red"),i;t.alpha=0;this.redFx=r;this.brightFx=t;createjs.Tween.get(this.redFx,{loop:!0}).to({alpha:0},500);n.addChild(u);this.addChild(r);n.addChild(t);this.addChild(n);i=new createjs.Shape;i.graphics.beginFill("red").drawRect(0,0,991,35);this.percentBarMask=i;n.mask=this.percentBarMask},t.prototype.setPercent=function(n,t){this.value<n&&this.incrasePercent();this.value=n;createjs.Tween.removeTweens(this.percentBarMask);createjs.Tween.get(this.percentBarMask).to({scaleX:n},200,createjs.Ease.quadInOut);t?this.setAlarmOn():this.setAlarmOff()},t.prototype.incrasePercent=function(){this.brightFx.alpha=1;createjs.Tween.get(this.brightFx).to({alpha:0},300)},t.prototype.setAlarmOn=function(){this.redFx.visible=!0},t.prototype.setAlarmOff=function(){this.redFx.visible=!1},t}(createjs.Container);n.TimeBar=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(i){var r=function(i){function r(){i.call(this,StringResources.menus.gameOver.toUpperCase(),1250);this.addButtons();this.addPoints();this.addLastJelly()}return __extends(r,i),r.prototype.addButtons=function(){var n=this,r=new gameui.ImageButton("BtOk",function(){n.dispatchEvent("ok")}),t,i;r.set({x:771,y:1810});this.addChild(r);t=new gameui.ImageButton("BtBoard",function(){n.dispatchEvent("board")});t.set({x:353,y:1780});this.addChild(t);i=new gameui.ImageButton("BtShare",function(){n.dispatchEvent("share")});i.set({x:1190,y:1780});this.addChild(i)},r.prototype.addPoints=function(){var t=new createjs.Container,i=gameui.AssetsManager.getBitmap("GameOverBgPoints"),n;return i.set({x:defaultWidth/2,y:565,regX:528}),t.addChild(i),n=gameui.AssetsManager.getBitmapText("Score","debussy"),n.set({x:288,y:442}),n.scaleX=n.scaleY=.7,n=gameui.AssetsManager.getBitmapText("","debussyBig"),n.set({x:defaultWidth/2,y:587}),t.addChild(n),this.scoreText=n,n=gameui.AssetsManager.getBitmapText("","debussy"),n.set({x:1240,y:775}),t.addChild(n),n.scaleX=n.scaleY=.7,this.highScoreText=n,t.y+=260,this.addChild(t),t},r.prototype.addLastJelly=function(){var i=new createjs.Container,u,r,n;return this.addChild(i),u=gameui.AssetsManager.getBitmap("GameOverBgJelly"),u.set({x:defaultWidth/2,y:951,regX:797/2}),i.addChild(u),n=gameui.AssetsManager.getBitmapText(StringResources.menus.highJelly,"debussy"),n.set({x:420,y:820}),n.scaleX=n.scaleY=.5,r=new t.view.Jelly,i.addChild(r),this.addChild(i),r.scaleX=r.scaleY=1,r.set({x:defaultWidth/2,y:1350}),this.jelly=r,n=gameui.AssetsManager.getBitmapText("1","debussy"),n.set({x:defaultWidth/2,y:1358}),n.scaleX=n.scaleY=.7,this.jellyText=n,i.addChild(n),i.y+=200,i},r.prototype.setValues=function(t,i,r,u){var e=this,f,o;i>n.JoinJelly.maxJelly&&(i=n.JoinJelly.maxJelly);u&&this.setTitle(u);f={value:0};createjs.Tween.get(f).to({value:1},3e3,createjs.Ease.quadOut);o=setInterval(function(){e.scoreText.text=Math.floor(f.value*t).toString();e.scoreText.regX=e.scoreText.getBounds().width/2;f.value>=1&&clearInterval(o)},30);this.highScoreText.text=StringResources.menus.highScore+": "+i.toString();this.jelly.setNumber(r);this.jellyText.text=StringResources.jellys[r].name;this.jellyText.getBounds()&&(this.jellyText.regX=this.jellyText.getBounds().width/2);this.highScoreText.regX=this.highScoreText.getBounds().width},r}(n.menus.view.FlyOutMenu);i.FinishMenu=r})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.fingerUp=gameui.AssetsManager.getBitmap("tutorialFinger");this.fingerDown=gameui.AssetsManager.getBitmap("tutorialFingerDown");this.addChild(this.fingerUp);this.addChild(this.fingerDown);this.fingerDown.y=this.fingerUp.image.height-this.fingerDown.image.height;this.regX=80;this.mouseEnabled=!1;this.visible=!1}return __extends(t,n),t.prototype.showMove=function(n,t,i,r){var u=this;this.visible=!0;this.x=n;this.y=t;this.alpha=0;this.fu();createjs.Tween.removeTweens(this);createjs.Tween.get(this,{loop:!0}).to({alpha:1},500).call(function(){u.fd()}).to({x:i,y:r},1600,createjs.Ease.quadInOut).call(function(){u.fu()}).to({alpha:0},500)},t.prototype.showClick=function(n,t){var i=this;this.visible=!0;this.x=n;this.y=t;this.alpha=1;this.fu();createjs.Tween.removeTweens(this);createjs.Tween.get(this,{loop:!0}).wait(500).call(function(){i.fd()}).wait(1e3).call(function(){i.fu()})},t.prototype.fd=function(){this.fingerDown.visible=!0;this.fingerUp.visible=!1},t.prototype.fu=function(){this.fingerDown.visible=!1;this.fingerUp.visible=!0},t.prototype.hide=function(){createjs.Tween.removeTweens(this);this.visible=!1},t}(createjs.Container);n.TutorialMove=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){var i=this,t;n.call(this);this.addChild(gameui.AssetsManager.getBitmap("ballon"));this.visible=!1;this.regX=316;this.regY=366;this.x=164+this.regX;this.y=941+this.regY;t=gameui.AssetsManager.getBitmapText("","debussy");this.addChild(t);t.scaleX=t.scaleY=.8;t.x=50;t.y=50;this.bitmapText=t;t.mouseEnabled=!1;this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(-this.x+this.regX,-this.y+this.regY,defaultWidth,defaultHeight));this.addEventListener("click",function(){i.fadeOut();i.dispatchEvent("closed");gameui.AudiosManager.playSound("Interface Sound-15")})}return __extends(t,n),t.prototype.show=function(n){this.bitmapText.text=n;this.fadeIn();gameui.AudiosManager.playSound("Interface Sound-14")},t}(gameui.Button);n.TutoralMessage=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(t){function i(n,i,r,u){t.call(this);this.touchDictionary=[];this.alarming=!1;this.tiles=[];this.boardHeight=i;this.boardWidth=n;this.tileSize=r;this.tilesContainer=new createjs.Container;this.addChild(this.tilesContainer);this.tilesContainer.hitArea=new createjs.Shape((new createjs.Graphics).f("red").r(0,0,n*r,(i+.5)*r));this.addTiles(n,i,r,u);this.addMouseEvents(r);this.regX=n*r/2;this.regY=i*r/2}return __extends(i,t),i.prototype.addTiles=function(n,t,i){for(var u,r=0;r<n;r++)for(u=0;u<t;u++)this.addTile(r,u,i)},i.prototype.addTile=function(t,i,r){var f=gameui.AssetsManager.getBitmap("hex"),u;this.tilesContainer.addChild(f);f.regX=179;f.regY=0;f.alpha=.15;f.set(this.getTilePositionByCoords(t,i,r,0));u=new n.Tile(t,i,r);this.tiles.push(u);this.tilesContainer.addChild(u);u.setNumber(0);u.name=(this.boardWidth*i+t).toString();u.set(this.getTilePositionByCoords(t,i,r))},i.prototype.addMouseEvents=function(n){var t=this,i=[];this.tilesContainer.addEventListener("mousedown",function(r){var u=t.getTileByRawPos(r.localX,r.localY,n);u&&u.isUnlocked()&&u.isEnabled()&&(u.lock(),t.touchDictionary[r.pointerID]=u,i[r.pointerID]={x:u.x-r.localX,y:u.y-r.localY},u.drag(),t.tilesContainer.setChildIndex(u,t.tilesContainer.getNumChildren()-1),gameui.AudiosManager.playSound("soundh_1"))});this.tilesContainer.addEventListener("pressmove",function(r){var u=t.touchDictionary[r.pointerID],f,o,e;u&&(u.x=r.localX+i[r.pointerID].x,u.y=r.localY+i[r.pointerID].y,u.lock(),f=t.getTileByRawPos(r.localX,r.localY,n),f&&f.name.toString()!=u.name&&f.isUnlocked()&&(o={origin:u,target:f},e=new createjs.Event("dragging",!1,!1),e.originTile=u,e.targetTile=f,t.dispatchEvent(e)))});this.tilesContainer.addEventListener("pressup",function(n){var i=t.touchDictionary[n.pointerID];i&&(i.unlock,t.releaseDrag(i,!1),i.release())})},i.prototype.setTiles=function(n){this.unlock();for(var t in n)this.setTileValue(t,n[t]),this.getTileById(t).unlock(),this.getTileById(t).enable()},i.prototype.setTileValue=function(n,t){var i=this.getTileById(n);i&&i.setNumber(t);t==1&&gameui.AudiosManager.playSound("sound_s"+(Math.floor(Math.random()*3)+1),null,400)},i.prototype.getTileIdByPos=function(n,t,i){var r=this.getTileCoordsByRawPos(n,t,i);return this.boardWidth*r.y+r.x},i.prototype.getTileByRawPos=function(n,t,i){var r=this.getTileIdByPos(n,t,i);return this.getTileById(r)},i.prototype.getTileCoordsByRawPos=function(n,t,i){var r=Math.floor(n/i),u=r==1||r==3?i/2:0,f=Math.floor((t-u)/i);return{x:r,y:f}},i.prototype.getTileByIndex=function(n,t){var i=this.boardWidth*t+n;return this.getTileById(i)},i.prototype.getTilePositionByCoords=function(n,t,i,r){r===void 0&&(r=1);var u=n==1||n==3?i/2:0;return{x:(n+1/2)*i+r*(Math.random()-.5)*i/10,y:(t+1/2)*i+r*(Math.random()-.5)*i/10+u-i/5}},i.prototype.getTileById=function(n){return this.tilesContainer.getChildByName(n.toString())},i.prototype.releaseAll=function(){for(var n in this.touchDictionary)this.releaseDrag(this.touchDictionary[n])},i.prototype.sumAllTiles=function(){var n=0;for(var t in this.tiles)n+=this.tiles[t].getNumber();return n},i.prototype.getEmptyTiles=function(){for(var i=this.boardHeight*this.boardWidth,t=[],n=0;n<i;n++)this.tiles[n].isEmpty()&&t.push(this.tiles[n]);return t},i.prototype.getLockedTiles=function(){for(var i=this.boardHeight*this.boardWidth,t=[],n=0;n<i;n++)this.tiles[n].isUnlocked()||t.push(this.tiles[n]);return t},i.prototype.getAllTiles=function(){return this.tiles},i.prototype.getAllTilesValues=function(){for(var t=[],n=0;n<this.boardHeight*this.boardWidth;n++)t[n]=this.getTileById(n).getNumber();return t},i.prototype.getTileId=function(n){return parseInt(n.name)},i.prototype.getNeighborTiles=function(n){var r=[],f=this.getTileId(n),u=n.posx==1||n.posx==3?1:-1,t=[{x:n.posx,y:n.posy-1},{x:n.posx,y:n.posy+1},{x:n.posx-1,y:n.posy},{x:n.posx+1,y:n.posy},{x:n.posx-1,y:n.posy+u},{x:n.posx+1,y:n.posy+u},];for(var i in t)t[i].x>=0&&t[i].y>=0&&t[i].x<this.boardWidth&&t[i].y<this.boardHeight&&r.push(this.getTileByIndex(t[i].x,t[i].y));return r},i.prototype.getPercentEmptySpaces=function(){var n=this.boardHeight*this.boardWidth,t=this.getEmptyTiles().length;return t/n},i.prototype.releaseDrag=function(n,t,i){var f=this,u,r;t===void 0&&(t=!0);u=this.touchDictionary.indexOf(n);delete this.touchDictionary[u];createjs.Tween.removeTweens(n);n.scaleY=n.scaleX=1;t&&i?(r=this.getTilePositionByCoords(i.posx,i.posy,this.tileSize),this.fadeTileToPos(n,r.x,r.y)):(n.release(),createjs.Tween.get(n).to(this.getTilePositionByCoords(n.posx,n.posy,this.tileSize),200,createjs.Ease.sineInOut).call(function(){f.arrangeZOrder();n.unlock()}))},i.prototype.getHighestTileValue=function(){var n=0;for(var t in this.tiles)this.tiles[t].getNumber()>n&&(n=this.tiles[t].getNumber());return n},i.prototype.lock=function(){this.tilesContainer.mouseEnabled=!1},i.prototype.unlock=function(){this.tilesContainer.mouseEnabled=!0},i.prototype.arrangeZOrder=function(){for(var n=0;n<this.tiles.length;n++)this.tilesContainer.setChildIndex(this.tiles[n],this.tilesContainer.getNumChildren()-1)},i.prototype.match=function(n,t){this.releaseDrag(n,!0,t);t.set({scaleX:1.8,scaleY:1.8,alpha:0});createjs.Tween.get(t).to({scaleX:1,scaleY:1,alpha:1},140,createjs.Ease.cubicOut);gameui.AudiosManager.playSound("sound_j"+(Math.floor(Math.random()*4)+1))},i.prototype.cleanBoard=function(){for(var n in this.tiles)this.tiles[n].setNumber(0)},i.prototype.fadeTileToPos=function(n,t,i,r,u,f){var e=this;r===void 0&&(r=100);u===void 0&&(u=0);f===void 0&&(f=0);n.lock();createjs.Tween.get(n).wait(u).to({x:t,y:i,alpha:f},r,createjs.Ease.quadInOut).call(function(){n.set(e.getTilePositionByCoords(n.posx,n.posy,e.tileSize));e.arrangeZOrder();n.unlock();n.alpha=1})},i.prototype.levelUpEffect=function(){var n=this,t=0;for(var i in this.tiles)setTimeout(function(){var r=n.boardHeight*n.boardWidth-(t%n.boardWidth*n.boardWidth+Math.floor(t/n.boardWidth))-1,i=n.tiles[r];createjs.Tween.get(i).to({scaleY:1.5},100).to({scaleY:1},100);i.jelly.playLevelUp();t++},20*i)},i.prototype.endGameEffect=function(){var n=this,t=0;for(var i in this.tiles)setTimeout(function(){t++;var r=t%n.boardWidth*n.boardWidth+Math.floor(t/n.boardWidth),i=n.tiles[r];createjs.Tween.get(i).to({scaleY:.5},100).to({scaleY:1},100);i.jelly.playLevelUp()},20*i)},i.prototype.setAlarm=function(n){if(n){if(this.alarming)return;createjs.Tween.get(this.tilesContainer,{loop:!0}).to({x:-10},50).to({x:10},100).to({x:-10},100).to({x:0},50).wait(200)}else{if(!this.alarming)return;createjs.Tween.removeTweens(this.tilesContainer)}this.alarming=n},i}(createjs.Container);n.Board=t})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(i){function r(n,r,u){i.call(this);this.tileSize=u;this.posx=n;this.posy=r;this.regX=this.regY=u/2;this.jelly=new t.view.Jelly;this.jelly.x=u/2;this.jelly.y=u;this.jelly.scaleX=this.jelly.scaleY=this.tileSize/450;this.addChild(this.jelly);this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("000").drawRect(0,0,u,u))}return __extends(r,i),r.prototype.release=function(){this.jelly.executeAimationRelease();this.unlock()},r.prototype.drag=function(){this.jelly.executeAnimationHold()},r.prototype.isUnlocked=function(){return!this.locked},r.prototype.lock=function(){this.locked=!0},r.prototype.unlock=function(){this.locked=!1;this.jelly.setNumber(this.value)},r.prototype.enable=function(){this.enabled=!0},r.prototype.disable=function(){this.enabled=!1},r.prototype.isEnabled=function(){return this.enabled},r.prototype.setNumber=function(t){t>n.JoinJelly.maxJelly&&(t=n.JoinJelly.maxJelly);this.value=t;t>0?this.enable():this.disable();this.isUnlocked()&&this.jelly.setNumber(t)},r.prototype.getNumber=function(){return this.value},r.prototype.isEmpty=function(){return this.value==0},r}(createjs.Container);t.Tile=i})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var r=function(i){function r(t,r){i.call(this);this.matches=0;this.boardSize=5;this.itemProbability=.005;this.timeByLevel=2e4;this.initialInterval=800;this.finalInterval=300;this.easeInterval=.98;this.userData=t;this.score=0;this.createBackground();this.createBoard();this.createGUI();this.createEffects();this.start();r&&this.loadGame();n.JoinJelly.userData.getHistory("firstPlay")&&(n.JoinJelly.itemData.setItemAmmount(n.Items.REVIVE,1),n.JoinJelly.itemData.setItemAmmount(n.Items.TIME,2),n.JoinJelly.itemData.setItemAmmount(n.Items.FAST,2),n.JoinJelly.itemData.setItemAmmount(n.Items.CLEAN,2),n.JoinJelly.itemData.setItemAmmount(n.Items.LUCKY,0));n.JoinJelly.userData.history("firstPlay")}return __extends(r,i),r.prototype.createEffects=function(){this.freezeEffect=gameui.AssetsManager.getBitmap("freezeEffect");this.content.addChild(this.freezeEffect);this.normalizeEffect(this.freezeEffect);this.evolveEffect=gameui.AssetsManager.getBitmap("fxEvolve");this.content.addChild(this.evolveEffect);this.evolveEffect.regX=150;this.normalizeEffect(this.evolveEffect);this.reviveEffect=gameui.AssetsManager.getBitmap("reviveEffect");this.content.addChild(this.reviveEffect);this.normalizeEffect(this.reviveEffect);this.cleanEffect=gameui.AssetsManager.getBitmap("cleanEffect");this.content.addChild(this.cleanEffect);this.normalizeEffect(this.cleanEffect)},r.prototype.normalizeEffect=function(t){t.visible=!1;t.y=n.JoinJelly.gameScreen.headerPosition;t.scaleX=2;t.scaleY=2*n.JoinJelly.gameScreen.currentHeight/defaultHeight;t.mouseEnabled=!1},r.prototype.createBackground=function(){var n=gameui.AssetsManager.getBitmap("Background");this.background.addChild(n)},r.prototype.createBoard=function(){var n=this;this.board=new t.Board(this.boardSize,this.boardSize,1536/5,!0);this.board.addEventListener("dragging",function(t){n.dragged(t.originTile,t.targetTile)});this.content.addChild(this.board);this.board.x=defaultWidth/2;this.board.y=defaultHeight/2},r.prototype.createGUI=function(){var i=this,u,r;this.gameLevelIndicator=new t.view.LevelIndicator;this.content.addChild(this.gameLevelIndicator);this.gameHeader=new t.view.GameHeader;this.header.addChild(this.gameHeader);u=[n.Items.TIME,n.Items.CLEAN,n.Items.FAST];this.gameFooter=new t.view.ItemsFooter(u);this.gameFooter.lockItem(n.Items.REVIVE);this.footer.addChild(this.gameFooter);this.updateFooter();this.gameFooter.addEventListener("useitem",function(n){i.useItem(n.item)});this.pauseMenu=new t.view.PauseMenu;this.overlay.addChild(this.pauseMenu);this.finishMenu=new t.view.FinishMenu;this.overlay.addChild(this.finishMenu);this.finishMenu.y=-200;this.gameMessage=new t.view.TutoralMessage;this.content.addChild(this.gameMessage);this.countDown=new t.view.CountDown;this.content.addChild(this.countDown);this.countDown.x=defaultWidth/2;this.countDown.y=defaultHeight/2;r=new gameui.ImageButton("BtBoard",function(){i.finishMenu.show();r.fadeOut();gameui.AudiosManager.playSound("Interface Sound-06")});r.set({x:150,y:-150,visible:!1});this.footer.addChild(r);this.showBoardButton=r;this.finishMenu.addEventListener("ok",function(){n.JoinJelly.showMainMenu()});this.finishMenu.addEventListener("board",function(){i.finishMenu.hide();r.fadeIn()});this.finishMenu.addEventListener("share",function(){});this.gameHeader.addEventListener("pause",function(){i.pauseGame()});this.pauseMenu.addEventListener("play",function(){i.continueGame()});this.pauseMenu.addEventListener("test",function(){i.selfPeformanceTest(!1)});this.pauseMenu.addEventListener("testFast",function(){i.selfPeformanceTest(!0)});this.pauseMenu.addEventListener("home",function(){i.pauseMenu.hide();setTimeout(function(){n.JoinJelly.showMainMenu()},200);i.userData.deleteSaveGame()});this.pauseMenu.addEventListener("restart",function(){i.pauseMenu.hide();i.userData.deleteSaveGame();setTimeout(function(){n.JoinJelly.startLevel()},200)})},r.prototype.redim=function(n,t,r,u){i.prototype.redim.call(this,n,t,r,u);var f=(this.screenHeight-2048)/400;f<0&&(f=0);f>1&&(f=1);this.board.scaleX=this.board.scaleY=1-(.2-f*.2)},r.prototype.activate=function(n){var t=this;i.prototype.activate.call(this,n);this.gameHeader.alpha=0;setTimeout(function(){createjs.Tween.get(t.gameHeader).to({alpha:1},500)},500);this.updateFooter()},r.prototype.updateInterfaceInfos=function(){var r=this.getMovesByLevel(this.level),i=this.getMovesByLevel(this.level-1),u=(this.matches-i)/(r-i)*100,n=this.board.getPercentEmptySpaces(),t=!1;n<.15&&n>0&&(t=!0);this.gameHeader.updateStatus(this.score,this.level,u,n,t);this.board.setAlarm(t)},r.prototype.levelUpInterfaceEffect=function(n){this.gameLevelIndicator.showLevel(n);gameui.AudiosManager.playSound("levelUp");this.board.levelUpEffect()},r.prototype.start=function(){this.level=1;this.matches=0;this.time=Date.now();this.highJelly=0;this.board.cleanBoard();this.board.unlock();this.updateInterfaceInfos();gameui.AudiosManager.playMusic("music1");this.gamestate=1;this.step(500);n.JoinJelly.analytics.logGameStart()},r.prototype.step=function(n){var t=this;clearTimeout(this.timeoutInterval);this.timeoutInterval=setTimeout(function(){t.gamestate==1&&t.gameInteraction();t.gamestate!=3&&t.step(t.getTimeInterval(t.level,t.initialInterval,t.finalInterval,t.easeInterval))},n)},r.prototype.gameInteraction=function(){this.addRandomTileOnBoard();this.updateInterfaceInfos();this.verifyGameLoose()&&this.endGame();this.updateCurrentLevel()},r.prototype.pauseGame=function(){this.gamestate!=3&&(this.pauseMenu.show(),this.gamestate=2,this.board.lock(),this.gameHeader.mouseEnabled=!1,this.content.mouseEnabled=!1)},r.prototype.continueGame=function(){var n=this;this.pauseMenu.hide();setTimeout(function(){n.gamestate=1;n.board.unlock();n.gameHeader.mouseEnabled=!0;n.content.mouseEnabled=!0},3e3);this.countDown.countDown(3)},r.prototype.winGame=function(){this.endGame(StringResources.menus.gameOver,!0);this.gameFooter.visible=!1},r.prototype.endGame=function(t,i){var r=this;this.view.setChildIndex(this.footer,this.view.getNumChildren()-1);this.userData.deleteSaveGame();this.gamestate=4;var u=this.score,e=n.JoinJelly.userData.getHighScore(),f=this.board.getHighestTileValue();this.pauseMenu.hide();this.board.lock();this.board.setAlarm(!1);this.board.releaseAll();this.gameHeader.mouseEnabled=!1;this.gameFooter.mouseEnabled=!1;createjs.Tween.get(this.gameHeader).to({y:-425},200,createjs.Ease.quadIn);createjs.Tween.get(this.gameFooter).to({y:300},200,createjs.Ease.quadIn);setTimeout(function(){r.gamestate=i?5:3;r.finishMenu.show();r.gameFooter.mouseEnabled=!0;r.gameFooter.setItems([n.Items.REVIVE]);r.gameFooter.unlockItem(n.Items.REVIVE);r.gameFooter.highlight(n.Items.REVIVE);r.updateFooter();createjs.Tween.get(r.gameFooter).to({y:0},200,createjs.Ease.quadIn);u>n.JoinJelly.userData.getHighScore()&&(n.JoinJelly.userData.getPlayerName()==""?n.JoinJelly.userData.promptPlayerName(function(){n.AzureLeaderBoards.setScore(u,n.JoinJelly.userData.getPlayerName());n.JoinJelly.userData.setScore(u)}):(n.AzureLeaderBoards.setScore(u,n.JoinJelly.userData.getPlayerName()),n.JoinJelly.userData.setScore(u)))},1200);this.finishMenu.setValues(u,e,f,t);i?n.JoinJelly.analytics.logWinGame(this.level,f,this.matches,Date.now()-this.time):n.JoinJelly.analytics.logEndGame(this.level,f,this.matches,Date.now()-this.time);gameui.AudiosManager.playSound("end");this.board.endGameEffect()},r.prototype.updateCurrentLevel=function(){var n=this.getLevelByMoves(this.matches);n>this.level&&(this.level=n,this.levelUpInterfaceEffect(n),this.updateInterfaceInfos(),this.levelUpBonus());this.level=n},r.prototype.levelUpBonus=function(){this.useEvolve()},r.prototype.getLevelByMoves=function(n){for(var i=0,t=0,r,u;i<n;)r=this.getTimeInterval(t,this.initialInterval,this.finalInterval,this.easeInterval),u=this.timeByLevel/r,i+=u,t++;return Math.max(t,1)},r.prototype.getMovesByLevel=function(n){for(var r,u,i=0,t=0;t<n;t++)r=this.getTimeInterval(t,this.initialInterval,this.finalInterval,this.easeInterval),u=this.timeByLevel/r,i+=u;return i},r.prototype.getTimeInterval=function(n,t,i,r){return t*Math.pow(r,n)+i*(1-Math.pow(r,n))},r.prototype.verifyGameLoose=function(){var n=this.board.getEmptyTiles(),t=this.board.getLockedTiles();return n.length==0&&t.length==0?!0:!1},r.prototype.addRandomTileOnBoard=function(n){var i,t,r;if(n===void 0&&(n=1),i=this.board.getEmptyTiles(),n>0)for(t=10;t<this.level;t+=10)Math.random()>.9&&(n*=2);i.length>0&&(t=Math.floor(Math.random()*i.length),r=i[t],r.setNumber(n),this.saveGame())},r.prototype.dragged=function(n,t){this.match(n,t)},r.prototype.canMatch=function(n,t){return n.getNumber()!=0&&t!=n&&t.getNumber()==n.getNumber()&&t.isUnlocked()},r.prototype.canMove=function(){var i=this.board.getAllTiles(),f=this.board.getEmptyTiles().length,n={},r,t,u;for(r in i)t=i[r].getNumber(),t>0&&!n[t]&&(n[t]=0),n[t]++;for(u in n)if(n[u]>1)return!0;return!1},r.prototype.match=function(t,i){var r=i.getNumber()+t.getNumber(),u,f;return this.canMatch(t,i)?(this.matches++,this.board.match(t,i),u=r*10+Math.floor(Math.random()*r*10),this.score+=u,this.animateScoreFromTile(i,u),t.setNumber(0),f=this.giveItemChance([n.Items.CLEAN,n.Items.REVIVE,n.Items.TIME,n.Items.FAST]),f&&this.animateItemFromTile(i,f),this.userData.setLastJelly(r),this.updateInterfaceInfos(),this.highJelly<r&&n.JoinJelly.analytics.logNewJelly(r,this.level,Date.now()-this.time),this.highJelly=r,this.matchNotify&&this.matchNotify(),r>n.JoinJelly.maxJelly?this.winGame():i.setNumber(r),this.updateCurrentLevel(),this.saveGame(),this.canMove()||this.step(0),!0):!1},r.prototype.giveItemChance=function(t){var i=null,r=n.JoinJelly.itemData.getItemAmmount(n.Items.LUCKY)?2:1,u=Math.random()<this.itemProbability*r;return u&&(i=t[Math.floor(Math.random()*t.length)],n.JoinJelly.itemData.increaseItemAmmount(i)),i},r.prototype.animateItemFromTile=function(n,t){var u=this,i;gameui.AudiosManager.playSound("Interface Sound-11");i=gameui.AssetsManager.getBitmap("item"+t);i.mouseEnabled=!1;i.regX=i.getBounds().width/2;i.regY=i.getBounds().height/2;i.scaleY=i.scaleX=.5;var o=this.board.localToLocal(n.x,n.y,this.content).x,s=this.board.localToLocal(n.x,n.y,this.content).y,f=defaultWidth/2,e=this.footer.y,r=this.gameFooter.getItemButton(t);r&&(f=this.gameFooter.localToLocal(r.x,r.y,this.content).x,e=this.gameFooter.localToLocal(r.x,r.y,this.content).y);i.alpha=0;createjs.Tween.get(i).to({x:o,y:s,alpha:0}).to({y:n.y-70,alpha:1},400,createjs.Ease.quadInOut).to({x:f,y:e},1e3,createjs.Ease.quadInOut).call(function(){u.content.removeChild(i);u.updateFooter()});this.content.addChild(i)},r.prototype.animateScoreFromTile=function(n,t){var f=this,i=gameui.AssetsManager.getBitmapText(t.toString(),"debussy"),u,r;i.regX=i.getBounds().width/2;i.mouseEnabled=!1;u=this.board.localToLocal(n.x,n.y,this.content).x;r=this.board.localToLocal(n.x,n.y,this.content).y;i.alpha=0;createjs.Tween.get(i).to({x:u,y:r,alpha:0}).to({y:r-170,alpha:1},400,createjs.Ease.quadOut).to({alpha:0},400).call(function(){f.content.removeChild(i);delete i});this.content.addChild(i)},r.prototype.useItem=function(t){if(n.JoinJelly.itemData.getItemAmmount(t)>0){var i=!1;switch(t){case n.Items.TIME:i=this.useTime();break;case n.Items.FAST:i=this.useFast();break;case n.Items.CLEAN:i=this.useClean();break;case n.Items.REVIVE:i=this.useRevive();break;case n.Items.EVOLVE:i=this.useEvolve()}i&&(n.JoinJelly.itemData.decreaseItemAmmount(t),this.itemNotify&&this.itemNotify())}else this.pauseGame(),n.JoinJelly.showStore(this);this.updateFooter()},r.prototype.useTime=function(){var n=this;if(this.gamestate!=3)return this.step(4e3),this.freezeEffect.alpha=0,this.freezeEffect.visible=!0,createjs.Tween.removeTweens(this.freezeEffect),createjs.Tween.get(this.freezeEffect).to({alpha:1},1e3).to({alpha:0},4e3).call(function(){n.freezeEffect.visible=!1}),gameui.AudiosManager.playSound("sounditemtime"),!0},r.prototype.useClean=function(){var i=this,n,t;if(this.gamestate!=3){n=this.board.getAllTiles();for(t in n)n[t].getNumber()<2&&(this.board.fadeTileToPos(n[t],n[t].x,n[t].y-100,200,300*Math.random()),n[t].setNumber(0));return this.updateInterfaceInfos(),this.cleanEffect.alpha=0,this.cleanEffect.visible=!0,createjs.Tween.removeTweens(this.cleanEffect),createjs.Tween.get(this.cleanEffect).to({alpha:0},200).to({alpha:1},200).to({alpha:0},200),createjs.Tween.get(this.cleanEffect).to({x:-600,y:2e3}).to({x:300,y:-500},600).call(function(){i.cleanEffect.visible=!1}),gameui.AudiosManager.playSound("sounditemclean"),!0}},r.prototype.useRevive=function(t){var i=this;return(t===void 0&&(t=!1),this.gamestate!=3)?!1:(UserData.getHistoryRevive(),this.saveGame(),this.gamestate=1,this.board.unlock(),this.finishMenu.hide(),this.step(4e3),this.updateInterfaceInfos(),this.board.setAlarm(!0),this.showBoardButton.fadeOut(),this.gameFooter.setItems([n.Items.TIME,n.Items.CLEAN,n.Items.FAST]),this.gameFooter.unlockAll(),this.gameFooter.lockItem(n.Items.REVIVE),this.gameHeader.mouseEnabled=!0,createjs.Tween.get(this.gameHeader).to({y:-0},200,createjs.Ease.quadIn),t||(this.reviveEffect.alpha=0,this.reviveEffect.visible=!0,createjs.Tween.removeTweens(this.reviveEffect),createjs.Tween.get(this.reviveEffect).to({y:1200}).to({y:600,alpha:1},600).to({y:0,alpha:0},600).call(function(){i.reviveEffect.visible=!1}),gameui.AudiosManager.playSound("sounditemrevive")),!0)},r.prototype.useEvolve=function(){var c=this,n,f,i,t,o,r,e,u,s,h;if(this.gamestate!=3){n=this.board.getAllTiles();f=0;for(t in n)n[t].getNumber()>f&&(f=n[t].getNumber());i=[];for(t in n)n[t].getNumber()<f&&n[t].getNumber()>2&&n[t].isUnlocked()&&i.push(n[t]);if(i.length==0)for(t in n)n[t].getNumber()<f&&n[t].getNumber()>1&&n[t].isUnlocked()&&i.push(n[t]);if(i.length==0)for(t in n)n[t].getNumber()>1&&n[t].isUnlocked()&&i.push(n[t]);if(i.length==0)for(t in n)n[t].getNumber()>0&&n[t].isUnlocked()&&i.push(n[t]);return i.length==0?!1:(o=Math.floor(Math.random()*i.length),r=i[o],r.lock(),r.setNumber(r.getNumber()*2),r.jelly.playThunder(),setTimeout(function(){r.unlock();gameui.AudiosManager.playSound("evolve")},1e3),gameui.AudiosManager.playSound("sounditemfast"),e=r.jelly.localToLocal(0,0,this.evolveEffect.parent),u=this.gameHeader.localToLocal(1394,211,this.evolveEffect.parent),this.evolveEffect.visible=!0,this.evolveEffect.set({alpha:1,scaleX:.5,x:u.x,y:u.y}),s=Math.atan2(e.y-u.y-50,e.x-u.x)*180/Math.PI-90,h=Math.sqrt(Math.pow(e.y-50-u.y,2)+Math.pow(e.x-u.x,2))/300,this.evolveEffect.rotation=s,this.evolveEffect.scaleY=0,createjs.Tween.removeTweens(this.evolveEffect),createjs.Tween.get(this.evolveEffect).to({scaleY:h},200),createjs.Tween.get(this.evolveEffect).to({alpha:0},1200,createjs.Ease.quadIn).call(function(){c.evolveEffect.visible=!1}),!0)}},r.prototype.useFast=function(n){var r,t,e,i,o,u,f;if(n===void 0&&(n=!1),this.gamestate!=3){r=this.board.getAllTiles();t=[];for(e in r){if(t.length>=5)break;if(i=r[e],i.getNumber()>0&&i.isUnlocked())for(o in r)if(u=r[o],this.canMatch(i,u)){i.lock();u.lock();t.push([i,u]);break}}for(f in t)this.matchJelly(t[f][0],t[f][1]);return!0}},r.prototype.matchJelly=function(n,t){var i=this;t.lock();n.lock();this.board.fadeTileToPos(n,t.x,t.y,400,200*Math.random(),1);setTimeout(function(){t.unlock();n.unlock();i.match(n,t)},300)},r.prototype.updateFooter=function(){var t=n.ItemsData.items;for(var i in t)this.gameFooter.setItemAmmount(t[i],n.JoinJelly.itemData.getItemAmmount(t[i]))},r.prototype.saveGame=function(){var n={level:this.level,matches:this.matches,score:this.score,tiles:this.board.getAllTilesValues()};this.userData.saveGame(n)},r.prototype.loadGame=function(){var n=this.userData.loadGame();n&&n!=null&&(this.board.setTiles(n.tiles),this.score=n.score,this.matches=n.matches,this.level=n.level,this.updateCurrentLevel(),this.updateFooter(),this.updateInterfaceInfos(),this.pauseGame())},r.prototype.selfPeformanceTest=function(t){var i=this,r;t&&(this.initialInterval=200);r=setInterval(function(){i.gamestate!=2&&(i.useRevive(),i.useFast(!0),i.gamestate==5&&(clearInterval(r),n.JoinJelly.startTest()))},250)},r}(gameui.ScreenState),i;t.GamePlayScreen=r,function(n){n[n.starting=0]="starting";n[n.playing=1]="playing";n[n.paused=2]="paused";n[n.ended=3]="ended";n[n.standBy=4]="standBy";n[n.win=5]="win"}(i||(i={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments);this.initialDirtyProbability=.1;this.finalDirtyProbability=.6;this.easeDirtyProbability=.98}return __extends(t,n),t.prototype.addRandomTileOnBoard=function(){var t=this;n.prototype.addRandomTileOnBoard.call(this);this.getDirtyProbabilityByLevel(this.level,this.initialDirtyProbability,this.finalDirtyProbability,this.easeDirtyProbability)>Math.random()&&setTimeout(function(){n.prototype.addRandomTileOnBoard.call(t,-1)},500)},t.prototype.match=function(t,i){var f=n.prototype.match.call(this,t,i),u,e,r,o,s;if(f){u=this.board.getNeighborTiles(i);for(e in u)r=u[e],r&&r.getNumber()<0&&(o=i.x+(r.x-i.x)*1.5,s=i.y+(r.y-i.y)*1.5,this.board.fadeTileToPos(r,o,s,500),r.setNumber(0))}return f},t.prototype.levelUpBonus=function(){n.prototype.levelUpBonus.call(this);this.cleanDirty()},t.prototype.cleanDirty=function(){var n=this.board.getAllTiles();for(var t in n)n[t].getNumber()<0&&n[t].setNumber(0)},t.prototype.getDirtyProbabilityByLevel=function(n,t,i,r){return t*Math.pow(r,n)+i*(1-Math.pow(r,n))},t}(n.GamePlayScreen);n.ExplodeBricks=t})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(i){function r(){i.apply(this,arguments);this.currentTutorialStep=0}return __extends(r,i),r.prototype.createGUI=function(){var r=this;i.prototype.createGUI.call(this);this.tutorialJellyFinger=new t.view.TutorialMove;this.tutorialItemFinger=new t.view.TutorialMove;this.gameMessage.addEventListener("closed",function(){r.messageNotify&&r.messageNotify()});this.tutorialItemFinger.rotation=-45;this.content.addChild(this.tutorialJellyFinger);this.footer.addChild(this.tutorialItemFinger);this.gameFooter.setItemAmmount(n.Items.REVIVE,1);this.gameFooter.setItemAmmount(n.Items.FAST,1);this.gameFooter.setItemAmmount(n.Items.CLEAN,1);this.gameFooter.setItemAmmount(n.Items.TIME,1);this.gameFooter.lockAll()},r.prototype.start=function(){i.prototype.start.call(this);this.resetTutorialStep();this.executeTutorialStep()},r.prototype.step=function(){},r.prototype.resetTutorialStep=function(){this.currentTutorialStep=-1},r.prototype.executeTutorialStep=function(){var t=this,i;this.currentTutorialStep++;i=[function(){t.tutorialWait(1500);t.board.getTileById(16).setNumber(1);t.board.getTileById(16).disable()},function(){t.board.getTileById(16).disable();t.board.getTileById(18).setNumber(1);t.showTutorialMessage(StringResources.tutorial.msgheplme);t.board.getTileById(18).disable();t.waitMessage()},function(){t.board.getTileById(16).disable();t.board.getTileById(18).enable();t.showTutorialMove(18,16);t.waitMatch()},function(){t.board.getTileById(16).disable();t.hideTutorialFinger();t.tutorialWait(700)},function(){t.board.getTileById(16).disable();t.showTutorialMessage(StringResources.tutorial.msgOnceMore);t.waitMessage()},function(){t.board.getTileById(16).disable();t.board.getTileById(24).setNumber(2);t.board.getTileById(16).disable();t.showTutorialMove(24,16);t.waitMatch()},function(){t.hideTutorialFinger();t.tutorialWait(700);t.board.getTileById(16).disable()},function(){t.board.getTileById(16).disable();t.tutorialWait(500)},function(){t.board.getTileById(17).setNumber(-1);t.board.getTileById(19).setNumber(-1);t.board.getTileById(23).setNumber(-1);t.board.getTileById(22).setNumber(-1);t.board.getTileById(24).setNumber(-1);t.board.getTileById(13).setNumber(-1);t.board.getTileById(18).setNumber(1);t.board.getTileById(20).setNumber(1);t.board.getTileById(18).disable();t.board.getTileById(16).disable();t.showTutorialMessage(StringResources.tutorial.msgDirt);t.waitMessage()},function(){t.showTutorialMove(20,18);t.waitMatch()},function(){t.tutorialWait(1e3)},function(){t.hideTutorialFinger();t.board.getTileById(0).setNumber(2);t.board.getTileById(1).setNumber(1);t.board.getTileById(2).setNumber(2);t.board.getTileById(3).setNumber(1);t.board.getTileById(4).setNumber(2);t.board.getTileById(5).setNumber(1);t.board.getTileById(6).setNumber(1);t.board.getTileById(7).setNumber(1);t.board.getTileById(8).setNumber(1);t.board.getTileById(9).setNumber(1);t.board.getTileById(10).setNumber(1);t.board.getTileById(11).setNumber(1);t.board.getTileById(12).setNumber(1);t.board.getTileById(13).setNumber(1);t.board.getTileById(14).setNumber(1);t.board.getTileById(0).disable();t.board.getTileById(1).disable();t.board.getTileById(2).disable();t.board.getTileById(3).disable();t.board.getTileById(4).disable();t.board.getTileById(5).disable();t.board.getTileById(6).disable();t.board.getTileById(7).disable();t.board.getTileById(8).disable();t.board.getTileById(9).disable();t.board.getTileById(10).disable();t.board.getTileById(11).disable();t.board.getTileById(12).disable();t.board.getTileById(13).disable();t.board.getTileById(14).disable();t.board.getTileById(18).disable();t.tutorialWait(1e3)},function(){t.showTutorialItem(n.Items.CLEAN);t.gameFooter.highlight(n.Items.CLEAN);t.gameFooter.showMessage(n.Items.CLEAN,StringResources.tutorial.msgItemClean);t.waitItem()},function(){t.gameFooter.hideMessage();t.hideTutorialFinger();t.gameFooter.setItemAmmount(n.Items.CLEAN,0);t.tutorialWait(1e3)},function(){t.showTutorialItem(n.Items.TIME);t.gameFooter.highlight(n.Items.TIME);t.gameFooter.showMessage(n.Items.TIME,StringResources.tutorial.msgItemTime);t.waitItem()},function(){t.gameFooter.hideMessage();t.hideTutorialFinger();t.gameFooter.setItemAmmount(n.Items.TIME,0);t.tutorialWait(1e3)},function(){t.showTutorialItem(n.Items.FAST);t.gameFooter.highlight(n.Items.FAST);t.gameFooter.showMessage(n.Items.FAST,StringResources.tutorial.msgItemFast);t.waitItem()},function(){t.gameFooter.lockAll();t.gameFooter.hideMessage();t.hideTutorialFinger();t.gameFooter.setItemAmmount(n.Items.FAST,0);t.tutorialWait(1e3)},function(){t.hideTutorialFinger();t.showTutorialMessage(StringResources.tutorial.msgPlay);t.waitMessage()},function(){t.showTutorialMessage(StringResources.tutorial.msgBoardFill);t.waitMessage()},function(){n.JoinJelly.userData.history(histories.TUTORIAL);n.JoinJelly.startLevel()}];i[this.currentTutorialStep]&&i[this.currentTutorialStep]()},r.prototype.tutorialWait=function(n){var t=this;setTimeout(function(){t.executeTutorialStep()},n)},r.prototype.waitMatch=function(){var n=this;this.matchNotify=function(){n.matchNotify=null;n.executeTutorialStep()}},r.prototype.waitItem=function(){var n=this;this.itemNotify=function(){n.itemNotify=null;n.executeTutorialStep()}},r.prototype.waitMessage=function(){var n=this;this.messageNotify=function(){n.messageNotify=null;n.executeTutorialStep()}},r.prototype.showTutorialMessage=function(n){this.gameMessage.show(n)},r.prototype.showTutorialMove=function(n,t){var i=this.board.getTileById(n),r=this.board.getTileById(t);this.tutorialJellyFinger.showMove(i.x,i.y+this.board.y-this.board.regY,r.x,r.y+this.board.y-this.board.regY)},r.prototype.showTutorialItem=function(n){var t=this.gameFooter.getItemButton(n).localToLocal(0,0,this.footer);this.tutorialItemFinger.showClick(t.x,t.y-100);this.gameFooter.lockAll();this.gameFooter.unlockItem(n);this.gameFooter.setItemAmmount(n,1)},r.prototype.hideTutorialFinger=function(){this.tutorialJellyFinger.hide();this.tutorialItemFinger.hide()},r.prototype.giveItemChance=function(){return null},r.prototype.useItem=function(t){var i=!1;switch(t){case"time":i=this.useTime();break;case"fast":i=this.useFast();break;case"clean":i=this.useClean();break;case"revive":i=this.useRevive()}i&&(n.JoinJelly.itemData.decreaseItemAmmount(t),this.itemNotify&&this.itemNotify())},r.prototype.updateFooter=function(){},r.prototype.saveGame=function(){},r}(t.ExplodeBricks);t.Tutorial=i})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){var i=this,t;n.call(this);this.addChild(new createjs.Shape((new createjs.Graphics).beginFill("darkGray").beginStroke("black").drawRect(-200,-60,400,120)));t=new createjs.Text("","60px Arial","white");t.textAlign="center";t.textBaseline="middle";this.addChild(t);this.text=t;this.addEventListener("click",function(){i.fadeOut()})}return __extends(t,n),t.prototype.showMessage=function(n){this.text.text=n;this.fadeIn()},t}(gameui.Button);n.Message=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={}));UserData=function(){function n(){gameui.AudiosManager.setSoundVeolume(this.getSoundVol());gameui.AudiosManager.setMusicVolume(this.getMusicVol())}return n.prototype.setScore=function(t){var i=this.getHighScore();t>i&&n.saveValue("HighScore",t)},n.prototype.getHighScore=function(){var t=n.loadValue("HighScore");return t?t:0},n.prototype.setLastJelly=function(t){var i=this.getLastJelly();t>i&&n.saveValue("LastJelly",t)},n.prototype.getLastJelly=function(){var t=n.loadValue("LastJelly");return t?t:0},n.prototype.setPlayerName=function(t){n.saveValue("username",t)},n.prototype.getPlayerName=function(){var t=n.loadValue("username");return t||(t=""),t},n.prototype.promptPlayerName=function(n){var t=this;Cocoon.Dialog.prompt({title:StringResources.menus.playerName,message:StringResources.menus.playerNameDesc,text:this.getPlayerName(),type:"text"},{success:function(i){t.setPlayerName(i);n()},cancel:function(){n()}})},n.prototype.getMusicVol=function(){return n.loadValue("music",1)},n.prototype.setMusicVol=function(t){n.saveValue("music",t)},n.prototype.getSoundVol=function(){return n.loadValue("sound",1)},n.prototype.setSoundVol=function(t){n.saveValue("sound",t)},n.prototype.saveItems=function(t){return n.saveValue("items",t)},n.prototype.loadItems=function(){return n.loadValue("items",{})},n.prototype.saveGame=function(t){n.saveValue("savegame",t)},n.prototype.loadGame=function(){return n.loadValue("savegame",undefined)},n.prototype.deleteSaveGame=function(){n.saveValue("savegame",null)},n.saveValue=function(t,i){if(i==null)localStorage.removeItem(n.prefix+t);else{var r=JSON.stringify(i);localStorage.setItem(n.prefix+t,r)}},n.loadValue=function(t,i){var r=localStorage.getItem(n.prefix+t);return r?JSON.parse(r):i},n.prototype.history=function(t){var i=n.loadValue("history",{});i[t]=!0;n.saveValue("history",i)},n.prototype.getHistory=function(t){var i=n.loadValue("history",{});return i[t]},n.getHistoryRevive=function(){return this.loadValue("revive")},n.prototype.resetAll=function(){localStorage.clear()},n.prefix="FastPair_",n}();histories=function(){function n(){}return n.TUTORIAL="tutorial",n.REVIVE="revive",n.EVOLVE="evolve",n.FIRSTPLAY="firstplay",n}(),function(n){var t=function(){function t(){}return t.init=function(){var u=this,f,i,r;this.userData=new UserData;this.analytics=new Analytics;this.itemData=new n.ItemsData;n.AzureLeaderBoards.init();f=(window.navigator.userLanguage||window.navigator.language).substr(0,2).toLowerCase();switch(f){case"pt":StringResources=StringResources_pt}i=60;window.location.search=="?test"&&(i=10,testMode=!0);this.gameScreen=new gameui.GameScreen("gameCanvas",defaultWidth,defaultHeight,i);r=new n.menus.Loading;this.gameScreen.switchScreen(r);r.loaded=function(){if(window.location.search=="?test")u.startTest();else{var i=u.userData.loadGame();i?n.JoinJelly.startLevel(i):t.showMainMenu()}}},t.startTest=function(){var t=new n.gameplay.ExplodeBricks(this.userData);this.gameScreen.switchScreen(t);t.selfPeformanceTest(!1)},t.showAboutScreen=function(){alert("beta")},t.showMainMenu=function(){var t;this.gameScreen.currentScreen instanceof n.gameplay.GamePlayScreen&&(t={type:"top",time:500});this.gameScreen.currentScreen instanceof n.Jellypedia&&(t={type:"right",time:500});this.gameScreen.switchScreen(new n.MainScreen(this.userData),null,t)},t.startLevel=function(t){var i;this.gameScreen.currentScreen instanceof n.MainScreen&&(i={type:"bottom",time:500});this.gameScreen.switchScreen(new n.gameplay.ExplodeBricks(this.userData,t),null,i)},t.startTutorial=function(){var t;this.gameScreen.currentScreen instanceof n.MainScreen&&(t={type:"bottom",time:500});this.gameScreen.switchScreen(new n.gameplay.Tutorial(this.userData),null,t)},t.showStore=function(t){var i;this.gameScreen.currentScreen instanceof n.MainScreen&&(i={type:"right",time:500});this.gameScreen.switchScreen(new n.menus.StoreMenu(t),null,i)},t.showLeaderboards=function(){var t;this.gameScreen.currentScreen instanceof n.MainScreen&&(t={type:"right",time:500});this.gameScreen.switchScreen(new n.menus.LeaderBoards,null,t)},t.showPedia=function(){var t;this.gameScreen.currentScreen instanceof n.MainScreen&&(t={type:"left",time:500});this.gameScreen.switchScreen(new n.Jellypedia(this.userData,StringResources.jellys),null,t)},t.showSettings=function(){var t;this.gameScreen.currentScreen instanceof n.MainScreen&&(t={type:"left",time:500});this.gameScreen.switchScreen(new n.menus.MainMenu,null,t)},t.showAbout=function(){this.gameScreen.switchScreen(new n.About)},t.maxJelly=65536,t}();n.JoinJelly=t}(joinjelly||(joinjelly={}));window.onload=function(){joinjelly.JoinJelly.init()};var defaultWidth=1536,defaultHeight=2048,fbAppId="1416523228649363",gameWebsite="www.joinjelly.com",gameWebsiteIcon="www.joinjelly.com/icon.png",joinjelly;(function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.countDown=function(n){var f=this,t;n===void 0&&(n=3);var i=[],u=1e3,r=200;for(t=n;t>0;t--)i[t]=gameui.AssetsManager.getBitmap("n"+t),this.addChild(i[t]),i[t].regX=i[t].getBounds().width/2,i[t].regY=i[t].getBounds().height/2,i[t].mouseEnabled=!1,createjs.Tween.get(i[t]).to({scaleX:2,scaleY:2,alpha:0}).wait((n-t)*u).to({scaleX:1,scaleY:1,alpha:1},r,createjs.Ease.quadOut).wait(u-r).to({alpha:0,scaleX:.5,scaleY:.5},r,createjs.Ease.quadIn).call(function(n){f.removeChild(n)})},t}(createjs.Container);n.CountDown=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))})(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){t.call(this);this.itemSize=270;this.itemsButtons=[];this.addObjects();this.setItems(n)}return __extends(i,t),i.prototype.setItems=function(n){var i=this.itemSize,t;if(n.length>=5&&(i=200),this.cleanButtons(),n){for(t in n)this.addItem(n[t],t);for(t in n)this.itemsButtons[n[t]].y=-150,this.itemsButtons[n[t]].x=(defaultWidth-(n.length-1)*i)/2+t*i}},i.prototype.cleanButtons=function(){for(var n in this.itemsButtons)this.removeChild(this.itemsButtons[n]);this.itemsButtons=[]},i.prototype.addObjects=function(){var i=gameui.AssetsManager.getBitmap("footer"),t;this.addChild(i);i.y=-162;i.x=(defaultWidth-1161)/2;t=gameui.AssetsManager.getBitmap("lucky");this.addChild(t);t.y=-210;t.x=t.scaleX=t.scaleY=.5;this.lucky=t;this.gameMessage=new n.TutoralMessage;this.addChild(this.gameMessage)},i.prototype.addItem=function(t){var r=this,i=new n.ItemButton(t);this.addChild(i);this.itemsButtons[t]=i;i.addEventListener("click",function(){r.dispatchEvent({type:"useitem",item:t})})},i.prototype.getItemButton=function(n){return this.itemsButtons[n]},i.prototype.setItemAmmount=function(n,t){this.itemsButtons[n]&&this.itemsButtons[n].setAmmount(t);n=="lucky"&&(this.lucky.visible=t>0)},i.prototype.showMessage=function(n,t){this.gameMessage.x=this.getItemButton(n).x;this.gameMessage.y=this.getItemButton(n).y-120;this.gameMessage.show(t)},i.prototype.hideMessage=function(){this.gameMessage.fadeOut()},i.prototype.highlight=function(n){this.unHighlightAll();this.getItemButton(n).highLight()},i.prototype.unHighlightAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].unHighlight()},i.prototype.lockItem=function(n){var t=this.getItemButton(n);t&&t.lock()},i.prototype.unlockItem=function(n){var t=this.getItemButton(n);t.unlock()},i.prototype.lockAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].lock()},i.prototype.unlockAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].unlock()},i}(createjs.Container);n.ItemsFooter=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t=function(){function n(){}return n.init=function(){(this.deviceId=localStorage.getItem("deviceId"),typeof WindowsAzure!="undefined")&&(this.client=new WindowsAzure.MobileServiceClient(this.host,this.key),this.table=this.client.getTable("LeaderBoards"))},n.getScoreNames=function(n){this.table&&this.table.orderByDescending("score").take(50).where({gameid:this.gameId}).read().then(function(t){n(t)},function(){n(null)})},n.setScore=function(n,t,i){var r=this;(i===void 0&&(i=!1),this.table)&&(this.deviceId&&!i?this.table.update({name:t,score:n,id:this.deviceId,gameid:this.gameId}):this.table.insert({name:t,score:n,gameid:this.gameId}).then(function(n){n.id&&(r.deviceId=n.id,localStorage.setItem("deviceId",r.deviceId))}))},n.host="https://dialeaderboards.azure-mobile.net",n.key="GyalJGfVBZeaGMTMGxKuytNMXjjoqC94",n.gameId="joinjelly",n}();n.AzureLeaderBoards=t}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(i){function r(){var u=this,r,t;i.call(this,StringResources.menus.leaderboards);this.maxScroll=1700;r=new n.view.LoadingBall;this.scrollableContent.addChild(r);r.x=defaultWidth/2;r.y=800;t=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy");this.scrollableContent.addChild(t);t.regX=t.getBounds().width/2;t.x=defaultWidth/2;t.y=900;t.visible=!0;this.loadLeaderBoards(function(n){r.visible=!1;n!=null?(u.fillLeaderBoards(n),t.visible=!1):(t.text=StringResources.menus.error,t.visible=!0,t.regX=t.getBounds().width/2)})}return __extends(r,i),r.prototype.fillLeaderBoards=function(n){var u=200,f=400,i,r;for(i in n)r=new t.view.LeaderBoardItem(n[i].score,n[i].name,parseInt(i)+1),r.x=defaultWidth/2,r.y=f+u*i,this.scrollableContent.addChild(r);this.maxScroll=f+n.length*u},r.prototype.loadLeaderBoards=function(t){n.AzureLeaderBoards.getScoreNames(t,20)},r}(n.ScrollablePage);t.LeaderBoards=i})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r){var e;r===void 0&&(r=1);n.call(this);this.regX=528;e=gameui.AssetsManager.getBitmap("FlyGroup");e.scaleY=.65;this.addChild(e);var f=new createjs.Container,o=gameui.AssetsManager.getBitmapText(i,"debussy"),s=gameui.AssetsManager.getBitmapText(r.toString(),"debussy"),u=gameui.AssetsManager.getBitmapText(t.toString(),"debussy");u.regX=u.getBounds().width;s.y=30;o.y=30;u.y=30;s.x=30;o.x=150;u.x=1e3;f.addChild(o);f.addChild(u);f.addChild(s);this.addChild(f)}return __extends(t,n),t}(createjs.Container);n.LeaderBoardItem=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this);var u=gameui.AssetsManager.getBitmap(t+"bonus_border.png"),r=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy"),i=gameui.AssetsManager.getBitmap(t+"bonus_bar.png");this.addChild(u);this.addChild(r);this.addChild(i);r.regX=r.getBounds().width/2;i.x=-939/2-40;u.regX=1131/2;r.y=-100;i.y=85;this.barMask=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,i.y,939,57));this.barMask.x=i.x;i.mask=this.barMask}return __extends(t,n),t.prototype.update=function(n){this.barMask.scaleX=n},t}(createjs.Container);n.LoadingBar=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.addObjects()}return __extends(i,t),i.prototype.addObjects=function(){var f=this,r=gameui.AssetsManager.getBitmap("FlyGroup"),t,i,u;r.y=-130;r.regX=r.getBounds().width/2;this.addChild(r);t=gameui.AssetsManager.getBitmapText(StringResources.menus.playerName,"debussy");t.y=-190;t.scaleX=t.scaleY=1.1;t.regX=t.getBounds().width/2;this.addChild(t);i=gameui.AssetsManager.getBitmapText(n.JoinJelly.userData.getPlayerName(),"debussy");this.addChild(i);this.playerName=i;i.x=-450;i.y=-60;u=new gameui.ImageButton("BtSettings",function(){n.JoinJelly.userData.promptPlayerName(function(){f.playerName.text=n.JoinJelly.userData.getPlayerName()})});this.addChild(u);u.x=400},i}(createjs.Container);t.PlayerNameOptions=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(i,r,u,f){var b=this,h,a,e,o,v,y,c,s,p,l,w;t.call(this);h=new createjs.Container;a=gameui.AssetsManager.getBitmap("FlyGroup");a.x=232;a.y=27;a.scaleY=1.25;a.scaleX=.75;h.addChild(a);e="";switch(i){case"time5x":e="itemtime";break;case"fast5x":e="itemfast";break;case"revive5x":e="itemrevive";break;case"evolve5x":e="itemevolve";break;case"clean5x":e="itemclean";break;case"pack5x":case"pack1x":case"pack10x":e="itemPack";break;case"lucky":e="lucky";break;default:e="itemPack"}o=gameui.AssetsManager.getBitmap(e);o.regX=o.getBounds().width/2;o.regY=o.getBounds().height/2;o.scaleX=o.scaleY=.8;o.x=225;o.y=188;h.addChild(o);u&&(u=u.replace("  ","\n"));v=gameui.AssetsManager.getBitmapText(r,"debussyBig");y=gameui.AssetsManager.getBitmapText(u,"debussy");v.y=40;y.y=140;v.scaleX=v.scaleY=.8;y.scaleX=y.scaleY=.8;v.x=y.x=400;h.addChild(v);h.addChild(y);c=gameui.AssetsManager.getBitmap("unchecked");c.regX=c.getBounds().width/2;c.regY=c.getBounds().height/2;c.y=152;c.x=1199;this.addChild(c);s=gameui.AssetsManager.getBitmap("check");s.regX=s.getBounds().width/2;s.regY=s.getBounds().height/2;s.y=152;s.x=1199;this.purchasedIcon=s;this.addChild(s);p=new n.view.LoadingBall;p.y=152;p.x=1199;this.loadingIcon=p;this.addChild(p);l=gameui.AssetsManager.getBitmapText(f,"debussy");l.y=251;l.x=1199;l.regX=l.getBounds().width/2;l.scaleX=l.scaleY=.8;f!="share"&&h.addChild(l);w=f=="share"?new gameui.ImageButton("BtShare",function(){b.setPurchasing();b.dispatchEvent({type:"share",productId:i})}):new gameui.ImageButton("BtStore",function(){b.setPurchasing();b.dispatchEvent({type:"buy",productId:i})});w.y=152;w.x=1199;this.purchaseButton=w;this.addChild(w);this.addChild(h);h.cache(100,27,1250,300)}return __extends(i,t),i.prototype.setPurchasing=function(){this.disable();this.loadingIcon.visible=!0},i.prototype.loading=function(){this.disable();this.loadingIcon.visible=!0},i.prototype.setNotAvaliable=function(){this.purchaseButton.fadeOut();this.purchasedIcon.visible=!1;this.loadingIcon.visible=!1},i.prototype.setAvaliable=function(){},i.prototype.setPurchased=function(n){var t=this;n===void 0&&(n=!1);this.purchaseButton.fadeOut();this.purchasedIcon.visible=!0;this.loadingIcon.visible=!1;gameui.AudiosManager.playSound("Interface Sound-11");n&&setTimeout(function(){t.setNormal()},1e3)},i.prototype.setNormal=function(){this.purchaseButton.fadeIn();this.purchasedIcon.visible=!1;this.loadingIcon.visible=!1},i.prototype.enable=function(){this.purchaseButton.fadeIn();this.loadingIcon.visible=!1},i.prototype.disable=function(){this.purchasedIcon.visible=!1;this.purchaseButton.fadeOut()},i}(createjs.Container);t.ProductListItem=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.castSimple=function(){var t=this,n=gameui.AssetsManager.getBitmap("fxJoin");n.regX=100;n.regY=100;this.addChild(n);createjs.Tween.get(n).to({scaleX:2,scaleY:2,alpha:0},500,createjs.Ease.linear).call(function(){t.removeChild(n)})},t.prototype.castSimpleInv=function(){var t=this,n=gameui.AssetsManager.getBitmap("fxJoin");n.regX=100;n.regY=100;this.addChild(n);n.alpha=2;n.scaleX=2;n.scaleY=2;createjs.Tween.get(n).to({scaleX:.5,scaleY:.5,alpha:2},800,createjs.Ease.linear).call(function(){t.removeChild(n)})},t.prototype.castPart=function(){var t=this,n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=.2;n.alpha=2;this.addChild(n);createjs.Tween.get(n).to({scaleX:1.6,scaleY:1.6,alpha:0},500,createjs.Ease.quadOut).call(function(){t.removeChild(n)});this.castParts()},t.prototype.castParts=function(){var t=this,n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=.4;n.rotation=360/16;n.alpha=2;this.addChild(n);createjs.Tween.get(n).to({scaleX:2.2,scaleY:2.2,alpha:0},500,createjs.Ease.quadOut).call(function(){t.removeChild(n)})},t.prototype.castPartsInv=function(){var t=this,n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=4;n.rotation=360/16;n.alpha=0;this.addChild(n);createjs.Tween.get(n).to({scaleX:.5,scaleY:.5,alpha:2,rotation:0},1e3,createjs.Ease.quadIn).call(function(){t.removeChild(n)})},t.prototype.castBoth=function(){this.castPartsInv();this.castSimpleInv()},t}(createjs.Container);n.Effect=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={}));
/*
//# sourceMappingURL=script.min.js.map
*/