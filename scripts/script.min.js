var images,gameui,__extends,UserData,histories,testMode,joinjelly;(function(n){var t=function(n){function t(){n.apply(this,arguments);this.centered=!1;this.animating=!1}return __extends(t,n),t.prototype.centralize=function(){this.regX=this.width/2;this.regY=this.height/2;this.centered=!0},t.prototype.fadeOut=function(n,t){n===void 0&&(n=.5);t===void 0&&(t=.5);this.resetFade();createjs.Tween.get(this).to({scaleX:n,scaleY:t,alpha:0,x:this.antX,y:this.antY},200,createjs.Ease.quadIn).call(function(){this.visible=!1;this.x=this.antX;this.y=this.antY;this.scaleX=this.scaleY=1;this.alpha=1;this.animating=!1;this.mouseEnabled=!0})},t.prototype.resetFade=function(){this.animating=!0;this.antX=this.x;this.antY=this.y;this.mouseEnabled=!1;createjs.Tween.removeTweens(this)},t.prototype.fadeIn=function(n,t){n===void 0&&(n=.5);t===void 0&&(t=.5);(this.visible=!0)&&(this.antX=null);this.visible=!0;this.animating=!0;this.antX==null&&(this.antX=this.x,this.antY=this.y);this.scaleX=n;this.scaleY=t;this.alpha=0;this.x=this.x;this.y=this.y;this.mouseEnabled=!1;createjs.Tween.removeTweens(this);createjs.Tween.get(this).to({scaleX:1,scaleY:1,alpha:1,x:this.antX,y:this.antY},400,createjs.Ease.quadOut).call(function(){this.mouseEnabled=!0;this.animating=!1})},t.prototype.createHitArea=function(){var t=new createjs.Shape,n=this.getBounds();n&&t.graphics.beginFill("#000").drawRect(n.x,n.y,n.width,n.height);this.hitArea=t},t}(createjs.Container);n.UIItem=t})(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.setMusicVolume=function(n){this.currentMusic&&(this.currentMusic.volume=n);this.musicVolue=n},n.setSoundVeolume=function(n){this.soundVolume=n},n.getMusicVolume=function(){return this.musicVolue==undefined?1:this.musicVolue},n.getSoundVolume=function(){return this.soundVolume==undefined?1:this.soundVolume},n.playMusic=function(n,t){if(t===void 0&&(t=1),this.currentMusic){if(this.currentMusic.setVolume(t*this.getMusicVolume()),this.currentMusicName==n)return;this.currentMusic.stop();delete this.currentMusic}this.currentMusicName=n;this.currentMusic=createjs.Sound.play(n,null,null,null,1e3);this.currentMusic.setVolume(t*this.getMusicVolume())},n.playSound=function(n,t,i,r,u,f){return i===void 0&&(i=0),f===void 0&&(f=1),createjs.Sound.play(n,t,i,r,u,f*this.getSoundVolume())},n}();n.AudiosManager=t}(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.loadAssets=function(n,t,i){t===void 0&&(t="");this.spriteSheets=i?i:[];this.bitmapFontSpriteSheetDataArray=this.bitmapFontSpriteSheetDataArray?this.bitmapFontSpriteSheetDataArray:[];this.assetsManifest=n;images||(images=[]);this.loader||(this.loader=new createjs.LoadQueue(!1),this.loader.installPlugin(createjs.Sound),createjs.Sound.alternateExtensions=["mp3"],this.loader.addEventListener("filestart",function(n){console.log("loading "+n.item.src)}),this.loader.addEventListener("fileload",function(n){console.log("loaded "+n.item.src)}),this.loader.addEventListener("complete",function(){this.onComplete&&this.onComplete()}),this.loader.addEventListener("progress",function(n){if(this.onProgress)this.onProgress(n.progress)}),this.loader.addEventListener("fileload",function(n){return n.item.type=="image"&&(images[n.item.id]=n.result),!0}));this.loader.loadManifest(n,!0,t)},n.loadFontSpriteSheet=function(n,t){this.bitmapFontSpriteSheetDataArray[n]=new createjs.SpriteSheet(t)},n.cleanAssets=function(){var n,t;images;for(n in images)t=images[n],t.dispose&&t.dispose(),delete images[n]},n.getImagesArray=function(){return images},n.getBitmap=function(t){var r,i;return this.spriteSheets&&this.spriteSheets[t]?this.getSprite(t,!1):(r=this.getLoadedImage(t),r)?(i=new createjs.Bitmap(r),i.mouseEnabled=n.defaultMouseEnabled,i):(i=new createjs.Bitmap(t),i.mouseEnabled=n.defaultMouseEnabled,i)},n.getBitmapText=function(t,i){var r=new createjs.BitmapText(t,this.bitmapFontSpriteSheetDataArray[i]);return r.lineHeight=100,r.mouseEnabled=n.defaultMouseEnabled,r},n.getLoadedImage=function(n){return this.loader?this.loader.getResult(n):null},n.getSprite=function(n,t){var i,r,f,u;t===void 0&&(t=!0);i=this.spriteSheets[n];for(r in i.images)typeof i.images[r]=="string"&&(i.images[r]=this.getLoadedImage(i.images[r]));return f=new createjs.SpriteSheet(i),u=new createjs.Sprite(f),t&&u.play(),u},n.defaultMouseEnabled=!1,n}();n.AssetsManager=t}(gameui||(gameui={})),function(n){var t=function(){function n(n,t,i,r,u){var e,f;r===void 0&&(r=60);this.defaultWidth=t;this.defaultHeight=i;this.stage=new createjs.Stage(n);createjs.Touch.enable(this.stage);e=0;createjs.Ticker.addEventListener("tick",function(){this.stage.update()});createjs.Ticker.setFPS(r);this.screenContainer=new createjs.Container;this.stage.addChild(this.screenContainer);u&&(f=new createjs.Text("FPS"," 18px Arial ","#000"),f.mouseEnabled=!1,f.x=0,f.y=0,this.stage.addChild(f),createjs.Ticker.addEventListener("tick",function(){f.text=Math.floor(createjs.Ticker.getMeasuredFPS())+" FPS"}));this.resizeGameScreen(window.innerWidth,window.innerHeight);window.onresize=function(){this.resizeGameScreen(window.innerWidth,window.innerHeight)}}return n.prototype.switchScreen=function(n,t,i){var r=this.currentScreen;i||(i=new Transition);var f=0,e=0,u=1;if(i&&r){switch(i.type){case"fade":u=0;break;case"top":e=this.currentHeight;break;case"bottom":e=-this.currentHeight;break;case"left":f=-this.currentWidth;break;case"right":f=this.currentWidth;break;case"none":i.time=0}i.type&&i.type!="none"?(n.view.mouseEnabled=!1,r.view.mouseEnabled=!1,n.view.set({alpha:u,x:-f,y:-e}),r.view.set({1:u,x:0,y:0}),createjs.Tween.get(r.view).to({alpha:1,x:f,y:e},i.time,createjs.Ease.quadInOut),createjs.Tween.get(n.view).to({alpha:1,x:0,y:0},i.time,createjs.Ease.quadInOut).call(function(){r.view.set({1:u,x:0,y:0});n.view.set({1:u,x:0,y:0});n.view.mouseEnabled=!0;r.view.mouseEnabled=!0;this.removeOldScreen(r);r=null})):(this.removeOldScreen(r),r=null)}else this.removeOldScreen(r),r=null;n.activate(t);this.screenContainer.addChild(n.view);this.currentScreen=n;this.currentScreen.redim(this.headerPosition,this.footerPosition,this.currentWidth,this.currentHeight)},n.prototype.resizeGameScreen=function(n,t,i){var r,u,f;i===void 0&&(i=!0);this.defaultHeight&&(r=this.defaultWidth/this.defaultHeight,u=n/t,u>r&&(f=t/this.defaultHeight,n=this.defaultWidth*f));this.stage.canvas.width=n;this.stage.canvas.height=t;this.updateViewerScale(n,t,this.defaultWidth,this.defaultHeight)},n.prototype.sendBackButtonEvent=function(){return this.currentScreen&&this.currentScreen.onback?(this.currentScreen.onback(),!1):!0},n.prototype.updateViewerScale=function(n,t,i,r){var u=n/i;this.currentHeight=t/u;this.currentWidth=n/u;this.defaultWidth=i;this.headerPosition=-(this.currentHeight-r)/2;this.footerPosition=r+(this.currentHeight-r)/2;this.screenContainer.scaleX=this.screenContainer.scaleY=u;this.screenContainer.y=this.viewerOffset=(this.currentHeight-r)/2*u;this.currentScreen&&this.currentScreen.redim(this.headerPosition,this.footerPosition,this.currentWidth,this.currentHeight)},n.prototype.removeOldScreen=function(n){n!=null&&(n.desactivate(),this.screenContainer.removeChild(n.view),n=null)},n}();n.GameScreen=t}(gameui||(gameui={})),function(n){var t=function(n){function t(t,i,r,u,f,e){f===void 0&&(f=0);n.call(this);this.flowHorizontal=!1;this.currentCol=0;this.currentRow=0;this.flowHorizontal=e;this.cols=t;this.rows=i;this.padding=f;this.width=r;this.height=u;this.wSpacing=(r-f*2)/t;this.hSpacing=(u-f*2)/i}return __extends(t,n),t.prototype.addObject=function(n){this.addChild(n);n.x=this.getXPos();n.y=this.getYPos();this.updatePosition()},t.prototype.getXPos=function(){return this.padding+this.currentCol*this.wSpacing+this.wSpacing/2},t.prototype.getYPos=function(){return this.padding+this.currentRow*this.hSpacing+this.hSpacing/2},t.prototype.updatePosition=function(){this.flowHorizontal?(this.currentRow++,this.currentRow>=this.rows&&(this.currentRow=0,this.currentCol++)):(this.currentCol++,this.currentCol>=this.cols&&(this.currentCol=0,this.currentRow++))},t}(UIItem);n.Grid=t}(gameui||(gameui={})),function(n){var t=function(n){function t(t,i,r){t===void 0&&(t="");i===void 0&&(i="600 90px Myriad Pro");r===void 0&&(r="#82e790");n.call(this);t=t.toUpperCase();this.textField=new createjs.Text(t,i,r);this.textField.textBaseline="middle";this.textField.textAlign="center";this.addChild(this.textField)}return __extends(t,n),t}(UIItem);n.Label=t}(gameui||(gameui={})),function(n){var t=function(n){function t(t,i,r){t===void 0&&(t=null);i===void 0&&(i=null);r===void 0&&(r=!1);r?n.call(this,0,1,t,i,0,r):n.call(this,1,0,t,i,0,r)}return __extends(t,n),t.prototype.addLabel=function(n){var t;return t=new Label(n),this.addObject(t),t.textField},t.prototype.addButton=function(n,t){t===void 0&&(t=null);var i=new TextButton(n,null,null,null,t);return this.addObject(i),i},t.prototype.addOutButton=function(n,t){t===void 0&&(t=null);var i=new TextButton(n,null,null,null,t);return this.addObject(i),i},t}(Grid);n.MenuContainer=t}(gameui||(gameui={})),function(n){var t=function(){function n(){this.view=new createjs.Container;this.content=new createjs.Container;this.overlay=new createjs.Container;this.header=new createjs.Container;this.footer=new createjs.Container;this.background=new createjs.Container;this.view.addChild(this.background);this.view.addChild(this.content);this.view.addChild(this.footer);this.view.addChild(this.header);this.view.addChild(this.overlay)}return n.prototype.activate=function(){this.content.visible=!0},n.prototype.desactivate=function(){this.content.visible=!1},n.prototype.redim=function(n,t,i,r){var f;this.screenHeight=r;this.screenWidth=i;this.footer.y=t;this.header.y=n;var e=t+n,o=t-n,u=o/e;u<1?(u=1,this.background.y=0,this.background.x=0):(this.background.y=n,this.background.x=0,this.background.scaleY=u);f=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,-(r-defaultHeight)/2,i,r));this.background.mask=f;this.footer.mask=f;this.header.mask=f;this.content.mask=f},n}();n.ScreenState=t}(gameui||(gameui={})),function(n){var t=function(){function n(){this.time=300;this.type="fade"}return n}();n.Transition=t}(gameui||(gameui={})),function(n){var r=function(n){function t(t){n.call(this);this.enableAnimation=!0;this.mouse=!1;this.addEventListener("mousedown",function(n){this.onPress(n)});this.addEventListener("pressup",function(n){this.onPressUp(n)});this.addEventListener("mouseover",function(){this.mouse=!0});this.addEventListener("mouseout",function(){this.mouse=!1});this.soundId=t}return __extends(t,n),t.setDefaultSoundId=function(n){this.DefaultSoundId=n},t.prototype.returnStatus=function(){this.mouse||(this.scaleX=this.originalScaleX,this.scaleY=this.originalScaleY)},t.prototype.onPressUp=function(){this.mouse=!1;this.set({scaleX:this.originalScaleX*1.1,scaleY:this.originalScaleY*1.1});createjs.Tween.get(this).to({scaleX:this.originalScaleX,scaleY:this.originalScaleY},200,createjs.Ease.backOut)},t.prototype.onPress=function(){this.enableAnimation&&(this.mouse=!0,this.originalScaleX==null&&(this.originalScaleX=this.scaleX,this.originalScaleY=this.scaleY),createjs.Tween.get(this).to({scaleX:this.originalScaleX*1.1,scaleY:this.originalScaleY*1.1},500,createjs.Ease.elasticOut).call(function(){this.mouse||createjs.Tween.get(this).to({scaleX:this.originalScaleX,scaleY:this.originalScaleY},300,createjs.Ease.backOut)}),this.soundId||(this.soundId=t.DefaultSoundId),this.soundId&&AudiosManager.playSound(this.soundId))},t.prototype.setSound=function(n){this.soundId=n},t}(UIItem),t,i,u,f;n.Button=r;t=function(n){function t(t,i,r){n.call(this,r);i!=null&&this.addEventListener("click",i);t!=null&&(this.background=AssetsManager.getBitmap(t),this.addChildAt(this.background,0),this.background.getBounds()?this.centralizeImage():this.background.image&&(this.background.image.onload=function(){this.centralizeImage()}));this.createHitArea()}return __extends(t,n),t.prototype.centralizeImage=function(){this.width=this.background.getBounds().width;this.height=this.background.getBounds().height;this.background.regX=this.width/2;this.background.regY=this.height/2;this.centered=!0},t}(r);n.ImageButton=t;i=function(n){function t(t,i,r,u,f,e){t===void 0&&(t="");n.call(this,u,f,e);t=t.toUpperCase();this.text=new createjs.Text(t,i,r);this.text.textBaseline="middle";this.text.textAlign="center";u==null&&(this.width=this.text.getMeasuredWidth()*1.5,this.height=this.text.getMeasuredHeight()*1.5);this.addChild(this.text);this.createHitArea();this.createHitArea()}return __extends(t,n),t}(t);n.TextButton=i;u=function(n){function t(t,i,r,u,f){n.call(this,r,u,f);t=t.toUpperCase();this.bitmapText=AssetsManager.getBitmapText(t,i);this.addChild(this.bitmapText);this.bitmapText.regX=this.bitmapText.getBounds().width/2;this.bitmapText.regY=this.bitmapText.lineHeight/2;this.createHitArea()}return __extends(t,n),t}(t);n.BitmapTextButton=u;f=function(n){function t(t,i,r,u,f,e,o){t===void 0&&(t="");i===void 0&&(i="");r===void 0&&(r=null);i!=""&&(i=" "+i);n.call(this,i,r,u,f,e,o);this.icon=AssetsManager.getBitmap(t);this.addChild(this.icon);this.text.textAlign="left";this.icon.getBounds()?this.icon.regY=this.icon.getBounds().height/2:this.icon.image&&(this.icon.image.onload=function(){this.icon.regY=this.icon.getBounds().height/2});this.updateLabel(i);this.createHitArea()}return __extends(t,n),t.prototype.updateLabel=function(n){this.text.text=n;this.icon.getBounds()&&(this.icon.x=-(this.icon.getBounds().width+10+this.text.getMeasuredWidth())/2,this.text.x=this.icon.x+this.icon.getBounds().width+10)},t.prototype.centralizeIcon=function(){},t}(i);n.IconButton=f}(gameui||(gameui={})),function(n){var t=function(){function n(){}return n.TIME="time",n.CLEAN="clean",n.FAST="fast",n.REVIVE="revive",n.LUCKY="lucky",n.EVOLVE="evolve",n}(),i;n.Items=t;i=function(){function n(){this.items={};this.items=JoinJelly.userData.loadItems()}return n.prototype.getItemAmmount=function(n){return this.items[n]||0},n.prototype.increaseItemAmmount=function(n,t){t===void 0&&(t=1);this.setItemAmmount(n,this.getItemAmmount(n)+t)},n.prototype.decreaseItemAmmount=function(n,t){t===void 0&&(t=1);this.setItemAmmount(n,this.getItemAmmount(n)-t)},n.prototype.setItemAmmount=function(n,t){t>99&&(t=99);t<0&&(t=0);this.items[n]=t;JoinJelly.userData.saveItems(this.items)},n.items=[t.TIME,t.CLEAN,t.FAST,t.REVIVE,t.EVOLVE,t.LUCKY],n}();n.ItemsData=i}(joinjelly||(joinjelly={}));var StringResources={menus:{highScore:"High Score",loading:"loading",score:"score",level:"level",options:"options",highJelly:"High Jelly",gameOver:"GAME OVER",jellypedia:"Jellypedia",pause:"paused",sound:"Sound",menu:"menu",leaderboards:"Leaderboards",reset:"Reset All Data",restore:"Restore",restoreWarning:"It will restore your purchases from store, Continue?",resetWarning:"Are you sure. All you progress will be lost",about:"About",aboutText:"Develop by",aboutURL:"www.dia-studio.com",tutorial:"Tutorial",shop:"shop",playerName:"Player Name",playerNameDesc:"Type your name for the leaderboards.",error:"Sorry, Something went wrong"},tutorial:{msgheplme:"Help me to evolve\nJoin  2 identical jellies.",msgOnceMore:"Great! now I'm bigger, \nevolve me once more",msgDirt:"Oh no, a dirt appears \n Join a jelly here to destroy it.",msgPlay:"Perfect!\nNow evolve me to the max!",msgItemClean:"You can always use items.\n this cleans the board",msgItemFast:"this one join some jellies",msgItemTime:"this one make time slower",msgItemRevive:"if you loose, use this to revive",msgBoardFill:"but be careful, \ndo not let the board fill, \nthis is the end for us."},jellies:{1:{name:"Little Jelly",description:"Small but essential"},2:{name:"Droplet",description:"Dripping everywhere"},4:{name:"Little Cake",description:"Incredible Lemon \nflavor"},8:{name:"Yolk",description:"She misses the\nMr. White..."},16:{name:"SunBronze",description:"With tanned little \nbody"},32:{name:"Strawberry",description:"Bored from jellying"},64:{name:"Upsety",description:"'Don't touch me...'"},128:{name:"Sluggjelly",description:"The sluggish Jelly"},256:{name:"Moti",description:"Irresistible desire to \neat with soy sauce"},512:{name:"Big cheeks",description:"Reminds me of my\nbrother cheeks"},1024:{name:"Geleialien",description:"Came from another\nplanet to jam"},2048:{name:"Oil",description:"An oil droplet"},4096:{name:"Healthy",description:"Your personal \nhealth jelly"},8192:{name:"Cuboid",description:"This one born boxy."},16384:{name:"Lumpy Jelly",description:"Bad tempered and \nlumpy"},32768:{name:"Sonic Jelly",description:"A very fast one"},65536:{name:"Super Sayajelly",description:"The strongest jelly \nof the universe"}},items:{clean:"Clean",fast:"Fast",time:"Time",revive:"Revive",evolve:"Evolve"},store:{title:"Store",clean:{name:"Clean 3x",desc:"Remove all dirt and small jellies"},fast:{name:"Fast 3x",desc:"Join 5 avaliable jellies"},time:{name:"Freeze Time 3x",desc:"Freeze times for 5 seconds"},revive:{name:"Revive 3x",desc:"Return to play after losing"},lucky:{name:"Lucky clover",desc:"Doubles the chance of finding an item"},pack:{name:"Item Pack",desc:"A package with 3 units of each item"}},credit:{},social:{shareDescription:"I Love this game!",shareTitle:"JoinJelly",shareCaption:""}},StringResources_pt={menus:{highScore:"Recorde",loading:"Carregando",score:"Pontos",level:"level",options:"opções",highJelly:"maior",gameOver:"GAME OVER",jellypedia:"Jellypedia",pause:"pausa",sound:"Sons",menu:"Menu",leaderboards:"Placar",reset:"Apagar tudo",restore:"Recuperar",restoreWarning:"Isso vai recuperar suas compras da loja, quer continuar?",resetWarning:"Você tem certeza? tudo que voce consquistou será perdido.",about:"Sobre",aboutText:"Desenvolvido por",aboutURL:"www.dia-studio.com",tutorial:"Tutorial",shop:"Compras",playerName:"Nome do Jogador",playerNameDesc:"Digite seu nome para aparecer no placar dos melhores",error:"Desculpe, algo deu errado."},tutorial:{msgheplme:"Me ajude a evoluir\nJunte 2 geleias IGUAIS.",msgOnceMore:"Legal! Estou maior, \nMe desenvolva novamente",msgDirt:"Oh não, sujeira! Junte \numa geleia aqui para limpar.",msgPlay:"Perfeito!\nMe evolua ao maximo!",msgItemClean:"Sempre que precisar use \nitems. Este limpa a bagunça",msgItemFast:"Esse junta \nalgumas geleias",msgItemTime:"Esse congela o tempo",msgItemRevive:"Se voce perder, use este para reviver",msgBoardFill:"Mas Tenha cuidado, se acabar \nos espaços no chão é o fim."},jellies:{1:{name:"Geleinha",description:"Pequena mas \nimportante"},2:{name:"Gotinha",description:"gotejando por\ntodo lado"},4:{name:"Bolinho",description:"Incrível sabor de\nLimão"},8:{name:"Gema",description:"Sente falta da\nClara..."},16:{name:"SunBronze",description:"Com corpinho \nbronzeado"},32:{name:"Morango",description:"Entediada de tanto\ngelatinar"},64:{name:"Chatinha",description:"Não gosta de ser \ntocada"},128:{name:"Gelerda",description:"A geleia lerdinha"},256:{name:"Moti",description:"Irresistível vontade\nde comer com shoyu"},512:{name:"Xexão",description:"Lembra as bochechas \ndo meu irmão"},1024:{name:"Geleialien",description:"Veio de outro \nplaneta para geleiar"},2048:{name:"Petróleo",description:"Uma gotinha de \nóleo"},4096:{name:"Saudável",description:"Sua geleia pessoal \nde saúde"},8192:{name:"Cuboide",description:"Esse nasceu\nquadradão."},16384:{name:"Geleia Caroço",description:"Mau humorada e \nencaroçada"},32768:{name:"Geleia Sonica",description:"Uma geleia\nmuito rápida"},65536:{name:"Super Sayajelly",description:"A geleia mais forte \ndo universo"},131072:{name:"Phanton6 Jelly",description:"description"},262144:{name:"Phanton6 Jelly",description:""}},items:{clean:"Limpa",fast:"Rápido",time:"Tempo",revive:"Reviver",evolve:"Desenvolve"},store:{title:"Loja",clean:{name:"Limpar 3x",desc:"Limpa sujeira e geleinhas"},fast:{name:"Rápido 3x",desc:"Junta algumas geleias"},time:{name:"Tempo 3x",desc:"para o tempo por 5 segundos"},revive:{name:"Reviver 3x",desc:"Retorne a jogar depis que perder."},lucky:{name:"Trevo da Sorte",desc:"Dobra a chance de encontrar items"},pack:{name:"Pacotinho",desc:"Contem 5 items de cada"},gibpack:{name:"Pacotão",desc:"Contem 10 items de cada."}},credit:{},social:{shareDescription:"Muito bom esse jogo!",shareTitle:"JoinJelly",shareCaption:""}},Analytics=function(){function n(){}return n.prototype.getUser=function(){return this.userId||(this.userId=localStorage.getItem("dia_userID")),this.userId||(this.userId=(Math.random()*9999999999).toString(),localStorage.setItem("dia_userID",this.userId)),this.userId},n.prototype.getSession=function(){return this.sessionId||(this.sessionId=(Math.random()*9999999999).toString()),this.sessionId},n.prototype.getBuild=function(){return"alpha 80"},n.prototype.sendEvent=function(n,t,i,r,u,f){var e={user_id:this.getUser(),session_id:this.getSession(),build:this.getBuild(),event_id:n+":"+t,value:i,area:this.normalizeNumber(r),x:u,y:f},o=JSON.stringify(e),s=CryptoJS.MD5(o+"f4a554ef98cb148fcc02570e8abf591f43a10996"),h=CryptoJS.enc.Hex.stringify(s);this.postAjax("http://api-eu.gameanalytics.com/1/10b6363c0a7336d2d08a4036c0971226/design",e,h)},n.prototype.postAjax=function(n,t,i){var r=new XMLHttpRequest;if(r.open("POST",n,!0),r.setRequestHeader("Content-Type","text/plain"),r.setRequestHeader("Content-Length",JSON.stringify(t).length.toString()),r.setRequestHeader("Authorization",i),r.readyState==1)try{r.send(JSON.stringify(t))}catch(u){}},n.prototype.normalizeNumber=function(n){for(var t=Math.floor(n).toString();t.length<3;)t="0"+t;return t},n.prototype.log2_number=function(n){return Math.floor(Math.log(n)/Math.log(2))},n.prototype.log2=function(n){var t=Math.floor(Math.log(n)/Math.log(2));return this.normalizeNumber(t)},n.prototype.parseTime=function(n){return Math.floor(n/6e4)},n.prototype.logGameStart=function(){this.sendEvent("GameStart","start",1)},n.prototype.logUsedItem=function(n,t){this.sendEvent("UseItem",n,1,t)},n.prototype.logEndGame=function(n,t,i,r){this.sendEvent("GameEnd","Time",1,parseInt((r/6e4).toFixed()));this.sendEvent("GameEnd","Level",1,n);this.sendEvent("GameEnd:LastJelly",this.log2(t),1)},n.prototype.logWinGame=function(n,t,i,r){this.sendEvent("GameWin","Time",this.parseTime(r));this.sendEvent("GameWin","Moves",i);this.sendEvent("GameWin","Level",n)},n.prototype.logNewJelly=function(n,t,i){this.sendEvent("NewJelly:Time",this.normalizeNumber(n),this.parseTime(i));this.sendEvent("NewJelly:Level",this.normalizeNumber(n),t)},n}(),productsData={pack1x:{icon:"Item Pack",consumable:!1,share:!0},time5x:{icon:"5x Snow",consumable:!0},fast5x:{icon:"5x Magnet",consumable:!0},revive5x:{icon:"5x Revive",consumable:!0},clean5x:{icon:"5x Clean",consumable:!0},pack5x:{icon:"5x Item Pack",consumable:!0},pack10x:{icon:"10x Item Pack",consumable:!0},lucky:{icon:"Lucky Clover",consumable:!1}},joinjelly;(function(n){var t=function(t){function i(i){t.call(this);this.maxScroll=1700;this.addBackground(i);this.addScrollableArea();this.addButton();this.onback=function(){this.okButtonAction?this.okButtonAction():n.JoinJelly.showMainMenu()}}return __extends(i,t),i.prototype.addBackground=function(n){var t,i;this.background.addChild(gameui.AssetsManager.getBitmap("BackMain"));t=gameui.AssetsManager.getBitmap("BigBG");t.mouseEnabled=!0;this.content.addChild(t);t.x=(defaultWidth-1463)/2;t.y=(defaultHeight-1788)/2;i=gameui.AssetsManager.getBitmapText(n.toUpperCase(),"debussyBig");this.content.addChild(i);i.y=t.y+50;i.x=defaultWidth/2;i.regX=i.getBounds().width/2},i.prototype.addScrollableArea=function(){var r=new createjs.Container,t=new createjs.Container,u,n,i;this.content.addChild(t);t.addChild(r);this.scrollableContent=r;u=new createjs.Shape((new createjs.Graphics).f("rgb(254,254,254)").p("EALkCFSYAAomAAocAAomYAAgUAKgUAAgUYAAjwgKjwAKj6YAKi+AKi+AAi+YAKjwAKjmAKjwYAKiMAKiWAKiMYAylUB4lADIkiYEYmaFykEH0hQYDcgeDcgeDcgeYAKAAAAAAAKAAYAAAogKAoAAAoYAABuAKBkgKBuYgKC0AACqAAC0YgKCMA8BuBuBaYBkBQB4AUB4AAcArmAAAArmAAAArmAAAYAUAAAKAAAUAAYEOgKC+i+gKkOYAAiCAAh4AAh4YgKi+gKi+AAi+YAeAAAeAAAeAAYAKAAAKAKAUAAYDSAUDIAeDSAoYFUA8EiCgDwDwYCgCqCCDIBkDcYBuDmBGDwAUEEYAKCCAKB4AACCYAKDwAKDwAUDwYAABQgKBQAUBQYAAA8AAAyAAA8YgKAyAAA8AAAyYgKIIAKH+gKIIYAACqAACqAAC0YgKD6gKD6AAD6YgKC0AAC0AAC0YgUGQgKGGgKGQYgKC+gKDIAAC+YgUEigKEsgKEiYgKCqgKCqgKCqYgKD6gKDwgKD6YgKDcgUDcgKDmYgKDSgKDSgKDSYgKDcgUDcgKDcYgKC+gKDIgKC+YgKCWAACWgyCMYgoB4geB4gyB4YiWFKjIEYkYDcYjSCgjmBukYAKYi0AKi+AKi+AKYjSAKjSAAjSAKYiMAKiMgKiMAKYi0AKi0AAi0AAYnCAAnCAUnMgKYhaAAhQAAhaAAYgUAAgUAAgUAKYywAAy6AAywAAYgUAAgKgKgUAAYlyAAlyAAlygKYiCAAiCAAiCgKYkEAAkOgKkEgKYiqgKigAAiqgKYg8AAhGgKhGgUYjwg8i+iCi0igYiWiMhuiWhuigYiMjmhaj6g8kEYgeh4AKh4gKh4YgKjSgKjSgKjSYgUjmgKjwgKjmYgKkEgKj6gKkEYgKk2gUk2gKk2YgKjmAAjcgKjmYgKmkgUmkgKmkYgKlKAAlKgKlUYAAj6gKkEAAj6YAAjSAAjcAAjSYAAgUgKgKAAgU").cp().ef());t.mask=u;n=0;this.content.addEventListener("pressmove",function(t){i||(i=t.localY);n+=(t.localY-i)*1.3;n>400&&(n=400);n<-this.maxScroll&&(n=-this.maxScroll);i=t.localY});this.content.addEventListener("pressup",function(){i=null});this.content.addEventListener("tick",function(){t.y=(t.y*2+n)/3})},i.prototype.addButton=function(){var t=new gameui.ImageButton("BtOk",function(){this.okButtonAction?this.okButtonAction():n.JoinJelly.showMainMenu()});t.x=defaultWidth*3/4;t.y=defaultHeight-200;this.content.addChild(t)},i}(gameui.ScreenState);n.ScrollablePage=t})(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){var r,t,i;n.call(this);r="assets/sounds/";t="assets/images/";assetscale=1;window.innerWidth<=1024&&(assetscale=.5);window.innerWidth<=384&&(assetscale=.25);t="assets/images_"+assetscale+"x/";testMode||(createjs.Sound.alternateExtensions=["mp3"],createjs.Sound.registerSounds(audioManifest,r));gameui.AssetsManager.loadAssets(imageManifest,t);gameui.AssetsManager.loadFontSpriteSheet("debussy",createSpriteSheetFromFont(debussyFont,t));gameui.AssetsManager.loadFontSpriteSheet("debussyBig",createSpriteSheetFromFont(debussyFontBig,t));gameui.AssetsManager.onProgress=function(n){i.update(n)};gameui.AssetsManager.onComplete=function(){this.loaded&&this.loaded()};this.background.addChild(gameui.AssetsManager.getBitmap(t+"BackMain.jpg"));gameui.Button.DefaultSoundId="Interface Sound-06";i=new view.LoadingBar(t);this.content.addChild(i);i.x=defaultWidth/2;i.y=defaultHeight/2}return __extends(t,n),t}(gameui.ScreenState);n.Loading=t})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t=function(t){function i(n){t.call(this);this.timeStep=2;this.boardSize=5;this.userData=n;this.createContent();this.createBackground();this.createButtons();this.createTitle();gameui.AudiosManager.playMusic("musicIntro")}return __extends(i,t),i.prototype.createContent=function(){var t=new menus.view.JellyLobby(this.userData.getLastJelly()),n;t.x=defaultWidth/2;t.y=1e3;this.content.addChild(t);n=new gameui.ImageButton("BtPlay",function(){JoinJelly.userData.getHistory(histories.TUTORIAL)?JoinJelly.startLevel():JoinJelly.showIntro()});n.y=1168;n.x=768;this.content.addChild(n)},i.prototype.createTitle=function(){var t=new n.menus.view.GameTitle;this.content.addChild(t)},i.prototype.createBackground=function(){this.background.addChild(gameui.AssetsManager.getBitmap("BackMain"))},i.prototype.createButtons=function(){var n,r,u,f;this.userData&&(this.scoreText=gameui.AssetsManager.getBitmapText(StringResources.menus.highScore,"debussy"),this.scoreText.x=70,this.scoreText.y=-250,this.footer.addChild(this.scoreText),this.scoreText=gameui.AssetsManager.getBitmapText(this.userData.getHighScore().toString(),"debussyBig"),this.scoreText.x=70,this.scoreText.y=-170,this.footer.addChild(this.scoreText));var t=defaultWidth+100,i=250,n=new gameui.ImageButton("DIAStudioIco",function(){JoinJelly.showAbout()});n.y=165/2;n.x=defaultWidth-165/2;this.header.addChild(n);n=new gameui.ImageButton("BtMenu",function(){JoinJelly.showSettings()});n.y=-150;n.x=t-=i;this.footer.addChild(n);r=new gameui.ImageButton("BtStore",function(){JoinJelly.showStore(this)});r.y=-150;r.x=t-=i;this.footer.addChild(r);u=new gameui.ImageButton("BtAchievements",function(){JoinJelly.showPedia()});u.y=-150;u.x=t-=i;this.footer.addChild(u);f=new gameui.ImageButton("BtLeaderBoards",function(){JoinJelly.gameServices.showLeaderboard()});f.y=-150;f.x=t-=i;this.footer.addChild(f)},i}(gameui.ScreenState);n.MainScreen=t}(joinjelly||(joinjelly={})),function(n){var t=function(n){function t(t,i){var u,e,r,f;for(n.call(this,StringResources.menus.jellypedia),u=new createjs.Container,this.scrollableContent.addChild(u),u.y=400,e=0,r=1;r<=JoinJelly.maxJelly;r*=2)f=r<=Math.max(1,t.getLastJelly())?new menus.view.JellyPediaItem(r,i[r].name,i[r].description):new menus.view.JellyPediaItem(0,"?",""),u.addChild(f),f.y=500*e,f.x=150,e++;this.maxScroll=7300}return __extends(t,n),t}(ScrollablePage);n.Jellypedia=t}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.createJoin();this.createJelly()}return __extends(i,t),i.prototype.createJoin=function(){for(var n,i=[0,213,442,631,839],r=[0,1,0,0,1],u=[0,1,1,-1,-1],f=[],t=1;t<=4;t++)n=gameui.AssetsManager.getBitmap("title_join_"+t),n.regX=n.getBounds().width/2,n.regY=n.getBounds().height/2,n.y=514+n.getBounds().height/2-n.getBounds().height,n.x=i[t],n.alpha=0,this.addChild(n),f[t]=n,createjs.Tween.get(n).wait(r[t]*400).to({alpha:0,x:i[t]-300*u[t],scaleX:3,scaleY:.333}).to({alpha:2,x:i[t],scaleX:1,scaleY:1},2e3,createjs.Ease.elasticInOut)},i.prototype.createJelly=function(){for(var i,t,u=[213,492,761,1039,1278],r=1;r<=5;r++)i=gameui.AssetsManager.getBitmap("title_jelly_"+r),i.regX=i.getBounds().width/2,i.regY=i.getBounds().height,t=new n.view.JellyContainer,t.visible=!1,t.executeAnimationIn(r*100+1600),t.imageContainer.addChild(i),this.addChild(t),t.x=u[r-1],t.y=800},i}(createjs.Container);t.GameTitle=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this);this.dropAllJellys(t)}return __extends(t,n),t.prototype.dropAllJellys=function(n){var i,r,u,t;for(n||(n=1),n>JoinJelly.maxJelly&&(n=JoinJelly.maxJelly),i=[],t=1;t<=n;t*=2)i.push(t);for(r=0,u=1,t=0;t<i.length;t++)setTimeout(function(){this.dropJelly(u,r);r++;u*=2},t*200)},t.prototype.dropJelly=function(n,t){var r=[[3/6,0],[2/6,.2],[4/6,.2],[1/6,.4],[5/6,.4],[2/5,1],[3/5,1],[1/5,1.7],[4/5,1.7],[1/6,3],[2/6,2.4],[4/6,2.4],[5/6,3],[2/7,3.3],[3/7,2.9],[4/7,3.1],[5/7,3.3],],i=new gameplay.view.Jelly,u;this.addChildAt(i,0);i.setNumber(n);u=t%2?-1:1;i.x=(r[t][0]*defaultWidth-defaultWidth/2)*1.2;i.y=r[t][1]*-200+750;i.scaleX=i.scaleY=Math.min(1-r[t][1]/7,1);gameui.AudiosManager.playSound("sound_s"+(Math.floor(Math.random()*3)+1),null,400)},t}(createjs.Container);n.JellyLobby=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i){i===void 0&&(i=1022);n.call(this);this.top=defaultHeight/2+1022-i;this.regX=this.x=defaultWidth/2;this.regY=this.y=defaultHeight/2;this.AddBG(i);this.addTitle(t);this.visible=!1}return __extends(t,n),t.prototype.setTitle=function(n){this.title.text=n.toUpperCase();this.title.regX=this.title.getBounds().width/2},t.prototype.AddBG=function(n){var i=gameui.AssetsManager.getBitmap("popupdark"),t;this.addChild(i);i.scaleX=i.scaleY=16;i.x=-defaultWidth/2;i.y=-defaultHeight/2;i.mouseEnabled=!1;t=gameui.AssetsManager.getBitmap("FlyBG");t.set({x:defaultWidth/2,y:557,regX:1305/2});t.scaleY=n/1022;this.addChild(t);t.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(-t.x+t.regX,-t.y+t.regY,defaultWidth,defaultHeight))},t.prototype.addTitle=function(n){this.title=gameui.AssetsManager.getBitmapText("","debussyBig");this.title.set({x:defaultWidth/2,y:600});this.addChild(this.title);this.setTitle(n)},t.prototype.animateIn=function(){createjs.Tween.removeTweens(this);this.visible=!0;this.y=this.top-500;this.alpha=0;this.scaleX=.5;this.scaleY=2;createjs.Tween.get(this).to({x:defaultWidth/2,y:this.top,alpha:1,scaleX:1,scaleY:1},1400,createjs.Ease.elasticOut)},t.prototype.animateOut=function(){createjs.Tween.removeTweens(this);this.alpha=1;this.scaleX=1;this.scaleY=1;createjs.Tween.get(this).to({alpha:0,scaleX:.5,scaleY:.75},200,createjs.Ease.quadIn).call(function(){this.visible=!1})},t.prototype.show=function(){this.animateIn();gameui.AudiosManager.playSound("Interface Sound-14")},t.prototype.hide=function(){this.visible&&(this.animateOut(),gameui.AudiosManager.playSound("Interface Sound-15"))},t}(createjs.Container);n.FlyOutMenu=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r){var s,e;n.call(this);s=gameui.AssetsManager.getBitmap("pediaItem");this.addChild(s);var o=new createjs.Container,u=gameui.AssetsManager.getBitmapText(i,"debussyBig"),f=gameui.AssetsManager.getBitmapText(r,"debussy");u.y=30;f.y=130;u.scaleX=u.scaleY=.9;f.scaleX=f.scaleY=.9;u.x=f.x=450;o.addChild(u);o.addChild(f);this.addChild(o);e=new gameplay.view.Jelly;e.setNumber(t);e.x=166;e.y=332;this.addChild(e)}return __extends(t,n),t}(createjs.Container);n.JellyPediaItem=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(t){function i(i){var r,u,f;t.call(this,StringResources.store.title);this.previousScreen=i;r=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy");r.y=500;r.x=defaultWidth/2;r.regX=r.getBounds().width/2;this.StatusText=r;this.scrollableContent.addChild(r);u=new n.view.LoadingBall;u.y=800;u.x=defaultWidth/2;this.loadingBall=u;this.scrollableContent.addChild(u);this.gameFooter=new gameplay.view.ItemsFooter([Items.TIME,Items.CLEAN,Items.FAST,Items.REVIVE]);this.footer.addChild(this.gameFooter);this.gameFooter.mouseEnabled=!1;this.updateFooter();this.content.y-=200;this.okButtonAction=function(){n.JoinJelly.gameScreen.switchScreen(i)};this.initializeStore();f=new gameui.BitmapTextButton(StringResources.menus.restore,"debussy","BtTextBg",function(){Cocoon.Dialog.confirm({title:StringResources.menus.restore,message:StringResources.menus.restoreWarning},function(n){n&&Cocoon.Store.restore()})});f.x=defaultWidth/3;f.y=defaultHeight-200;this.content.addChild(f)}return __extends(i,t),i.prototype.fillProducts=function(n){var t;this.productsListItems={};this.showLoaded();for(t in n)this.addProduct(n[t],t)},i.prototype.addProduct=function(n,t){var i=new view.ProductListItem(n.productId,n.title.replace("(Join Jelly)",""),n.description,n.localizedPrice);this.productsListItems[n.productId]=i;this.scrollableContent.addChild(i);i.y=t*380+380;i.x=70;console.log(JSON.stringify(n));i.addEventListener("buy",function(n){Cocoon.Store.purchase(n.productId)});i.addEventListener("share",function(n){var t=n.currentTarget;t.setPurchasing();this.lockUI();this.purchaseShareProduct(n.productId,function(n){n?(t.setPurchased(),gameui.AudiosManager.playSound("Interface Sound-11")):t.setNormal();this.updateFooter();this.unlockUI()})})},i.prototype.showLoading=function(){this.StatusText.text=StringResources.menus.loading;this.loadingBall.visible=!0},i.prototype.showLoaded=function(){this.StatusText.visible=!1;this.loadingBall.visible=!1},i.prototype.showError=function(){this.StatusText.text=StringResources.menus.error;this.loadingBall.visible=!1},i.prototype.lockUI=function(n){n===void 0&&(n=5e3);this.content.mouseEnabled=!1;setTimeout(function(){this.unlockUI()},n)},i.prototype.unlockUI=function(){this.content.mouseEnabled=!0},i.prototype.updateFooter=function(){var n=ItemsData.items;for(var t in n)this.gameFooter.setItemAmmount(n[t],JoinJelly.itemData.getItemAmmount(n[t]))},i.prototype.getProductListItem=function(n){return this.productsListItems[n]},i.prototype.animateItem=function(n){switch(n){case"time5x":this.gameFooter.bounceItem(Items.TIME);break;case"fast5x":this.gameFooter.bounceItem(Items.FAST);break;case"clean5x":this.gameFooter.bounceItem(Items.CLEAN);break;case"revive5x":this.gameFooter.bounceItem(Items.REVIVE);break;case"pack5x":this.gameFooter.bounceItem(Items.TIME);this.gameFooter.bounceItem(Items.FAST);this.gameFooter.bounceItem(Items.CLEAN);this.gameFooter.bounceItem(Items.REVIVE);break;case"pack10x":this.gameFooter.bounceItem(Items.TIME);this.gameFooter.bounceItem(Items.FAST);this.gameFooter.bounceItem(Items.CLEAN);this.gameFooter.bounceItem(Items.REVIVE)}},i.prototype.initializeStore=function(){var n,t;Cocoon.Store.on("load",{started:function(){this.showLoading()},success:function(n){this.fillProducts(n)},error:function(){this.showError()}});Cocoon.Store.on("purchase",{started:function(n){this.getProductListItem(n).setPurchasing();this.lockUI()},success:function(n){this.fullFillPurchase(n.productId);this.updateFooter();this.unlockUI();this.animateItem(n.productId);productsData[n.productId].consumable&&(this.getProductListItem(n.productId).setPurchased(!0),Cocoon.Store.consume(n.transactionId,n.productId));this.getProductListItem(n.productId).setPurchased();Cocoon.Store.finish(n.transactionId)},error:function(n){this.getProductListItem(n).setNormal();this.unlockUI()}});Cocoon.Store.initialize({sandbox:!0,managed:!0});n=[];for(t in productsData)n.push(t);Cocoon.Store.loadProducts(n)},i.prototype.purchaseShareProduct=function(n,t){var i=Cocoon.Social.Facebook;i.init({appId:fbAppId});var r=i.getSocialInterface(),u=new Cocoon.Social.Message(StringResources.social.shareDescription,gameWebsiteIcon,gameWebsite,StringResources.social.shareTitle,StringResources.social.shareCaption),f=this;r.publishMessageWithDialog(u,function(i){console.log("shared "+JSON.stringify(i));var r=!0;i&&(r=!1);r&&f.fullFillPurchase(n);t(r)})},i.prototype.updateProductsAvaliability=function(){},i.prototype.fullFillPurchase=function(n){switch(n){case"time5x":JoinJelly.itemData.increaseItemAmmount(Items.TIME,5);break;case"fast5x":JoinJelly.itemData.increaseItemAmmount(Items.FAST,5);break;case"clean5x":JoinJelly.itemData.increaseItemAmmount(Items.CLEAN,5);break;case"revive5x":JoinJelly.itemData.increaseItemAmmount(Items.REVIVE,5);break;case"pack5x":JoinJelly.itemData.increaseItemAmmount(Items.TIME,5);JoinJelly.itemData.increaseItemAmmount(Items.FAST,5);JoinJelly.itemData.increaseItemAmmount(Items.CLEAN,5);JoinJelly.itemData.increaseItemAmmount(Items.REVIVE,5);break;case"pack10x":JoinJelly.itemData.increaseItemAmmount(Items.TIME,10);JoinJelly.itemData.increaseItemAmmount(Items.FAST,10);JoinJelly.itemData.increaseItemAmmount(Items.CLEAN,10);JoinJelly.itemData.increaseItemAmmount(Items.REVIVE,10);break;case"lucky":JoinJelly.itemData.increaseItemAmmount(Items.LUCKY,1)}return!0},i}(ScrollablePage);t.StoreMenu=i})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(t){function i(){var u,f;t.call(this,StringResources.menus.menu);this.maxScroll=1700;var i=270,r=400,e=new n.view.SoundOptions;this.scrollableContent.addChild(e);this.scrollableContent.x=defaultWidth/2;e.y=r+=i;u=new gameui.BitmapTextButton(StringResources.menus.tutorial,"debussy","BtTextBg",function(){JoinJelly.showIntro()});u.y=r+=i;this.scrollableContent.addChild(u);f=new gameui.BitmapTextButton(StringResources.menus.reset,"debussy","BtTextBg",function(){Cocoon.Dialog.confirm({title:StringResources.menus.reset,message:StringResources.menus.resetWarning},function(n){n&&(JoinJelly.userData.resetAll(),JoinJelly.showMainMenu())})});f.y=r+=i;this.scrollableContent.addChild(f)}return __extends(i,t),i}(ScrollablePage);n.MainMenu=t})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t=function(t){function i(){var i,r,u;t.call(this);this.maxScroll=1700;this.background.addChild(gameui.AssetsManager.getBitmap("BackMain"));i=gameui.AssetsManager.getBitmapText(StringResources.menus.aboutText,"debussyBig");i.regX=i.getBounds().width/2;this.content.addChild(i);i.x=defaultWidth/2;i.y=defaultHeight/2-500;i=gameui.AssetsManager.getBitmapText(StringResources.menus.aboutURL,"debussy");i.regX=i.getBounds().width/2;this.content.addChild(i);i.x=defaultWidth/2;i.y=defaultHeight/2+400;r=new gameui.ImageButton("DIAStudioLogo",function(){Cocoon.App.openURL("http://"+StringResources.menus.aboutURL)});r.x=defaultWidth/2;r.y=defaultHeight/2;this.content.addChild(r);u=new gameui.ImageButton("BtOk",function(){n.JoinJelly.showMainMenu()});u.x=defaultWidth/2;u.y=defaultHeight-200;this.content.addChild(u)}return __extends(i,t),i}(gameui.ScreenState);n.About=t}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.addSoundOptions()}return __extends(t,n),t.prototype.addSoundOptions=function(){var t=gameui.AssetsManager.getBitmap("FlyGroup"),n,i,r;t.y=-130;t.regX=t.getBounds().width/2;this.addChild(t);n=gameui.AssetsManager.getBitmapText(StringResources.menus.sound,"debussy");n.y=-190;n.scaleX=n.scaleY=1.1;n.regX=n.getBounds().width/2;this.addChild(n);this.musicBtOn=new gameui.ImageButton("BtMusic",function(){this.setMusic(0)});this.musicBtOn.x=-145;this.addChild(this.musicBtOn);this.soundBtOn=new gameui.ImageButton("BtSound",function(){this.setSound(0)});this.soundBtOn.x=155;this.addChild(this.soundBtOn);this.musicBtOff=new gameui.ImageButton("BtMusicOff",function(){this.setMusic(1)});this.musicBtOff.x=-145;this.addChild(this.musicBtOff);this.soundBtOff=new gameui.ImageButton("BtSoundOff",function(){this.setSound(1)});this.soundBtOff.x=155;this.addChild(this.soundBtOff);i=JoinJelly.userData.getMusicVol();r=JoinJelly.userData.getSoundVol();this.musicBtOff.visible=!i;this.soundBtOff.visible=!r;this.musicBtOn.visible=!!i;this.soundBtOn.visible=!!r},t.prototype.setMusic=function(n){n?(this.musicBtOff.fadeOut(),this.musicBtOn.fadeIn()):(this.musicBtOn.fadeOut(),this.musicBtOff.fadeIn());JoinJelly.userData.setMusicVol(n);gameui.AudiosManager.setMusicVolume(n?1:0)},t.prototype.setSound=function(n){n?(this.soundBtOff.fadeOut(),this.soundBtOn.fadeIn()):(this.soundBtOn.fadeOut(),this.soundBtOff.fadeIn());JoinJelly.userData.setSoundVol(n);gameui.AudiosManager.setSoundVeolume(n?1:0)},t}(createjs.Container);n.SoundOptions=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.shadowContainer=new createjs.Container;this.imageContainer=new createjs.Container;this.addChild(this.shadowContainer);this.addChild(this.imageContainer)}return __extends(t,n),t.prototype.executeAnimationIn=function(n){(n===void 0&&(n=0),this.state!="in")&&(this.state="in",this.restore(),this.imageContainer.set({alpha:0,scaleX:0,scaleY:0,y:-40}),this.shadowContainer.set({alpha:0,scaleX:0}),createjs.Tween.get(this.imageContainer).wait(n).to({alpha:1,scaleX:.8,scaleY:1.2},200,createjs.Ease.sineOut).to({scaleX:1,scaleY:1,y:0},2e3,createjs.Ease.elasticOut).call(function(){this.executeIdle()}),createjs.Tween.get(this.shadowContainer).wait(n).to({alpha:1,scaleX:1,scaleY:1},400,createjs.Ease.sineOut).call(function(){}))},t.prototype.executeAnimationHold=function(){this.state!="hold"&&(this.state="hold",this.restore(),createjs.Tween.get(this.imageContainer).to({scaleX:.8,scaleY:1.2},1e3,createjs.Ease.elasticOut),createjs.Tween.get(this.shadowContainer).to({alpha:0},200))},t.prototype.executeAimationRelease=function(){this.state!="release"&&(this.state="release",this.restore(),createjs.Tween.get(this.imageContainer).to({scaleX:.8,scaleY:1.2},5,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},2e3,createjs.Ease.elasticOut).call(function(){this.executeIdle()}),createjs.Tween.get(this.shadowContainer).to({alpha:1},200))},t.prototype.restore=function(){this.state="";createjs.Tween.removeTweens(this.imageContainer);createjs.Tween.removeTweens(this.shadowContainer);this.visible=!0;this.alpha=1;this.imageContainer.scaleX=this.imageContainer.scaleY=1;this.imageContainer.skewX=this.imageContainer.skewY=0;this.imageContainer.rotation=0;this.imageContainer.alpha=1;this.imageContainer.visible=!0;this.imageContainer.y=0;this.shadowContainer.visible=!0;this.shadowContainer.alpha=1;this.shadowContainer.skewX=this.shadowContainer.skewY=0},t.prototype.executeIdle=function(){if(this.state!="idle"){this.state="idle";switch(Math.floor(Math.random()*3)){case 0:this.executeIdle1();break;case 1:this.executeIdle2();break;case 2:this.executeIdle3()}}},t.prototype.executeIdle1=function(){var t=Math.random()*500+600,i=Math.random(),n,r;i<.6&&(i=i/2);n=Math.random();r=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({skewX:0,scaleX:1+n,scaleY:1-n},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(this.imageContainer,{loop:!0}).to({skewX:i*10},t,createjs.Ease.quadOut).to({skewX:i*0},t,createjs.Ease.quadIn).to({skewX:i*-10},t,createjs.Ease.quadOut).to({skewX:i*0},t,createjs.Ease.quadIn);createjs.Tween.get(this.imageContainer,{loop:!0}).to({scaleX:1-n,scaleY:1+n},t,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t,createjs.Ease.quadInOut).to({scaleX:1-n,scaleY:1+n},t,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t,createjs.Ease.quadInOut)});createjs.Tween.get(this.shadowContainer).to({alpha:1,scaleY:1,scaleX:1,skewX:0},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(this.shadowContainer,{loop:!0}).to({skewX:-5*i},t,createjs.Ease.quadOut).to({skewX:0*i},t,createjs.Ease.quadIn).to({skewX:5*i},t,createjs.Ease.quadOut).to({skewX:0*i},t,createjs.Ease.quadIn)})},t.prototype.executeIdle2=function(){var t=Math.random()*500+600,i=Math.random(),n,r;i<.6&&(i=i/2);n=Math.random()*.5+.5;r=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({scaleX:1,scaleY:1},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(this.imageContainer,{loop:!0}).to({scaleX:1-n,scaleY:1+n},t/4,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t/4,createjs.Ease.quadInOut).to({scaleX:1-n,scaleY:1+n},t/4,createjs.Ease.quadInOut).to({scaleX:1+n,scaleY:1-n},t/4,createjs.Ease.quadInOut).to({scaleX:1,scaleY:1},t*2,createjs.Ease.elasticOut)})},t.prototype.executeIdle3=function(){var t=Math.random()*500+600,i=Math.random(),n,r;i<.6&&(i=i/2);n=Math.random()*.5+.5;r=4+Math.floor(Math.random()*3);n=n/10;createjs.Tween.get(this.imageContainer).to({scaleX:1,scaleY:1,y:0},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(this.imageContainer,{loop:!0}).to({scaleX:1+n*2,scaleY:1-n*2,y:0},t/2,createjs.Ease.quadInOut).to({scaleX:1-n*2,scaleY:1+n*2,y:0},t/4,createjs.Ease.quadIn).to({scaleX:1+n*1,scaleY:1-n*1,y:-70},t/4,createjs.Ease.quadOut).to({scaleX:1-n*2,scaleY:1+n*2,y:0},t/5,createjs.Ease.quadIn).to({scaleX:1,scaleY:1},t*2,createjs.Ease.elasticOut)})},t}(createjs.Container);n.JellyContainer=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){var i;n.call(this);i=gameui.AssetsManager.getBitmap("loadingBall");this.addChild(i);i.regX=47;i.regY=94;i.y=47;var r=600,u=1,t=.1;createjs.Tween.get(i).to({skewX:0,scaleX:1+t,scaleY:1-t},400,createjs.Ease.quadInOut).call(function(){createjs.Tween.get(i,{loop:!0}).to({skewX:u*10},r,createjs.Ease.quadOut).to({skewX:u*0},r,createjs.Ease.quadIn).to({skewX:u*-10},r,createjs.Ease.quadOut).to({skewX:u*0},r,createjs.Ease.quadIn);createjs.Tween.get(i,{loop:!0}).to({scaleX:1-t,scaleY:1+t},r,createjs.Ease.quadInOut).to({scaleX:1+t,scaleY:1-t},r,createjs.Ease.quadInOut).to({scaleX:1-t,scaleY:1+t},r,createjs.Ease.quadInOut).to({scaleX:1+t,scaleY:1-t},r,createjs.Ease.quadInOut)})}return __extends(t,n),t}(createjs.Container);n.LoadingBall=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(){t.call(this);this.addObjects()}return __extends(i,t),i.prototype.addObjects=function(){var s=this,e=new gameui.ImageButton("BtPause",function(){s.dispatchEvent("pause")}),o,i,r,t,u,f;this.pauseButton=e;e.x=157;e.y=215;this.addChild(e);o=gameui.AssetsManager.getBitmap("bonus_border");this.addChild(o);o.x=309;o.y=122;i=gameui.AssetsManager.getBitmap("bonus_bar");i.x=372;i.y=207;i.mask=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,0,939,57));i.mask.x=372;i.mask.y=207;this.levelBar=i;this.addChild(i);r=gameui.AssetsManager.getBitmap("powerTip");r.x=372;r.y=207;r.regX=67/2;r.regY=77/2;this.levelTip=r;this.addChild(r);t=gameui.AssetsManager.getBitmap("bonus_icon");t.x=1288+213/2;t.y=90+243/2;t.regX=213/2;t.regY=243/2;t.mouseEnabled=!0;this.levelIcon=t;this.addChild(t);t.addEventListener("click",function(){s.levelUpEffect()});this.effect=new n.view.Effect;this.addChild(this.effect);this.effect.x=1288+213/2;this.effect.y=90+243/2;u=gameui.AssetsManager.getBitmapText(StringResources.menus.score,"debussy");u.x=373;u.y=124;u.scaleX=u.scaleY=.85;this.scoreText=u;this.addChild(u);f=gameui.AssetsManager.getBitmapText(StringResources.menus.level,"debussyBig");f.x=1e3;f.y=77;this.levelText=f;this.addChild(f)},i.prototype.hidePauseButton=function(){this.pauseButton.fadeOut()},i.prototype.showPauseButton=function(){this.pauseButton.fadeIn()},i.prototype.hide=function(){createjs.Tween.get(this).to({y:-425},200,createjs.Ease.quadIn)},i.prototype.show=function(){this.visible=!0;this.alpha=1;createjs.Tween.get(this).to({y:-0},200,createjs.Ease.quadOut)},i.prototype.updateStatus=function(n,t,i){this.scoreText.text=StringResources.menus.score.toUpperCase()+" "+n.toString();this.levelText.text="Lv. "+t.toString();var r=1;i!=undefined&&n!=this.lastScore&&(r=i/100,createjs.Tween.removeTweens(this.levelBar.mask),createjs.Tween.get(this.levelBar.mask).to({scaleX:r},1e3,createjs.Ease.elasticOut),createjs.Tween.removeTweens(this.levelTip),createjs.Tween.get(this.levelTip).to({x:r*940+this.levelBar.x,y:this.levelBar.y+24},1e3,createjs.Ease.elasticOut),createjs.Tween.get(this.levelTip).to({scaleX:2,scaleY:2}).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut));this.lastLevel!=t&&this.levelUpEffect();this.lastLevel=t;this.lastScore=n},i.prototype.levelUpEffect=function(){var n=this;this.effect.castBoth();createjs.Tween.removeTweens(this.levelBar.mask);createjs.Tween.get(this.levelBar.mask).to({scaleX:1},100,createjs.Ease.quadIn).call(function(){n.levelBar.mask.scaleX=0});createjs.Tween.removeTweens(this.levelText);this.levelText.set({scaleY:0,scaleX:4});createjs.Tween.get(this.levelText).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut);createjs.Tween.removeTweens(this.levelIcon);this.levelIcon.set({scaleY:2,scaleX:.1});createjs.Tween.get(this.levelIcon).to({scaleX:1,scaleY:1},1e3,createjs.Ease.elasticOut)},i}(createjs.Container);t.GameHeader=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(i){t.call(this);this.effect=new n.view.Effect;this.addChild(this.effect);this.effect.scaleX=this.effect.scaleY=1.2;this.effect.x=0;this.effect.y=-100;i&&this.setNumber(i)}return __extends(i,t),i.prototype.getAssetIdByValue=function(n){return n<0?n.toString():i.jellies[Math.log(n)/Math.log(2)]},i.prototype.createJelly=function(n){var t=gameui.AssetsManager.getBitmap("j"+this.getAssetIdByValue(n)),i;t.regX=t.getBounds().width/2;t.regY=t.getBounds().height;i=gameui.AssetsManager.getBitmap("shadow");i.regY=45;i.regX=108;i.scaleX=i.scaleY=t.getBounds().width/216;this.shadowContainer.addChild(i);this.imageContainer.addChild(t)},i.prototype.createEyes=function(n){var t=new createjs.Container,i=gameui.AssetsManager.getBitmap("e"+this.getAssetIdByValue(n));i.regY=20;createjs.Tween.get(i,{loop:!0}).wait(3e3+Math.random()*1e3).to({scaleY:.2},100).to({scaleY:1},100);t.addChild(i);t.regX=133/2;i.getBounds()&&(t.regX=i.getBounds().width/2);t.y=Math.min(-100,-t.getBounds().height);this.imageContainer.addChild(t);this.eyeImg=i},i.prototype.setNumber=function(n){(n>JoinJelly.maxJelly&&(n=JoinJelly.maxJelly),this.currentValue!=n)&&(this.currentValue=n,this.eyeImg&&createjs.Tween.removeTweens(this.eyeImg),this.imageContainer.removeAllChildren(),this.shadowContainer.removeAllChildren(),n!=0&&n?(this.visible=!0,this.alpha=1,this.createJelly(n),this.createEyes(n),this.executeAnimationIn(),n>1&&this.playJoinFX()):this.visible=!1)},i.prototype.playJoinFX=function(){this.effect.alpha=.5;this.effect.castSimple()},i.prototype.playLevelUp=function(){this.effect.alpha=.25;this.effect.castSimple()},i.prototype.playEvolve=function(){this.effect.alpha=1;this.effect.castBoth()},i.prototype.playThunder=function(){setTimeout(function(){this.playEvolve()},10);setTimeout(function(){this.playLevelUp()},330);setTimeout(function(){this.playEvolve()},660);setTimeout(function(){this.playLevelUp()},1e3);setTimeout(function(){this.playLevelUp()},1100)},i.jellies=["1","2","4","8","16","32","64","128","256","512","1024","oil","2048","square","4096","8192b","8192",],i}(n.view.JellyContainer);t.Jelly=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.showLevel=function(n){var t=gameui.AssetsManager.getBitmapText("level","debussy");this.addChild(t);t.text="LEVEL "+n;t.x=defaultWidth/2;t.y=defaultHeight/2+140;t.alpha=0;t.regX=t.getBounds().width/2;createjs.Tween.get(t).to({y:defaultHeight/2,alpha:1},200,createjs.Ease.quadOut).wait(500).to({y:defaultHeight/2-200,alpha:0},200,createjs.Ease.quadIn).call(function(){this.removeChild(t)})},t}(createjs.Container);n.LevelIndicator=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this);this.ammount=0;this.locked=!1;this.item=t;this.addEventListener("click",function(){this.dispatchEvent({type:"useitem",item:t})});var f=gameui.AssetsManager.getBitmap("itemBG"),e=gameui.AssetsManager.getBitmap("itemBGDisabled"),i=gameui.AssetsManager.getBitmap("item"+t),u=gameui.AssetsManager.getBitmapText("0","debussy"),r=gameui.AssetsManager.getBitmapText(StringResources.items[t],"debussy"),o=gameui.AssetsManager.getBitmap("BtPlusMini");this.disabled=e;this.addChild(f);this.addChild(e);this.addChild(i);this.addChild(u);this.addChild(r);this.addChild(o);e.visible=!1;e.regX=f.regX=f.getBounds().width/2;e.regY=f.regY=f.getBounds().height/2;i.regX=i.getBounds().width/2;i.regY=i.getBounds().height/2;i.scaleX=i.scaleY=.4;i.y=-25;u.scaleX=u.scaleY=.7;u.y=-110;u.x=-80;u.name="value";r.scaleX=r.scaleY=.6;r.y=30;r.x=0;r.regX=r.getBounds().width/2;r.name="value";o.y=0;o.x=55;this.text=u;this.createHitArea();this.addBt=o;this.addEventListener("click",function(){this.unHighlight()})}return __extends(t,n),t.prototype.setAmmount=function(n){this.ammount=n;this.ammount<=0?(this.disabled.visible=!0,this.addBt.visible=!0):(this.disabled.visible=!1,this.addBt.visible=!1);this.text.text=n.toString();this.updateColor()},t.prototype.lock=function(){this.mouseEnabled=!1;this.locked=!0;this.updateColor()},t.prototype.unlock=function(){this.mouseEnabled=!0;this.locked=!1;this.updateColor()},t.prototype.highLight=function(n){n===void 0&&(n=!0);createjs.Tween.get(this,{loop:n}).to({rotation:-10,scaleX:1,scaleY:1},100,createjs.Ease.quadInOut).to({rotation:10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:-10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:10,scaleX:1.3,scaleY:1.3},200,createjs.Ease.quadInOut).to({rotation:0,scaleX:1,scaleY:1},100,createjs.Ease.quadInOut).wait(400)},t.prototype.unHighlight=function(){createjs.Tween.removeTweens(this);this.set({rotation:0,scaleX:1,scaleY:1})},t.prototype.updateColor=function(){this.disabled.visible=this.locked||this.ammount<=0?!0:!1},t}(gameui.Button);n.ItemButton=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(n){function t(){n.call(this,StringResources.menus.pause);this.addButtons();var t=new menus.view.SoundOptions;this.addChild(t);t.set({x:defaultWidth/2,y:1e3})}return __extends(t,n),t.prototype.addButtons=function(){var i=new gameui.ImageButton("BtPlay",function(){this.dispatchEvent("play")}),n,t;i.set({x:771,y:1599});this.addChild(i);n=new gameui.ImageButton("BtHome",function(){this.dispatchEvent("home")});n.set({x:353,y:1570});this.addChild(n);t=new gameui.ImageButton("BtRestart",function(){this.dispatchEvent("restart")});t.set({x:1190,y:1570});this.addChild(t)},t}(n.menus.view.FlyOutMenu);t.PauseMenu=i})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.value=1;this.initializeObjects()}return __extends(t,n),t.prototype.initializeObjects=function(){var n=new createjs.Container,u=gameui.AssetsManager.getBitmap("time_bar"),t=gameui.AssetsManager.getBitmap("time_bar_bright"),r=gameui.AssetsManager.getBitmap("time_bar_red"),i;t.alpha=0;this.redFx=r;this.brightFx=t;createjs.Tween.get(this.redFx,{loop:!0}).to({alpha:0},500);n.addChild(u);this.addChild(r);n.addChild(t);this.addChild(n);i=new createjs.Shape;i.graphics.beginFill("red").drawRect(0,0,991,35);this.percentBarMask=i;n.mask=this.percentBarMask},t.prototype.setPercent=function(n,t){this.value<n&&this.incrasePercent();this.value=n;createjs.Tween.removeTweens(this.percentBarMask);createjs.Tween.get(this.percentBarMask).to({scaleX:n},200,createjs.Ease.quadInOut);t?this.setAlarmOn():this.setAlarmOff()},t.prototype.incrasePercent=function(){this.brightFx.alpha=1;createjs.Tween.get(this.brightFx).to({alpha:0},300)},t.prototype.setAlarmOn=function(){this.redFx.visible=!0},t.prototype.setAlarmOff=function(){this.redFx.visible=!1},t}(createjs.Container);n.TimeBar=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(i){var r=function(n){function i(){n.call(this,StringResources.menus.gameOver.toUpperCase(),1250);this.addPoints();this.addLastJelly();this.addButtons()}return __extends(i,n),i.prototype.addButtons=function(){var r=new gameui.ImageButton("BtBoard",function(){this.dispatchEvent("board")}),n,t,i;r.set({x:defaultWidth/2,y:1780});this.addChild(r);n=new gameui.ImageButton("BtShare",function(){this.dispatchEvent("share")});n.set({x:1240,y:1020});this.addChild(n);t=new gameui.ImageButton("BtHome",function(){this.dispatchEvent("ok")});t.set({x:353,y:1780});this.addChild(t);i=new gameui.ImageButton("BtRestart",function(){this.dispatchEvent("restart")});i.set({x:1190,y:1780});this.addChild(i)},i.prototype.addPoints=function(){var t=new createjs.Container,i=gameui.AssetsManager.getBitmap("GameOverBgPoints"),n;return i.set({x:defaultWidth/2,y:565,regX:528}),t.addChild(i),n=gameui.AssetsManager.getBitmapText("","debussyBig"),n.set({x:defaultWidth/2,y:630}),t.addChild(n),this.scoreText=n,n=gameui.AssetsManager.getBitmapText("","debussy"),n.set({x:300,y:775}),n.scaleX=n.scaleY=.8,t.addChild(n),this.highScoreText=n,t.y+=260,this.addChild(t),t},i.prototype.addLastJelly=function(){var i=new createjs.Container,u,r,n;return this.addChild(i),u=gameui.AssetsManager.getBitmap("GameOverBgJelly"),u.set({x:defaultWidth/2,y:951,regX:797/2}),i.addChild(u),n=gameui.AssetsManager.getBitmapText(StringResources.menus.highJelly,"debussy"),n.set({x:420,y:820}),n.scaleX=n.scaleY=.5,r=new t.view.Jelly,i.addChild(r),this.addChild(i),r.scaleX=r.scaleY=1,r.set({x:defaultWidth/2,y:1350}),this.jelly=r,n=gameui.AssetsManager.getBitmapText("1","debussy"),n.set({x:defaultWidth/2,y:1358}),n.scaleX=n.scaleY=.9,this.jellyText=n,i.addChild(n),i.y+=200,i},i.prototype.setValues=function(n,t,i,r){var u,f;t>JoinJelly.maxJelly&&(t=JoinJelly.maxJelly);r&&this.setTitle(r);u={value:0};createjs.Tween.get(u).to({value:1},3e3,createjs.Ease.quadOut);f=setInterval(function(){this.scoreText.text=Math.floor(u.value*n).toString();this.scoreText.regX=this.scoreText.getBounds().width/2;u.value>=1&&clearInterval(f)},30);this.highScoreText.text=StringResources.menus.highScore+": "+t.toString();this.jelly.setNumber(i);this.jellyText.text=StringResources.jellies[i].name;this.jellyText.getBounds()&&(this.jellyText.regX=this.jellyText.getBounds().width/2)},i}(n.menus.view.FlyOutMenu);i.FinishMenu=r})(i=t.view||(t.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.fingerUp=gameui.AssetsManager.getBitmap("tutorialFinger");this.fingerDown=gameui.AssetsManager.getBitmap("tutorialFingerDown");this.addChild(this.fingerUp);this.addChild(this.fingerDown);this.fingerDown.y=this.fingerUp.image.height-this.fingerDown.image.height;this.regX=80;this.mouseEnabled=!1;this.visible=!1}return __extends(t,n),t.prototype.showMove=function(n,t,i,r){this.visible=!0;this.x=n;this.y=t;this.alpha=0;this.fu();createjs.Tween.removeTweens(this);createjs.Tween.get(this,{loop:!0}).to({alpha:1},500).call(function(){this.fd()}).to({x:i,y:r},1600,createjs.Ease.quadInOut).call(function(){this.fu()}).to({alpha:0},500)},t.prototype.showClick=function(n,t){this.visible=!0;this.x=n;this.y=t;this.alpha=1;this.fu();createjs.Tween.removeTweens(this);createjs.Tween.get(this,{loop:!0}).wait(500).call(function(){this.fd()}).wait(1e3).call(function(){this.fu()})},t.prototype.fd=function(){this.fingerDown.visible=!0;this.fingerUp.visible=!1},t.prototype.fu=function(){this.fingerDown.visible=!1;this.fingerUp.visible=!0},t.prototype.hide=function(){createjs.Tween.removeTweens(this);this.visible=!1},t}(createjs.Container);n.TutorialMove=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.addChild(gameui.AssetsManager.getBitmap("ballon"));this.visible=!1;this.regX=316;this.regY=366;this.x=164+this.regX;this.y=941+this.regY;var t=gameui.AssetsManager.getBitmapText("","debussy");this.addChild(t);t.scaleX=t.scaleY=.8;t.x=50;t.y=50;this.bitmapText=t;t.mouseEnabled=!1;this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(-this.x+this.regX,-this.y+this.regY,defaultWidth,defaultHeight));this.addEventListener("click",function(){this.fadeOut();this.dispatchEvent("closed");gameui.AudiosManager.playSound("Interface Sound-15")})}return __extends(t,n),t.prototype.show=function(n){this.bitmapText.text=n;this.fadeIn();gameui.AudiosManager.playSound("Interface Sound-14")},t}(gameui.Button);n.TutoralMessage=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(t,i,r,u){n.call(this);this.touchDictionary=[];this.alarming=!1;this.tiles=[];this.boardHeight=i;this.boardWidth=t;this.tileSize=r;this.tilesContainer=new createjs.Container;this.addChild(this.tilesContainer);this.tilesContainer.hitArea=new createjs.Shape((new createjs.Graphics).f("red").r(0,0,t*r,(i+.5)*r));this.addTiles(t,i,r,u);this.addMouseEvents(r);this.regX=t*r/2;this.regY=i*r/2}return __extends(t,n),t.prototype.addTiles=function(n,t,i){for(var u,r=0;r<n;r++)for(u=0;u<t;u++)this.addTile(r,u,i)},t.prototype.addTile=function(n,t,i){var u=gameui.AssetsManager.getBitmap("hex"),r;this.tilesContainer.addChild(u);u.regX=179;u.regY=0;u.alpha=.15;u.set(this.getTilePositionByCoords(n,t,i,0));r=new Tile(n,t,i);this.tiles.push(r);this.tilesContainer.addChild(r);r.setNumber(0);r.name=(this.boardWidth*t+n).toString();r.set(this.getTilePositionByCoords(n,t,i))},t.prototype.addMouseEvents=function(n){var t=[];this.tilesContainer.addEventListener("mousedown",function(i){var r=this.getTileByRawPos(i.localX,i.localY,n);r&&r.isUnlocked()&&r.isEnabled()&&(r.lock(),this.touchDictionary[i.pointerID]=r,t[i.pointerID]={x:r.x-i.localX,y:r.y-i.localY},r.drag(),this.tilesContainer.setChildIndex(r,this.tilesContainer.getNumChildren()-1),gameui.AudiosManager.playSound("soundh_1"))});this.tilesContainer.addEventListener("pressmove",function(i){var r=this.touchDictionary[i.pointerID],u,e,f;r&&(r.x=i.localX+t[i.pointerID].x,r.y=i.localY+t[i.pointerID].y,r.lock(),u=this.getTileByRawPos(i.localX,i.localY,n),u&&u.name.toString()!=r.name&&u.isUnlocked()&&(e={origin:r,target:u},f=new createjs.Event("dragging",!1,!1),f.originTile=r,f.targetTile=u,this.dispatchEvent(f)))});this.tilesContainer.addEventListener("pressup",function(n){var t=this.touchDictionary[n.pointerID];t&&(t.unlock,this.releaseDrag(t,!1),t.release())})},t.prototype.setTiles=function(n){this.unlock();for(var t in n)this.setTileValue(t,n[t]),this.getTileById(t).unlock(),this.getTileById(t).enable()},t.prototype.setTileValue=function(n,t){var i=this.getTileById(n);i&&i.setNumber(t);t==1&&gameui.AudiosManager.playSound("sound_s"+(Math.floor(Math.random()*3)+1),null,400)},t.prototype.getTileIdByPos=function(n,t,i){var r=this.getTileCoordsByRawPos(n,t,i);return this.boardWidth*r.y+r.x},t.prototype.getTileByRawPos=function(n,t,i){var r=this.getTileIdByPos(n,t,i);return this.getTileById(r)},t.prototype.getTileCoordsByRawPos=function(n,t,i){var r=Math.floor(n/i),u=r==1||r==3?i/2:0,f=Math.floor((t-u)/i);return{x:r,y:f}},t.prototype.getTileByIndex=function(n,t){var i=this.boardWidth*t+n;return this.getTileById(i)},t.prototype.getTilePositionByCoords=function(n,t,i,r){r===void 0&&(r=1);var u=n==1||n==3?i/2:0;return{x:(n+1/2)*i+r*(Math.random()-.5)*i/10,y:(t+1/2)*i+r*(Math.random()-.5)*i/10+u-i/5}},t.prototype.getTileById=function(n){return this.tilesContainer.getChildByName(n.toString())},t.prototype.releaseAll=function(){for(var n in this.touchDictionary)this.releaseDrag(this.touchDictionary[n])},t.prototype.sumAllTiles=function(){var n=0;for(var t in this.tiles)n+=this.tiles[t].getNumber();return n},t.prototype.getEmptyTiles=function(){for(var i=this.boardHeight*this.boardWidth,t=[],n=0;n<i;n++)this.tiles[n].isEmpty()&&t.push(this.tiles[n]);return t},t.prototype.getLockedNotDraggingTiles=function(){for(var i=this.boardHeight*this.boardWidth,t=[],n=0;n<i;n++)this.tiles[n].isUnlocked()||this.tiles[n].isDragging()||t.push(this.tiles[n]);return t},t.prototype.getAllTiles=function(){return this.tiles},t.prototype.getAllTilesValues=function(){for(var t=[],n=0;n<this.boardHeight*this.boardWidth;n++)t[n]=this.getTileById(n).getNumber();return t},t.prototype.getTileId=function(n){return parseInt(n.name)},t.prototype.getNeighborTiles=function(n){var r=[],f=this.getTileId(n),u=n.posx==1||n.posx==3?1:-1,t=[{x:n.posx,y:n.posy-1},{x:n.posx,y:n.posy+1},{x:n.posx-1,y:n.posy},{x:n.posx+1,y:n.posy},{x:n.posx-1,y:n.posy+u},{x:n.posx+1,y:n.posy+u},];for(var i in t)t[i].x>=0&&t[i].y>=0&&t[i].x<this.boardWidth&&t[i].y<this.boardHeight&&r.push(this.getTileByIndex(t[i].x,t[i].y));return r},t.prototype.getPercentEmptySpaces=function(){var n=this.boardHeight*this.boardWidth,t=this.getEmptyTiles().length;return t/n},t.prototype.releaseDrag=function(n,t,i){var u,r;t===void 0&&(t=!0);u=this.touchDictionary.indexOf(n);delete this.touchDictionary[u];createjs.Tween.removeTweens(n);n.scaleY=n.scaleX=1;t&&i?(r=this.getTilePositionByCoords(i.posx,i.posy,this.tileSize),this.fadeTileToPos(n,r.x,r.y)):(n.release(),createjs.Tween.get(n).to(this.getTilePositionByCoords(n.posx,n.posy,this.tileSize),200,createjs.Ease.sineInOut).call(function(){this.arrangeZOrder();n.unlock()}))},t.prototype.getHighestTileValue=function(){var n=0;for(var t in this.tiles)this.tiles[t].getNumber()>n&&(n=this.tiles[t].getNumber());return n},t.prototype.lock=function(){this.tilesContainer.mouseEnabled=!1},t.prototype.unlock=function(){this.tilesContainer.mouseEnabled=!0},t.prototype.arrangeZOrder=function(){for(var n=0;n<this.tiles.length;n++)this.tilesContainer.setChildIndex(this.tiles[n],this.tilesContainer.getNumChildren()-1)},t.prototype.match=function(n,t){this.releaseDrag(n,!0,t);t.set({scaleX:1.8,scaleY:1.8,alpha:0});createjs.Tween.get(t).to({scaleX:1,scaleY:1,alpha:1},140,createjs.Ease.cubicOut);gameui.AudiosManager.playSound("sound_j"+(Math.floor(Math.random()*4)+1))},t.prototype.cleanBoard=function(){for(var n in this.tiles)this.tiles[n].setNumber(0)},t.prototype.fadeTileToPos=function(n,t,i,r,u,f){r===void 0&&(r=100);u===void 0&&(u=0);f===void 0&&(f=0);n.lock();createjs.Tween.get(n).wait(u).to({x:t,y:i,alpha:f},r,createjs.Ease.quadInOut).call(function(){n.set(this.getTilePositionByCoords(n.posx,n.posy,this.tileSize));this.arrangeZOrder();n.unlock();n.alpha=1})},t.prototype.levelUpEffect=function(){var n=0;for(var t in this.tiles)setTimeout(function(){var i=this.boardHeight*this.boardWidth-(n%this.boardWidth*this.boardWidth+Math.floor(n/this.boardWidth))-1,t=this.tiles[i];createjs.Tween.get(t).to({scaleY:1.5},100).to({scaleY:1},100);t.jelly.playLevelUp();n++},20*t)},t.prototype.endGameEffect=function(){var n=0;for(var t in this.tiles)setTimeout(function(){n++;var i=n%this.boardWidth*this.boardWidth+Math.floor(n/this.boardWidth),t=this.tiles[i];createjs.Tween.get(t).to({scaleY:.5},100).to({scaleY:1},100);t.jelly.playLevelUp()},20*t)},t.prototype.setAlarm=function(n){if(n){if(this.alarming)return;createjs.Tween.get(this.tilesContainer,{loop:!0}).to({x:-10},50).to({x:10},100).to({x:-10},100).to({x:0},50).wait(200)}else{if(!this.alarming)return;createjs.Tween.removeTweens(this.tilesContainer)}this.alarming=n},t}(createjs.Container);n.Board=t})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(t,i,r){n.call(this);this.tileSize=r;this.posx=t;this.posy=i;this.regX=this.regY=r/2;this.jelly=new view.Jelly;this.jelly.x=r/2;this.jelly.y=r;this.jelly.scaleX=this.jelly.scaleY=this.tileSize/450;this.addChild(this.jelly);this.hitArea=new createjs.Shape((new createjs.Graphics).beginFill("000").drawRect(0,0,r,r))}return __extends(t,n),t.prototype.release=function(){this.jelly.executeAimationRelease();this.unlock();this.dragging=!1},t.prototype.drag=function(){this.jelly.executeAnimationHold();this.dragging=!0},t.prototype.isUnlocked=function(){return!this.locked},t.prototype.isDragging=function(){return this.dragging},t.prototype.lock=function(){this.locked=!0},t.prototype.unlock=function(){this.locked=!1;this.dragging=!1;this.jelly.setNumber(this.value)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.isEnabled=function(){return this.enabled},t.prototype.setNumber=function(n){n>JoinJelly.maxJelly&&(n=JoinJelly.maxJelly);this.value=n;n>0?this.enable():this.disable();this.isUnlocked()&&this.jelly.setNumber(n)},t.prototype.getNumber=function(){return this.value},t.prototype.isEmpty=function(){return this.value==0},t}(createjs.Container);n.Tile=t})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var r=function(t){function r(n){t.call(this);this.matches=0;this.userData=n;this.score=0;this.createBackground();this.createBoard();this.createGUI();this.createEffects();this.start();this.loadGame();JoinJelly.userData.getHistory("firstPlay")||(JoinJelly.itemData.setItemAmmount(Items.REVIVE,1),JoinJelly.itemData.setItemAmmount(Items.TIME,2),JoinJelly.itemData.setItemAmmount(Items.FAST,2),JoinJelly.itemData.setItemAmmount(Items.CLEAN,2),JoinJelly.itemData.setItemAmmount(Items.LUCKY,0));JoinJelly.userData.history("firstPlay")}return __extends(r,t),r.prototype.createEffects=function(){this.freezeEffect=gameui.AssetsManager.getBitmap("freezeEffect");this.content.addChild(this.freezeEffect);this.normalizeEffect(this.freezeEffect);this.evolveEffect=gameui.AssetsManager.getBitmap("fxEvolve");this.content.addChild(this.evolveEffect);this.evolveEffect.regX=150;this.normalizeEffect(this.evolveEffect);this.reviveEffect=gameui.AssetsManager.getBitmap("reviveEffect");this.content.addChild(this.reviveEffect);this.normalizeEffect(this.reviveEffect);this.cleanEffect=gameui.AssetsManager.getBitmap("cleanEffect");this.content.addChild(this.cleanEffect);this.normalizeEffect(this.cleanEffect)},r.prototype.normalizeEffect=function(n){n.visible=!1;n.y=JoinJelly.gameScreen.headerPosition;n.scaleX=2;n.scaleY=2*JoinJelly.gameScreen.currentHeight/defaultHeight;n.mouseEnabled=!1},r.prototype.createBackground=function(){var n=gameui.AssetsManager.getBitmap("Background");this.background.addChild(n)},r.prototype.createBoard=function(){this.board=new Board(boardSize,boardSize,1536/5,!0);this.board.addEventListener("dragging",function(n){this.dragged(n.originTile,n.targetTile)});this.content.addChild(this.board);this.board.x=defaultWidth/2;this.board.y=defaultHeight/2},r.prototype.createGUI=function(){var r,t;this.gameLevelIndicator=new view.LevelIndicator;this.content.addChild(this.gameLevelIndicator);this.gameHeader=new view.GameHeader;this.header.addChild(this.gameHeader);r=[Items.TIME,Items.CLEAN,Items.FAST];this.gameFooter=new view.ItemsFooter(r);this.gameFooter.lockItem(Items.REVIVE);this.footer.addChild(this.gameFooter);this.updateFooter();this.gameFooter.addEventListener("useitem",function(n){this.useItem(n.item)});this.pauseMenu=new view.PauseMenu;this.overlay.addChild(this.pauseMenu);this.finishMenu=new view.FinishMenu;this.overlay.addChild(this.finishMenu);this.finishMenu.y=-200;this.gameMessage=new view.TutoralMessage;this.content.addChild(this.gameMessage);this.countDown=new view.CountDown;this.content.addChild(this.countDown);this.countDown.x=defaultWidth/2;this.countDown.y=defaultHeight/2;t=new gameui.ImageButton("BtBoard",function(){this.finishMenu.show();this.gameHeader.hide();t.fadeOut();gameui.AudiosManager.playSound("Interface Sound-06")});t.set({x:150,y:-150,visible:!1});this.footer.addChild(t);this.showBoardButton=t;this.finishMenu.addEventListener("restart",function(){this.pauseMenu.hide();this.userData.deleteSaveGame();setTimeout(function(){n.JoinJelly.startLevel()},200)});this.finishMenu.addEventListener("ok",function(){JoinJelly.showMainMenu()});this.finishMenu.addEventListener("board",function(){this.finishMenu.hide();this.gameHeader.show();t.fadeIn()});this.finishMenu.addEventListener("share",function(){var n,t,i,r;alert("share");n=Cocoon.Social.Facebook;n.init({appId:fbAppId});t=n.getSocialInterface();alert("share");i=new Cocoon.Social.Message(StringResources.social.shareDescription,gameWebsiteIcon,gameWebsite,StringResources.social.shareTitle+" - "+this.score+" "+StringResources.menus.score,StringResources.social.shareCaption);r=this;t.publishMessageWithDialog(i,function(n){console.log("shared "+JSON.stringify(n));var t=!0;n&&(t=!1);t&&alert("K")})});this.gameHeader.addEventListener("pause",function(){this.pauseGame()});this.pauseMenu.addEventListener("play",function(){this.continueGame()});this.pauseMenu.addEventListener("test",function(){this.selfPeformanceTest(!1)});this.pauseMenu.addEventListener("testFast",function(){this.selfPeformanceTest(!0)});this.pauseMenu.addEventListener("home",function(){this.pauseMenu.hide();setTimeout(function(){n.JoinJelly.showMainMenu()},200)});this.pauseMenu.addEventListener("restart",function(){this.pauseMenu.hide();this.userData.deleteSaveGame();setTimeout(function(){n.JoinJelly.startLevel()},200)});this.onback=function(){this.gamestate==i.paused?this.continueGame():this.gamestate==i.playing&&this.pauseGame()}},r.prototype.redim=function(n,i,r,u){t.redim.call(this,n,i,r,u);var f=(this.screenHeight-2048)/400;f<0&&(f=0);f>1&&(f=1);this.board.scaleX=this.board.scaleY=1-(.2-f*.2)},r.prototype.activate=function(n){t.activate.call(this,n);this.gameHeader.show();this.updateFooter()},r.prototype.updateInterfaceInfos=function(){var r=this.getMovesByLevel(this.level),i=this.getMovesByLevel(this.level-1),u=(this.matches-i)/(r-i)*100,n=this.board.getPercentEmptySpaces(),t=!1;n<.15&&n>0&&(t=!0);this.gameHeader.updateStatus(this.score,this.level,u,n,t);this.board.setAlarm(t)},r.prototype.levelUpInterfaceEffect=function(n){this.gameLevelIndicator.showLevel(n);gameui.AudiosManager.playSound("levelUp");this.board.levelUpEffect()},r.prototype.start=function(){this.level=1;this.matches=0;this.time=Date.now();this.highJelly=0;this.board.cleanBoard();this.board.unlock();this.updateInterfaceInfos();gameui.AudiosManager.playMusic("music1");this.gamestate=i.playing;this.step(500);JoinJelly.analytics.logGameStart();this.highJellySave(1)},r.prototype.step=function(n){clearTimeout(timeoutInterval);timeoutInterval=setTimeout(function(){this.gamestate==i.playing&&this.gameInteraction();this.gamestate!=i.ended&&this.step(this.getTimeInterval(this.level,initialInterval,finalInterval,easeInterval))},n)},r.prototype.gameInteraction=function(){this.verifyGameLoose()&&this.endGame();this.addRandomJellyOnBoard(1);this.updateInterfaceInfos();this.updateCurrentLevel()},r.prototype.pauseGame=function(){this.gamestate!=i.standBy&&this.gamestate!=i.ended&&(this.pauseMenu.show(),this.gamestate=i.paused,this.board.lock(),this.gameFooter.lockAll(),this.gameHeader.mouseEnabled=!1,this.content.mouseEnabled=!1)},r.prototype.continueGame=function(){this.pauseMenu.hide();this.gamestate=i.standBy;setTimeout(function(){this.gamestate=i.playing;this.board.unlock();this.gameHeader.mouseEnabled=!0;this.content.mouseEnabled=!0;this.gameFooter.unlockAll()},3200);this.countDown.countDown(3)},r.prototype.winGame=function(){this.endGame(StringResources.menus.gameOver,!0);this.gameFooter.visible=!1},r.prototype.endGame=function(n,t){this.view.setChildIndex(this.footer,this.view.getNumChildren()-1);this.gamestate=i.standBy;var r=this.score,f=JoinJelly.userData.getHighScore(),u=this.board.getHighestTileValue();this.pauseMenu.hide();this.board.lock();this.board.setAlarm(!1);this.board.releaseAll();this.gameHeader.mouseEnabled=!1;this.gameFooter.mouseEnabled=!1;this.gameHeader.hide();this.gameHeader.hidePauseButton();createjs.Tween.get(this.gameFooter).to({y:300},200,createjs.Ease.quadIn);setTimeout(function(){this.gamestate=t?i.win:i.ended;this.finishMenu.show();this.gameFooter.mouseEnabled=!0;this.gameFooter.setItems([Items.REVIVE]);this.gameFooter.unlockItem(Items.REVIVE);this.gameFooter.highlight(Items.REVIVE);this.updateFooter();createjs.Tween.get(this.gameFooter).to({y:0},200,createjs.Ease.quadIn);JoinJelly.userData.setScore(Math.max(r,JoinJelly.userData.getHighScore()));JoinJelly.gameServices.submitScore(Math.max(r,JoinJelly.userData.getHighScore()))},1200);this.finishMenu.setValues(r,Math.max(f,r),u,n);t?JoinJelly.analytics.logWinGame(this.level,u,this.matches,Date.now()-this.time):JoinJelly.analytics.logEndGame(this.level,u,this.matches,Date.now()-this.time);gameui.AudiosManager.playSound("end");this.board.endGameEffect()},r.prototype.updateCurrentLevel=function(){var n=this.getLevelByMoves(this.matches);n>this.level&&(this.level=n,this.levelUpInterfaceEffect(n),this.updateInterfaceInfos(),this.levelUpBonus());this.level=n},r.prototype.levelUpBonus=function(){this.useEvolve();this.cleanAllDirty()},r.prototype.getLevelByMoves=function(n){for(var i=0,t=0,r,u;i<n;)r=this.getTimeInterval(t,initialInterval,finalInterval,easeInterval),u=timeByLevel/r,i+=u,t++;return Math.max(t,1)},r.prototype.getMovesByLevel=function(n){for(var r,u,i=0,t=0;t<n;t++)r=this.getTimeInterval(t,initialInterval,finalInterval,easeInterval),u=timeByLevel/r,i+=u;return i},r.prototype.getTimeInterval=function(n,t,i,r){return t*Math.pow(r,n)+i*(1-Math.pow(r,n))},r.prototype.verifyGameLoose=function(){var n=this.board.getEmptyTiles(),t=this.board.getLockedNotDraggingTiles();return n.length==0&&t.length==0?!0:!1},r.prototype.addRandomJellyOnBoard=function(n){for(var t=10;t<this.level;t+=10)Math.random()>.9&&(n*=2);n>JoinJelly.maxJelly&&(n=JoinJelly.maxJelly);this.addRandomTileOnBoard(n);this.addRandomDirtyOnBoard();this.saveGame()},r.prototype.addRandomDirtyOnBoard=function(){this.getDirtyProbabilityByLevel(this.level,initialDirtyProbability,finalDirtyProbability,easeDirtyProbability)>Math.random()&&setTimeout(function(){this.addRandomTileOnBoard(-1)},500)},r.prototype.addRandomTileOnBoard=function(n){var t=this.board.getEmptyTiles(),i,r;t.length>0&&(i=Math.floor(Math.random()*t.length),r=t[i],r.setNumber(n))},r.prototype.cleanAllDirty=function(){var n=this.board.getAllTiles();for(var t in n)n[t].getNumber()<0&&n[t].setNumber(0)},r.prototype.getDirtyProbabilityByLevel=function(n,t,i,r){return t*Math.pow(r,n)+i*(1-Math.pow(r,n))},r.prototype.dragged=function(n,t){this.match(n,t)},r.prototype.canMatch=function(n,t){return n.getNumber()!=0&&t!=n&&t.getNumber()==n.getNumber()&&t.isUnlocked()},r.prototype.canMove=function(){var i=this.board.getAllTiles(),f=this.board.getEmptyTiles().length,n={},r,t,u;for(r in i)t=i[r].getNumber(),t>0&&!n[t]&&(n[t]=0),n[t]++;for(u in n)if(n[u]>1)return!0;return!1},r.prototype.match=function(n,t){var i=t.getNumber()+n.getNumber(),r,u;return this.canMatch(n,t)?(this.matches++,this.board.match(n,t),r=i*10+Math.floor(Math.random()*i*10),this.score+=r,this.animateScoreFromTile(t,r),n.setNumber(0),u=this.giveItemChance([Items.CLEAN,Items.REVIVE,Items.TIME,Items.FAST]),u&&this.animateItemFromTile(t,u),this.userData&&this.userData.setLastJelly(i),this.updateInterfaceInfos(),this.matchNotify&&this.matchNotify(),this.highJellySave(i),i>JoinJelly.maxJelly?this.winGame():t.setNumber(i),this.updateCurrentLevel(),this.saveGame(),this.canMove()||this.step(0),this.cleanNearDirty(t),!0):!1},r.prototype.cleanNearDirty=function(n){var i=this.board.getNeighborTiles(n),r,t,u,f;for(r in i)t=i[r],t&&t.getNumber()<0&&(u=n.x+(t.x-n.x)*1.5,f=n.y+(t.y-n.y)*1.5,this.board.fadeTileToPos(t,u,f,500),t.setNumber(0))},r.prototype.highJellySave=function(t){if(this.highJelly<t){n.JoinJelly.analytics.logNewJelly(t,this.level,Date.now()-this.time);try{JoinJelly.gameServices.submitJellyAchievent(t)}catch(i){console.log(i)}this.highJelly=t}},r.prototype.giveItemChance=function(n){var t=null,i=JoinJelly.itemData.getItemAmmount(Items.LUCKY)?2:1,r=Math.random()<itemProbability*i;return r&&(t=n[Math.floor(Math.random()*n.length)],JoinJelly.itemData.increaseItemAmmount(t)),t},r.prototype.animateItemFromTile=function(n,t){var i;gameui.AudiosManager.playSound("Interface Sound-11");i=gameui.AssetsManager.getBitmap("item"+t);i.mouseEnabled=!1;i.regX=i.getBounds().width/2;i.regY=i.getBounds().height/2;i.scaleY=i.scaleX=.5;var e=this.board.localToLocal(n.x,n.y,this.content).x,o=this.board.localToLocal(n.x,n.y,this.content).y,u=defaultWidth/2,f=this.footer.y,r=this.gameFooter.getItemButton(t);r&&(u=this.gameFooter.localToLocal(r.x,r.y,this.content).x,f=this.gameFooter.localToLocal(r.x,r.y,this.content).y);i.alpha=0;createjs.Tween.get(i).to({x:e,y:o,alpha:0}).to({y:n.y-70,alpha:1},400,createjs.Ease.quadInOut).to({x:u,y:f},1e3,createjs.Ease.quadInOut).call(function(){this.content.removeChild(i);this.updateFooter()});this.content.addChild(i)},r.prototype.animateScoreFromTile=function(n,t){var i=gameui.AssetsManager.getBitmapText(t.toString(),"debussy"),u,r;i.regX=i.getBounds().width/2;i.mouseEnabled=!1;u=this.board.localToLocal(n.x,n.y,this.content).x;r=this.board.localToLocal(n.x,n.y,this.content).y;i.alpha=0;createjs.Tween.get(i).to({x:u,y:r,alpha:0}).to({y:r-170,alpha:1},400,createjs.Ease.quadOut).to({alpha:0},400).call(function(){this.content.removeChild(i)});this.content.addChild(i)},r.prototype.useItem=function(t){if(JoinJelly.itemData.getItemAmmount(t)>0){var i=!1;switch(t){case Items.TIME:i=this.useTime();break;case Items.FAST:i=this.useFast();break;case Items.CLEAN:i=this.useClean();break;case Items.REVIVE:i=this.useRevive();break;case Items.EVOLVE:i=this.useEvolve()}i&&(JoinJelly.itemData.decreaseItemAmmount(t),this.itemNotify&&this.itemNotify())}else this.pauseGame(),n.JoinJelly.showStore(this);this.updateFooter()},r.prototype.useTime=function(){if(this.gamestate!=i.ended)return this.step(4e3),this.gameFooter.lockItem(Items.TIME),this.freezeEffect.alpha=0,this.freezeEffect.visible=!0,createjs.Tween.removeTweens(this.freezeEffect),createjs.Tween.get(this.freezeEffect).to({alpha:1},1e3).to({alpha:0},4e3).call(function(){this.freezeEffect.visible=!1;this.gameFooter.unlockItem(Items.TIME)}),gameui.AudiosManager.playSound("sounditemtime"),!0},r.prototype.useClean=function(){var n,t;if(this.gamestate!=i.ended){n=this.board.getAllTiles();for(t in n)n[t].getNumber()<2&&(this.board.fadeTileToPos(n[t],n[t].x,n[t].y-100,200,300*Math.random()),n[t].setNumber(0));return this.updateInterfaceInfos(),this.cleanEffect.alpha=0,this.cleanEffect.visible=!0,createjs.Tween.removeTweens(this.cleanEffect),createjs.Tween.get(this.cleanEffect).to({alpha:0},200).to({alpha:1},200).to({alpha:0},200),createjs.Tween.get(this.cleanEffect).to({x:-600,y:2e3}).to({x:300,y:-500},600).call(function(){this.cleanEffect.visible=!1}),gameui.AudiosManager.playSound("sounditemclean"),!0}},r.prototype.useRevive=function(n){return(n===void 0&&(n=!1),this.gamestate!=i.ended)?!1:(UserData.getHistoryRevive(),this.saveGame(),this.gamestate=i.playing,this.board.unlock(),this.finishMenu.hide(),this.step(4e3),this.updateInterfaceInfos(),this.board.setAlarm(!0),this.showBoardButton.fadeOut(),this.gameFooter.setItems([Items.TIME,Items.CLEAN,Items.FAST]),this.gameFooter.unlockAll(),this.gameFooter.lockItem(Items.REVIVE),this.gameHeader.mouseEnabled=!0,this.gameHeader.show(),this.gameHeader.showPauseButton(),n||(this.reviveEffect.alpha=0,this.reviveEffect.visible=!0,createjs.Tween.removeTweens(this.reviveEffect),createjs.Tween.get(this.reviveEffect).to({y:1200}).to({y:600,alpha:1},600).to({y:0,alpha:0},600).call(function(){this.reviveEffect.visible=!1}),gameui.AudiosManager.playSound("sounditemrevive")),!0)},r.prototype.useEvolve=function(){var n,e,r,t,o,u,h,c;if(this.gamestate!=i.ended){n=this.board.getAllTiles();e=0;for(t in n)n[t].getNumber()>e&&(e=n[t].getNumber());r=[];for(t in n)n[t].getNumber()<e&&n[t].getNumber()>2&&n[t].isUnlocked()&&r.push(n[t]);if(r.length==0)for(t in n)n[t].getNumber()<e&&n[t].getNumber()>1&&n[t].isUnlocked()&&r.push(n[t]);if(r.length==0)for(t in n)n[t].getNumber()>1&&n[t].isUnlocked()&&r.push(n[t]);if(r.length==0)for(t in n)n[t].getNumber()>0&&n[t].isUnlocked()&&r.push(n[t]);if(r.length==0)return!1;var l=Math.floor(Math.random()*r.length),f=r[l],s=f.getNumber()*2;return f.lock(),f.setNumber(s),this.highJellySave(s),f.jelly.playThunder(),setTimeout(function(){f.unlock();gameui.AudiosManager.playSound("evolve")},1e3),gameui.AudiosManager.playSound("sounditemfast"),o=f.jelly.localToLocal(0,0,this.evolveEffect.parent),u=this.gameHeader.localToLocal(1394,211,this.evolveEffect.parent),this.evolveEffect.visible=!0,this.evolveEffect.set({alpha:1,scaleX:.5,x:u.x,y:u.y}),h=Math.atan2(o.y-u.y-50,o.x-u.x)*180/Math.PI-90,c=Math.sqrt(Math.pow(o.y-50-u.y,2)+Math.pow(o.x-u.x,2))/300,this.evolveEffect.rotation=h,this.evolveEffect.scaleY=0,createjs.Tween.removeTweens(this.evolveEffect),createjs.Tween.get(this.evolveEffect).to({scaleY:c},200),createjs.Tween.get(this.evolveEffect).to({alpha:0},1200,createjs.Ease.quadIn).call(function(){this.evolveEffect.visible=!1}),!0}},r.prototype.useFast=function(n){var u,t,o,r,s,f,e;if(n===void 0&&(n=!1),this.gamestate!=i.ended){u=this.board.getAllTiles();t=[];for(o in u){if(t.length>=5)break;if(r=u[o],r.getNumber()>0&&r.isUnlocked())for(s in u)if(f=u[s],this.canMatch(r,f)){r.lock();f.lock();t.push([r,f]);break}}for(e in t)this.matchJelly(t[e][0],t[e][1]);return!0}},r.prototype.matchJelly=function(n,t){t.lock();n.lock();this.board.fadeTileToPos(n,t.x,t.y,400,200*Math.random(),1);setTimeout(function(){t.unlock();n.unlock();this.match(n,t)},300)},r.prototype.updateFooter=function(){var n=ItemsData.items;for(var t in n)this.gameFooter.setItemAmmount(n[t],JoinJelly.itemData.getItemAmmount(n[t]))},r.prototype.saveGame=function(){var n={level:this.level,matches:this.matches,score:this.score,tiles:this.board.getAllTilesValues()};this.userData.saveGame(n)},r.prototype.loadGame=function(){if(this.userData){var n=this.userData.loadGame();n&&n!=null&&(this.board.setTiles(n.tiles),this.score=n.score,this.matches=n.matches,this.level=n.level,this.updateCurrentLevel(),this.updateFooter(),this.updateInterfaceInfos(),this.verifyGameLoose()?this.endGame():this.continueGame())}},r.prototype.selfPeformanceTest=function(n){n&&(initialInterval=200);var t=setInterval(function(){this.gamestate!=i.paused&&(this.useRevive(),this.useFast(!0),this.gamestate==i.win&&(clearInterval(t),JoinJelly.startTest()))},250)},r}(gameui.ScreenState),i;t.GamePlayScreen=r,function(n){n[n.starting=0]="starting";n[n.playing=1]="playing";n[n.paused=2]="paused";n[n.ended=3]="ended";n[n.standBy=4]="standBy";n[n.win=5]="win"}(i||(i={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.call(this,null);this.currentTutorialStep=0}return __extends(t,n),t.prototype.createGUI=function(){n.createGUI.call(this);this.tutorialJellyFinger=new view.TutorialMove;this.tutorialItemFinger=new view.TutorialMove;this.gameMessage.addEventListener("closed",function(){this.messageNotify&&this.messageNotify()});this.tutorialItemFinger.rotation=-45;this.content.addChild(this.tutorialJellyFinger);this.footer.addChild(this.tutorialItemFinger);this.gameFooter.setItemAmmount(Items.REVIVE,1);this.gameFooter.setItemAmmount(Items.FAST,1);this.gameFooter.setItemAmmount(Items.CLEAN,1);this.gameFooter.setItemAmmount(Items.TIME,1);this.gameFooter.lockAll()},t.prototype.start=function(){n.start.call(this);this.resetTutorialStep();this.executeTutorialStep()},t.prototype.step=function(){},t.prototype.resetTutorialStep=function(){this.currentTutorialStep=-1},t.prototype.executeTutorialStep=function(){this.currentTutorialStep++;var n=[function(){this.tutorialWait(1500);this.board.getTileById(16).setNumber(1);this.board.getTileById(16).disable();this.board.getTileById(19).setNumber(1);this.board.getTileById(19).disable()},function(){this.board.getTileById(17).setNumber(-1);this.board.getTileById(20).setNumber(-1);this.board.getTileById(22).setNumber(-1);this.board.getTileById(15).setNumber(-1);this.showTutorialMessage(StringResources.tutorial.msgDirt);this.waitMessage()},function(){this.board.getTileById(16).disable();this.board.getTileById(19).enable();this.showTutorialMove(19,16);this.waitMatch()},function(){this.board.getTileById(18).disable();this.hideTutorialFinger();this.tutorialWait(700)},function(){this.board.getTileById(16).disable();this.showTutorialMessage(StringResources.tutorial.msgOnceMore);this.waitMessage()},function(){this.board.getTileById(16).disable();this.board.getTileById(24).setNumber(2);this.board.getTileById(16).disable();this.showTutorialMove(24,16);this.waitMatch()},function(){this.hideTutorialFinger();this.tutorialWait(700);this.board.getTileById(16).disable()},function(){this.board.getTileById(16).disable();this.tutorialWait(500)},function(){this.hideTutorialFinger();this.showTutorialMessage(StringResources.tutorial.msgPlay);this.waitMessage()},function(){this.showTutorialMessage(StringResources.tutorial.msgBoardFill);this.waitMessage()},function(){this.hideTutorialFinger();this.board.getTileById(0).setNumber(2);this.board.getTileById(1).setNumber(-1);this.board.getTileById(2).setNumber(2);this.board.getTileById(3).setNumber(-1);this.board.getTileById(4).setNumber(2);this.board.getTileById(5).setNumber(-1);this.board.getTileById(6).setNumber(-1);this.board.getTileById(7).setNumber(-1);this.board.getTileById(10).setNumber(-1);this.board.getTileById(12).setNumber(-1);this.board.getTileById(0).disable();this.board.getTileById(1).disable();this.board.getTileById(2).disable();this.board.getTileById(3).disable();this.board.getTileById(4).disable();this.board.getTileById(5).disable();this.board.getTileById(6).disable();this.board.getTileById(7).disable();this.board.getTileById(8).disable();this.board.getTileById(9).disable();this.board.getTileById(10).disable();this.board.getTileById(11).disable();this.board.getTileById(12).disable();this.board.getTileById(13).disable();this.board.getTileById(14).disable();this.board.getTileById(18).disable();this.tutorialWait(1e3)},function(){this.showTutorialItem(Items.CLEAN);this.gameFooter.highlight(Items.CLEAN);this.gameFooter.showMessage(Items.CLEAN,StringResources.tutorial.msgItemClean);this.waitItem()},function(){this.gameFooter.hideMessage();this.hideTutorialFinger();this.gameFooter.setItemAmmount(Items.CLEAN,0);this.tutorialWait(1e3)},function(){this.showTutorialItem(Items.TIME);this.gameFooter.highlight(Items.TIME);this.gameFooter.showMessage(Items.TIME,StringResources.tutorial.msgItemTime);this.waitItem()},function(){this.gameFooter.hideMessage();this.hideTutorialFinger();this.gameFooter.setItemAmmount(Items.TIME,0);this.tutorialWait(1e3)},function(){this.showTutorialItem(Items.FAST);this.gameFooter.highlight(Items.FAST);this.gameFooter.showMessage(Items.FAST,StringResources.tutorial.msgItemFast);this.waitItem()},function(){this.gameFooter.lockAll();this.gameFooter.hideMessage();this.hideTutorialFinger();this.gameFooter.setItemAmmount(Items.FAST,0);this.tutorialWait(1e3)},function(){JoinJelly.userData.history(histories.TUTORIAL);JoinJelly.startLevel()}];n[this.currentTutorialStep]&&n[this.currentTutorialStep]()},t.prototype.tutorialWait=function(n){setTimeout(function(){this.executeTutorialStep()},n)},t.prototype.waitMatch=function(){this.matchNotify=function(){this.matchNotify=null;this.executeTutorialStep()}},t.prototype.waitItem=function(){this.itemNotify=function(){this.itemNotify=null;this.executeTutorialStep()}},t.prototype.waitMessage=function(){this.messageNotify=function(){this.messageNotify=null;this.executeTutorialStep()}},t.prototype.showTutorialMessage=function(n){this.gameMessage.show(n)},t.prototype.showTutorialMove=function(n,t){var i=this.board.getTileById(n),r=this.board.getTileById(t);this.tutorialJellyFinger.showMove(i.x,i.y+this.board.y-this.board.regY,r.x,r.y+this.board.y-this.board.regY)},t.prototype.showTutorialItem=function(n){var t=this.gameFooter.getItemButton(n).localToLocal(0,0,this.footer);this.tutorialItemFinger.showClick(t.x,t.y-100);this.gameFooter.lockAll();this.gameFooter.unlockItem(n);this.gameFooter.setItemAmmount(n,1)},t.prototype.hideTutorialFinger=function(){this.tutorialJellyFinger.hide();this.tutorialItemFinger.hide()},t.prototype.giveItemChance=function(){return null},t.prototype.useItem=function(n){var t=!1;switch(n){case"time":t=this.useTime();break;case"fast":t=this.useFast();break;case"clean":t=this.useClean();break;case"revive":t=this.useRevive()}t&&(JoinJelly.itemData.decreaseItemAmmount(n),this.itemNotify&&this.itemNotify())},t.prototype.updateFooter=function(){},t.prototype.saveGame=function(){},t}(GamePlayScreen);n.Tutorial=t})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.addChild(new createjs.Shape((new createjs.Graphics).beginFill("darkGray").beginStroke("black").drawRect(-200,-60,400,120)));var t=new createjs.Text("","60px Arial","white");t.textAlign="center";t.textBaseline="middle";this.addChild(t);this.text=t;this.addEventListener("click",function(){this.fadeOut()})}return __extends(t,n),t.prototype.showMessage=function(n){this.text.text=n;this.fadeIn()},t}(gameui.Button);n.Message=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={}));UserData=function(){function n(){gameui.AudiosManager.setSoundVeolume(this.getSoundVol());gameui.AudiosManager.setMusicVolume(this.getMusicVol())}return n.prototype.setScore=function(t){var i=this.getHighScore();t>i&&n.saveValue("HighScore",t)},n.prototype.getHighScore=function(){var t=n.loadValue("HighScore");return t?t:0},n.prototype.setLastJelly=function(t){var i=this.getLastJelly();t>i&&n.saveValue("LastJelly",t)},n.prototype.getLastJelly=function(){var t=n.loadValue("LastJelly");return t?t:0},n.prototype.setPlayerName=function(t){n.saveValue("username",t)},n.prototype.getPlayerName=function(){var t=n.loadValue("username");return t||(t=""),t},n.prototype.promptPlayerName=function(n){Cocoon.Dialog.prompt({title:StringResources.menus.playerName,message:StringResources.menus.playerNameDesc,text:this.getPlayerName(),type:"text"},{success:function(t){this.setPlayerName(t);n()},cancel:function(){n()}})},n.prototype.getMusicVol=function(){return n.loadValue("music",1)},n.prototype.setMusicVol=function(t){n.saveValue("music",t)},n.prototype.getSoundVol=function(){return n.loadValue("sound",1)},n.prototype.setSoundVol=function(t){n.saveValue("sound",t)},n.prototype.saveItems=function(t){return n.saveValue("items",t)},n.prototype.loadItems=function(){return n.loadValue("items",{})},n.prototype.saveGame=function(t){n.saveValue("savegame",t)},n.prototype.loadGame=function(){return n.loadValue("savegame",undefined)},n.prototype.deleteSaveGame=function(){n.saveValue("savegame",null)},n.saveValue=function(t,i){if(i==null)localStorage.removeItem(n.prefix+t);else{var r=JSON.stringify(i);localStorage.setItem(n.prefix+t,r)}},n.loadValue=function(t,i){var r=localStorage.getItem(n.prefix+t);return r?JSON.parse(r):i},n.prototype.history=function(t){var i=n.loadValue("history",{});i[t]=!0;n.saveValue("history",i)},n.prototype.getHistory=function(t){var i=n.loadValue("history",{});return i[t]},n.getHistoryRevive=function(){return this.loadValue("revive")},n.prototype.resetAll=function(){localStorage.clear()},n.prefix="FastPair_",n}();histories=function(){function n(){}return n.TUTORIAL="tutorial_intro",n.REVIVE="revive",n.EVOLVE="evolve",n.FIRSTPLAY="firstplay",n}(),function(n){var t=function(){function t(){}return t.init=function(i){var f,r,u;this.userData=new UserData;this.analytics=new Analytics;this.itemData=new ItemsData;this.gameServices=new GameServices;f=(window.navigator.userLanguage||window.navigator.language).substr(0,2).toLowerCase();switch(f){case"pt":StringResources=StringResources_pt}r=60;window.location.search=="?test"&&(r=10,testMode=!0);this.gameScreen=new gameui.GameScreen(i,defaultWidth,defaultHeight,r);Cocoon.App.exitCallback(function(){return this.gameScreen.sendBackButtonEvent()});u=new n.menus.Loading;this.gameScreen.switchScreen(u);u.loaded=function(){if(window.location.search=="?test")this.startTest();else{var n=this.userData.loadGame();n?t.startLevel():t.showMainMenu()}}},t.startTest=function(){var n=new gameplay.GamePlayScreen(this.userData);this.gameScreen.switchScreen(n);n.selfPeformanceTest(!1)},t.showMainMenu=function(){var t;this.gameScreen.currentScreen instanceof gameplay.GamePlayScreen&&(t={type:"top",time:500});t=this.gameScreen.currentScreen instanceof Jellypedia?{type:"right",time:500}:{type:"fade",time:600};this.gameScreen.switchScreen(new n.MainScreen(this.userData),null,t)},t.startLevel=function(){var n;n=this.gameScreen.currentScreen instanceof MainScreen?{type:"bottom",time:500}:{type:"fade",time:600};this.gameScreen.switchScreen(new gameplay.GamePlayScreen(this.userData),null,n)},t.startLevelDirectaly=function(){this.gameScreen.switchScreen(new gameplay.GamePlayScreen(this.userData))},t.startTutorial=function(){this.gameScreen.switchScreen(new gameplay.Tutorial)},t.showStore=function(n){var t;this.gameScreen.currentScreen instanceof MainScreen&&(t={type:"right",time:500});this.gameScreen.switchScreen(new menus.StoreMenu(n),null,t)},t.showIntro=function(){this.gameScreen.switchScreen(new n.StoryScreen)},t.showLeaderboards=function(){var n;this.gameScreen.currentScreen instanceof MainScreen&&(n={type:"right",time:500});this.gameScreen.switchScreen(new menus.LeaderBoards,null,n)},t.showPedia=function(){var n;this.gameScreen.currentScreen instanceof MainScreen&&(n={type:"left",time:500});this.gameScreen.switchScreen(new Jellypedia(this.userData,StringResources.jellies),null,n)},t.showSettings=function(){var n;this.gameScreen.currentScreen instanceof MainScreen&&(n={type:"left",time:500});this.gameScreen.switchScreen(new menus.MainMenu,null,n)},t.showAbout=function(){this.gameScreen.switchScreen(new About)},t.maxJelly=65536,t}();n.JoinJelly=t}(joinjelly||(joinjelly={}));var defaultWidth=1536,defaultHeight=2048,fbAppId="1416523228649363",gameWebsite="www.joinjelly.com",gameWebsiteIcon="www.joinjelly.com/icon.png",contantsAndroid={ACH_JELLY_1:"CgkI49ztp64KEAIQBA",ACH_JELLY_2:"CgkI49ztp64KEAIQBQ",ACH_JELLY_3:"CgkI49ztp64KEAIQBg",ACH_JELLY_4:"CgkI49ztp64KEAIQBA",ACH_JELLY_5:"CgkI49ztp64KEAIQBQ",ACH_JELLY_6:"CgkI49ztp64KEAIQBg",ACH_JELLY_7:"CgkI49ztp64KEAIQBw",ACH_JELLY_8:"CgkI49ztp64KEAIQCA",ACH_JELLY_9:"CgkI49ztp64KEAIQCQ",ACH_JELLY_10:"CgkI49ztp64KEAIQCg",ACH_JELLY_11:"CgkI49ztp64KEAIQCw",ACH_JELLY_12:"CgkI49ztp64KEAIQDA",ACH_JELLY_13:"CgkI49ztp64KEAIQDQ",ACH_JELLY_14:"CgkI49ztp64KEAIQDg",ACH_JELLY_15:"CgkI49ztp64KEAIQDw",ACH_JELLY_16:"CgkI49ztp64KEAIQEA",ACH_JELLY_17:"CgkI49ztp64KEAIQEQ",CLIENT_ID:"356029001315-1uh0g6avko4g7aqfsj2kpt3srs6ssiqd.apps.googleusercontent.com",LEAD_LEADERBOARD:"CgkI49ztp64KEAIQAg"},constantsiOS={ACH_JELLY_1:"jelly01",ACH_JELLY_2:"jelly02",ACH_JELLY_3:"jelly03",ACH_JELLY_4:"jelly04",ACH_JELLY_5:"jelly05",ACH_JELLY_6:"jelly06",ACH_JELLY_7:"jelly07",ACH_JELLY_8:"jelly08",ACH_JELLY_9:"jelly09",ACH_JELLY_10:"jelly10",ACH_JELLY_11:"jelly11",ACH_JELLY_12:"jelly12",ACH_JELLY_13:"jelly13",ACH_JELLY_14:"jelly14",ACH_JELLY_15:"jelly15",ACH_JELLY_16:"jelly16",ACH_JELLY_17:"jelly17",LEAD_LEADERBOARD:"leaderboards"},joinjelly;(function(n){var t;(function(n){n.boardSize=5;n.itemProbability=.005;n.timeByLevel=2e4;n.timeoutInterval;n.initialInterval=800;n.finalInterval=300;n.easeInterval=.99;n.initialDirtyProbability=.1;n.finalDirtyProbability=.5;n.easeDirtyProbability=.99})(t=n.gameplay||(n.gameplay={}))})(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.countDown=function(n){var t;n===void 0&&(n=3);var i=[],u=1e3,r=200;for(setTimeout(function(){gameui.AudiosManager.playSound("Interface Sound-12")},u*n+r),t=n;t>0;t--)i[t]=gameui.AssetsManager.getBitmap("n"+t),this.addChild(i[t]),i[t].regX=i[t].getBounds().width/2,i[t].regY=i[t].getBounds().height/2,i[t].mouseEnabled=!1,createjs.Tween.get(i[t]).to({scaleX:2,scaleY:2,alpha:0}).wait((n-t)*u).to({scaleX:1,scaleY:1,alpha:1},r,createjs.Ease.quadOut).call(function(){gameui.AudiosManager.playSound("Interface Sound-13")}).wait(u-r).to({alpha:0,scaleX:.5,scaleY:.5},r,createjs.Ease.quadIn).call(function(n){this.removeChild(n)})},t}(createjs.Container);n.CountDown=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){t.call(this);this.itemSize=270;this.itemsButtons=[];this.addObjects();this.setItems(n)}return __extends(i,t),i.prototype.setItems=function(n){var i=this.itemSize,t;if(n.length>=5&&(i=200),this.cleanButtons(),n){for(t in n)this.addItem(n[t],t);for(t in n)this.itemsButtons[n[t]].y=-150,this.itemsButtons[n[t]].x=(defaultWidth-(n.length-1)*i)/2+t*i}},i.prototype.cleanButtons=function(){for(var n in this.itemsButtons)this.removeChild(this.itemsButtons[n]);this.itemsButtons=[]},i.prototype.addObjects=function(){var i=gameui.AssetsManager.getBitmap("footer"),t;this.addChild(i);i.y=-162;i.x=(defaultWidth-1161)/2;t=gameui.AssetsManager.getBitmap("lucky");this.addChild(t);t.y=-210;t.x=defaultWidth-250;t.scaleX=t.scaleY=.5;this.lucky=t;this.gameMessage=new n.TutoralMessage;this.addChild(this.gameMessage)},i.prototype.addItem=function(n){var t=new ItemButton(n);this.addChild(t);this.itemsButtons[n]=t;t.addEventListener("click",function(){this.dispatchEvent({type:"useitem",item:n})})},i.prototype.getItemButton=function(n){return this.itemsButtons[n]},i.prototype.setItemAmmount=function(n,t){this.itemsButtons[n]&&this.itemsButtons[n].setAmmount(t);n=="lucky"&&(this.lucky.visible=t>0)},i.prototype.showMessage=function(n,t){this.gameMessage.x=this.getItemButton(n).x;this.gameMessage.y=this.getItemButton(n).y-120;this.gameMessage.show(t)},i.prototype.hideMessage=function(){this.gameMessage.fadeOut()},i.prototype.bounceItem=function(n){this.getItemButton(n).highLight(!1)},i.prototype.highlight=function(n){this.unHighlightAll();this.getItemButton(n).highLight()},i.prototype.unHighlightAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].unHighlight()},i.prototype.lockItem=function(n){var t=this.getItemButton(n);t&&t.lock()},i.prototype.unlockItem=function(n){var t=this.getItemButton(n);t.unlock()},i.prototype.lockAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].lock()},i.prototype.unlockAll=function(){for(var n in this.itemsButtons)this.itemsButtons[n].unlock()},i}(createjs.Container);n.ItemsFooter=t})(t=n.view||(n.view={}))})(t=n.gameplay||(n.gameplay={}))}(joinjelly||(joinjelly={})),function(n){var t=function(){function n(){var n,t;navigator.onLine&&(n="web",Cocoon.Device.getDeviceInfo()&&(n=Cocoon.Device.getDeviceInfo().os),n!="windows"&&n!="web")&&(n=="ios"?(this.socialService=Cocoon.Social.GameCenter.getSocialInterface(),this.socialService.setAchievementsMap(constantsiOS)):n=="android"?(t=Cocoon.Social.GooglePlayGames,t.init({defaultLeaderboard:contantsAndroid.LEAD_LEADERBOARD}),this.socialService=t.getSocialInterface(),this.socialService.setAchievementsMap(contantsAndroid)):n=="web"&&(t=Cocoon.Social.GooglePlayGames,t.init({clientId:contantsAndroid.CLIENT_ID,defaultLeaderboard:contantsAndroid.LEAD_LEADERBOARD}),this.socialService=t.getSocialInterface(),this.socialService.setAchievementsMap(contantsAndroid),this.socialService.setTemplates("scripts/templates/leaderboards.html","scripts/templates/achievements.html")),setTimeout(function(){this.socialService&&!this.socialService.isLoggedIn()&&this.socialService.login(function(n,t){t?console.error("login error: "+t.message+" "+t.code):n||console.log("login cancelled")})},1e3))}return n.prototype.showLeaderboard=function(){if(navigator.onLine&&this.socialService)try{this.socialService.showLeaderboard()}catch(n){}},n.prototype.showAchievements=function(){if(navigator.onLine&&this.socialService)try{this.socialService.showAchievements()}catch(n){}},n.prototype.submitScore=function(n){if(navigator.onLine&&this.socialService)try{this.socialService.submitScore(n,function(t){t?console.error("score error: "+t.message):console.log("submited score: "+n)})}catch(t){}},n.prototype.submitJellyAchievent=function(n){if(navigator.onLine&&this.socialService){var t=Math.floor(Math.log(n)/Math.log(2))+1;try{this.socialService.submitAchievement("ACH_JELLY_"+t,function(n){n?console.error("submitAchievement error: "+n.message):console.log("submited Achievement: jelly "+t)})}catch(i){}}},n}();n.GameServices=t}(joinjelly||(joinjelly={})),function(n){var t=function(){function n(){}return n.init=function(){(this.deviceId=localStorage.getItem("deviceId"),typeof WindowsAzure!="undefined")&&(this.client=new WindowsAzure.MobileServiceClient(this.host,this.key),this.table=this.client.getTable("LeaderBoards"))},n.getScoreNames=function(n){this.table&&this.table.orderByDescending("score").take(50).where({gameid:this.gameId}).read().then(function(t){n(t)},function(){n(null)})},n.setScore=function(n,t,i){(i===void 0&&(i=!1),this.table)&&(this.deviceId&&!i?this.table.update({name:t,score:n,id:this.deviceId,gameid:this.gameId}):this.table.insert({name:t,score:n,gameid:this.gameId}).then(function(n){n.id&&(this.deviceId=n.id,localStorage.setItem("deviceId",this.deviceId))}))},n.host="https://dialeaderboards.azure-mobile.net",n.key="GyalJGfVBZeaGMTMGxKuytNMXjjoqC94",n.gameId="joinjelly",n}();n.AzureLeaderBoards=t}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i=function(t){function i(){var r,i;t.call(this,StringResources.menus.leaderboards);this.maxScroll=1700;r=new n.view.LoadingBall;this.scrollableContent.addChild(r);r.x=defaultWidth/2;r.y=800;i=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy");this.scrollableContent.addChild(i);i.regX=i.getBounds().width/2;i.x=defaultWidth/2;i.y=900;i.visible=!0;this.loadLeaderBoards(function(n){r.visible=!1;n!=null?(this.fillLeaderBoards(n),i.visible=!1):(i.text=StringResources.menus.error,i.visible=!0,i.regX=i.getBounds().width/2)})}return __extends(i,t),i.prototype.fillLeaderBoards=function(n){var r=200,u=400,t,i;for(t in n)i=new view.LeaderBoardItem(n[t].score,n[t].name,parseInt(t)+1),i.x=defaultWidth/2,i.y=u+r*t,this.scrollableContent.addChild(i);this.maxScroll=u+n.length*r},i.prototype.loadLeaderBoards=function(n){AzureLeaderBoards.getScoreNames(n,20)},i}(ScrollablePage);t.LeaderBoards=i})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t=function(n){function t(){n.call(this);var t=new lib.Intro3;this.content.addChild(t);t.play();t.loop=!1;t.addEventListener("click",function(){t.stop();JoinJelly.startTutorial()});t.addEventListener("complete",function(){t.stop();JoinJelly.startTutorial()})}return __extends(t,n),t}(gameui.ScreenState);n.StoryScreen=t}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t,i,r){var e;r===void 0&&(r=1);n.call(this);this.regX=528;e=gameui.AssetsManager.getBitmap("FlyGroup");e.scaleY=.65;this.addChild(e);var f=new createjs.Container,o=gameui.AssetsManager.getBitmapText(i,"debussy"),s=gameui.AssetsManager.getBitmapText(r.toString(),"debussy"),u=gameui.AssetsManager.getBitmapText(t.toString(),"debussy");u.regX=u.getBounds().width;s.y=30;o.y=30;u.y=30;s.x=30;o.x=150;u.x=1e3;f.addChild(o);f.addChild(u);f.addChild(s);this.addChild(f)}return __extends(t,n),t}(createjs.Container);n.LeaderBoardItem=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(t){n.call(this);var u=gameui.AssetsManager.getBitmap(t+"bonus_border.png"),r=gameui.AssetsManager.getBitmapText(StringResources.menus.loading,"debussy"),i=gameui.AssetsManager.getBitmap(t+"bonus_bar.png");this.addChild(u);this.addChild(r);this.addChild(i);r.regX=r.getBounds().width/2;i.x=-939/2-40;u.regX=1131/2;r.y=-100;i.y=85;this.barMask=new createjs.Shape((new createjs.Graphics).beginFill("red").drawRect(0,i.y,939,57));this.barMask.x=i.x;i.mask=this.barMask}return __extends(t,n),t.prototype.update=function(n){this.barMask.scaleX=n},t}(createjs.Container);n.LoadingBar=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t;(function(n){var t=function(n){function t(){n.call(this);this.addObjects()}return __extends(t,n),t.prototype.addObjects=function(){var i=gameui.AssetsManager.getBitmap("FlyGroup"),n,t,r;i.y=-130;i.regX=i.getBounds().width/2;this.addChild(i);n=gameui.AssetsManager.getBitmapText(StringResources.menus.playerName,"debussy");n.y=-190;n.scaleX=n.scaleY=1.1;n.regX=n.getBounds().width/2;this.addChild(n);t=gameui.AssetsManager.getBitmapText(JoinJelly.userData.getPlayerName(),"debussy");this.addChild(t);this.playerName=t;t.x=-450;t.y=-60;r=new gameui.ImageButton("BtSettings",function(){JoinJelly.userData.promptPlayerName(function(){this.playerName.text=JoinJelly.userData.getPlayerName()})});this.addChild(r);r.x=400},t}(createjs.Container);n.PlayerNameOptions=t})(t=n.view||(n.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(t){var i;(function(t){var i=function(t){function i(i,r,u,f){var h,a,e,o,v,y,c,s,p,l,w;t.call(this);h=new createjs.Container;a=gameui.AssetsManager.getBitmap("FlyGroup");a.x=232;a.y=27;a.scaleY=1.25;a.scaleX=.75;h.addChild(a);e="";switch(i){case"time5x":e="itemtime";break;case"fast5x":e="itemfast";break;case"revive5x":e="itemrevive";break;case"evolve5x":e="itemevolve";break;case"clean5x":e="itemclean";break;case"pack5x":case"pack1x":case"pack10x":e="itemPack";break;case"lucky":e="lucky";break;default:e="itemPack"}o=gameui.AssetsManager.getBitmap(e);o.regX=o.getBounds().width/2;o.regY=o.getBounds().height/2;o.scaleX=o.scaleY=.8;o.x=225;o.y=188;h.addChild(o);u&&(u=u.replace("  ","\n"));u=u.replace(";","\n");v=gameui.AssetsManager.getBitmapText(r,"debussyBig");y=gameui.AssetsManager.getBitmapText(u,"debussy");v.y=40;y.y=140;v.scaleX=v.scaleY=.7;y.scaleX=y.scaleY=.8;v.x=y.x=400;h.addChild(v);h.addChild(y);c=gameui.AssetsManager.getBitmap("unchecked");c.regX=c.getBounds().width/2;c.regY=c.getBounds().height/2;c.y=152;c.x=1199;this.addChild(c);s=gameui.AssetsManager.getBitmap("check");s.regX=s.getBounds().width/2;s.regY=s.getBounds().height/2;s.y=152;s.x=1199;this.purchasedIcon=s;this.addChild(s);p=new n.view.LoadingBall;p.y=152;p.x=1199;this.loadingIcon=p;this.addChild(p);l=gameui.AssetsManager.getBitmapText(f,"debussy");l.y=251;l.x=1199;l.regX=l.getBounds().width/2;l.scaleX=l.scaleY=.8;f!="share"&&h.addChild(l);w=f=="share"?new gameui.ImageButton("BtShare",function(){this.setPurchasing();this.dispatchEvent({type:"share",productId:i})}):new gameui.ImageButton("BtStore",function(){this.setPurchasing();this.dispatchEvent({type:"buy",productId:i})});w.y=152;w.x=1199;this.purchaseButton=w;this.addChild(w);this.addChild(h);h.cache(100,27,1250,300)}return __extends(i,t),i.prototype.setPurchasing=function(){this.disable();this.loadingIcon.visible=!0},i.prototype.loading=function(){this.disable();this.loadingIcon.visible=!0},i.prototype.setNotAvaliable=function(){this.purchaseButton.fadeOut();this.purchasedIcon.visible=!1;this.loadingIcon.visible=!1},i.prototype.setAvaliable=function(){},i.prototype.setPurchased=function(n){n===void 0&&(n=!1);this.purchaseButton.fadeOut();this.purchasedIcon.visible=!0;this.loadingIcon.visible=!1;gameui.AudiosManager.playSound("Interface Sound-11");n&&setTimeout(function(){this.setNormal()},1e3)},i.prototype.setNormal=function(){this.purchaseButton.fadeIn();this.purchasedIcon.visible=!1;this.loadingIcon.visible=!1},i.prototype.enable=function(){this.purchaseButton.fadeIn();this.loadingIcon.visible=!1},i.prototype.disable=function(){this.purchasedIcon.visible=!1;this.purchaseButton.fadeOut()},i}(createjs.Container);t.ProductListItem=i})(i=t.view||(t.view={}))})(t=n.menus||(n.menus={}))}(joinjelly||(joinjelly={})),function(n){var t;(function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.castSimple=function(){var n=gameui.AssetsManager.getBitmap("fxJoin");n.regX=100;n.regY=100;this.addChild(n);createjs.Tween.get(n).to({scaleX:2,scaleY:2,alpha:0},500,createjs.Ease.linear).call(function(){this.removeChild(n)})},t.prototype.castSimpleInv=function(){var n=gameui.AssetsManager.getBitmap("fxJoin");n.regX=100;n.regY=100;this.addChild(n);n.alpha=2;n.scaleX=2;n.scaleY=2;createjs.Tween.get(n).to({scaleX:.5,scaleY:.5,alpha:2},800,createjs.Ease.linear).call(function(){this.removeChild(n)})},t.prototype.castPart=function(){var n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=.2;n.alpha=2;this.addChild(n);createjs.Tween.get(n).to({scaleX:1.6,scaleY:1.6,alpha:0},500,createjs.Ease.quadOut).call(function(){this.removeChild(n)});this.castParts()},t.prototype.castParts=function(){var n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=.4;n.rotation=360/16;n.alpha=2;this.addChild(n);createjs.Tween.get(n).to({scaleX:2.2,scaleY:2.2,alpha:0},500,createjs.Ease.quadOut).call(function(){this.removeChild(n)})},t.prototype.castPartsInv=function(){var n=gameui.AssetsManager.getBitmap("fxPart");n.regX=140;n.regY=140;n.scaleX=n.scaleY=4;n.rotation=360/16;n.alpha=0;this.addChild(n);createjs.Tween.get(n).to({scaleX:.5,scaleY:.5,alpha:2,rotation:0},1e3,createjs.Ease.quadIn).call(function(){this.removeChild(n)})},t.prototype.castBoth=function(){this.castPartsInv();this.castSimpleInv()},t}(createjs.Container);n.Effect=t})(t=n.view||(n.view={}))}(joinjelly||(joinjelly={}));
//# sourceMappingURL=script.min.js.map
